var qe=Object.defineProperty;var Oe=(i,e,t)=>e in i?qe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var A=(i,e,t)=>(Oe(i,typeof e!="symbol"?e+"":e,t),t);import{_ as Ge,a as Xe}from"./AppDescription-9203de90.js";import{_ as Ue}from"./PolicyCard.vue_vue_type_script_setup_true_lang-ecc0fe55.js";import{o as Fe,_ as Je}from"./SelectToken.vue_vue_type_script_setup_true_lang-d3e2da4a.js";import{m as o,b5 as P,P as g,S as B,w as M,v as ne,bc as Ye,O as Pe,n as x,aj as Ke,bd as et,be as tt,bf as it,b6 as Te,X as we,q as nt,s as st,t as rt,u as at,a as j,x as ot,y as ue,C as Ce,B as Ee,I as ct,A as _,bg as Le,J as q,b9 as ut,aZ as lt,bh as dt,ar as mt,G as Ve,Y as Ie,Z as le,a1 as Qe,o as D,a2 as O,a3 as T,k,a6 as Ne,a7 as u,a8 as a,j as J,aa as h,a9 as G,a5 as R,ab as se,ac as re,ad as $,bi as Ze,ae as $e,a4 as ve,F as He,L as ft,aK as pt,ax as Be,aJ as yt,aI as xe,aM as gt,aL as Me,H as ht,bj as kt,_ as bt,ai as St}from"./index-33cf60a3.js";import{c as At,A as wt}from"./setAuthority-9cc5dee3.js";import{b as vt,g as _t,m as Pt}from"./index-59f87b3d.js";import"./internal-b113e877.js";const Tt="/assets/unrecognized-token-3289de57.svg";function De(i,e){if(e)return e[i]?.symbol??""}function ae(i){return i??Tt}const It=[244,158,220,65,8,73,4,65];class L{constructor(e,t){this.authority=e,this.isPlatformPaused=t}static fromArgs(e){return new L(e.authority,e.isPlatformPaused)}static fromAccountInfo(e,t=0){return L.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const n=await e.getAccountInfo(t,s);if(n==null)throw new Error(`Unable to find Admin account at ${t}`);return L.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return P.GpaBuilder.fromStruct(e,X)}static deserialize(e,t=0){return X.deserialize(e,t)}serialize(){return X.serialize({accountDiscriminator:It,...this})}static get byteSize(){return X.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(L.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===L.byteSize}pretty(){return{authority:this.authority.toBase58(),isPlatformPaused:this.isPlatformPaused}}}const X=new o.BeetStruct([["accountDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["authority",P.publicKey],["isPlatformPaused",o.bool]],L.fromArgs,"Admin"),Bt=[221,78,171,233,213,142,113,56];class V{constructor(e,t){this.authority=e,this.isAllPaused=t}static fromArgs(e){return new V(e.authority,e.isAllPaused)}static fromAccountInfo(e,t=0){return V.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const n=await e.getAccountInfo(t,s);if(n==null)throw new Error(`Unable to find Manager account at ${t}`);return V.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return P.GpaBuilder.fromStruct(e,Y)}static deserialize(e,t=0){return Y.deserialize(e,t)}serialize(){return Y.serialize({accountDiscriminator:Bt,...this})}static get byteSize(){return Y.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(V.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===V.byteSize}pretty(){return{authority:this.authority.toBase58(),isAllPaused:this.isAllPaused}}}const Y=new o.BeetStruct([["accountDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["authority",P.publicKey],["isAllPaused",o.bool]],V.fromArgs,"Manager"),_e=new o.BeetArgsStruct([["num",o.u64],["denom",o.u64]],"Ratio"),We=[85,72,49,176,182,228,141,82];class Q{constructor(e,t,s,n,r,c,l,d,p,w){this.authority=e,this.tokenA=t,this.tokenB=s,this.lockedAmount=n,this.ratio=r,this.isPaused=c,this.lockFee=l,this.unlockFee=d,this.feeReceiver=p,this.policy=w}static fromArgs(e){return new Q(e.authority,e.tokenA,e.tokenB,e.lockedAmount,e.ratio,e.isPaused,e.lockFee,e.unlockFee,e.feeReceiver,e.policy)}static fromAccountInfo(e,t=0){return Q.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const n=await e.getAccountInfo(t,s);if(n==null)throw new Error(`Unable to find Pair account at ${t}`);return Q.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return P.GpaBuilder.fromStruct(e,ee)}static deserialize(e,t=0){return ee.deserialize(e,t)}serialize(){return ee.serialize({accountDiscriminator:We,...this})}static byteSize(e){const t=Q.fromArgs(e);return ee.toFixedFromValue({accountDiscriminator:We,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,s){return t.getMinimumBalanceForRentExemption(Q.byteSize(e),s)}pretty(){return{authority:this.authority.toBase58(),tokenA:this.tokenA.toBase58(),tokenB:this.tokenB.toBase58(),lockedAmount:(()=>{const e=this.lockedAmount;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),ratio:this.ratio,isPaused:this.isPaused,lockFee:this.lockFee,unlockFee:this.unlockFee,feeReceiver:this.feeReceiver.toBase58(),policy:this.policy}}}const ee=new o.FixableBeetStruct([["accountDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["authority",P.publicKey],["tokenA",P.publicKey],["tokenB",P.publicKey],["lockedAmount",o.u64],["ratio",_e],["isPaused",o.bool],["lockFee",o.u16],["unlockFee",o.u16],["feeReceiver",P.publicKey],["policy",o.coption(P.publicKey)]],Q.fromArgs,"Pair"),xt=[159,117,95,227,239,151,58,236];class N{constructor(e,t){this.authority=e,this.isBlocked=t}static fromArgs(e){return new N(e.authority,e.isBlocked)}static fromAccountInfo(e,t=0){return N.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const n=await e.getAccountInfo(t,s);if(n==null)throw new Error(`Unable to find User account at ${t}`);return N.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return P.GpaBuilder.fromStruct(e,te)}static deserialize(e,t=0){return te.deserialize(e,t)}serialize(){return te.serialize({accountDiscriminator:xt,...this})}static get byteSize(){return te.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(N.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===N.byteSize}pretty(){return{authority:this.authority.toBase58(),isBlocked:this.isBlocked}}}const te=new o.BeetStruct([["accountDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["authority",P.publicKey],["isBlocked",o.bool]],N.fromArgs,"User"),Mt=[17,50,115,0,10,220,15,157];class Z{constructor(e,t){this.user=e,this.pair=t}static fromArgs(e){return new Z(e.user,e.pair)}static fromAccountInfo(e,t=0){return Z.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const n=await e.getAccountInfo(t,s);if(n==null)throw new Error(`Unable to find WhitelistedUserInfo account at ${t}`);return Z.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return P.GpaBuilder.fromStruct(e,ie)}static deserialize(e,t=0){return ie.deserialize(e,t)}serialize(){return ie.serialize({accountDiscriminator:Mt,...this})}static get byteSize(){return ie.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(Z.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===Z.byteSize}pretty(){return{user:this.user.toBase58(),pair:this.pair.toBase58()}}}const ie=new o.BeetStruct([["accountDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["user",P.publicKey],["pair",P.publicKey]],Z.fromArgs,"WhitelistedUserInfo"),K=new Map,C=new Map;class de extends Error{constructor(){super("Unauthorized action");A(this,"code",6e3);A(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,de)}}K.set(6e3,()=>new de);C.set("Unauthorized",()=>new de);class me extends Error{constructor(){super("Paused");A(this,"code",6001);A(this,"name","IsPaused");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,me)}}K.set(6001,()=>new me);C.set("IsPaused",()=>new me);class fe extends Error{constructor(){super("Already resumed");A(this,"code",6002);A(this,"name","AlreadyResumed");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,fe)}}K.set(6002,()=>new fe);C.set("AlreadyResumed",()=>new fe);class pe extends Error{constructor(){super("Pair still have locked tokens");A(this,"code",6003);A(this,"name","StillRemainingLockedTokens");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,pe)}}K.set(6003,()=>new pe);C.set("StillRemainingLockedTokens",()=>new pe);class ye extends Error{constructor(){super("User is blocked");A(this,"code",6004);A(this,"name","IsBlocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ye)}}K.set(6004,()=>new ye);C.set("IsBlocked",()=>new ye);class ge extends Error{constructor(){super("User is already unblocked");A(this,"code",6005);A(this,"name","AlreadyUnblocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ge)}}K.set(6005,()=>new ge);C.set("AlreadyUnblocked",()=>new ge);class he extends Error{constructor(){super("Insufficient locked amount");A(this,"code",6006);A(this,"name","InsufficientLockedAmount");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,he)}}K.set(6006,()=>new he);C.set("InsufficientLockedAmount",()=>new he);class ke extends Error{constructor(){super("Insufficient funds");A(this,"code",6007);A(this,"name","InsufficientFunds");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ke)}}K.set(6007,()=>new ke);C.set("InsufficientFunds",()=>new ke);const Dt=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["key",P.publicKey]],"AddManagerInstructionArgs"),Wt=[125,38,192,212,101,91,179,16];function zt(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=Dt.serialize({instructionDiscriminator:Wt,...e}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const Rt=new o.FixableBeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["policy",o.coption(P.publicKey)],["ratio",_e]],"AddPairInstructionArgs"),Ut=[209,230,17,236,218,162,86,118];function Ft(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=Rt.serialize({instructionDiscriminator:Ut,...e}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const Jt=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"AddUserToWhitelistInstructionArgs"),Kt=[244,177,124,12,22,50,139,152];function Ct(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Jt.serialize({instructionDiscriminator:Kt}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.userAuthority,isWritable:!1,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const Et=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"BlockUserInstructionArgs"),Lt=[10,164,178,6,231,175,185,191];function Vt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Et.serialize({instructionDiscriminator:Lt}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const Qt=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["amount",o.u64]],"LockTokensInstructionArgs"),Nt=[136,11,32,232,161,117,54,211];function Zt(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=Qt.serialize({instructionDiscriminator:Nt,...e}),n=[{pubkey:i.proofRequest??t,isWritable:!1,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!1,isSigner:!1},{pubkey:i.userAuthority,isWritable:!0,isSigner:!0},{pubkey:i.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.sourceA,isWritable:!0,isSigner:!1},{pubkey:i.destinationA,isWritable:!0,isSigner:!1},{pubkey:i.destinationB,isWritable:!0,isSigner:!1},{pubkey:i.feePayer,isWritable:!0,isSigner:!0},{pubkey:i.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:i.tokenProgram??ne,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const $t=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"PausePairsInstructionArgs"),Ht=[147,150,152,192,119,95,137,64];function jt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=$t.serialize({instructionDiscriminator:Ht}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const qt=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"PausePlatformInstructionArgs"),Ot=[232,46,204,130,181,0,172,57];function Gt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=qt.serialize({instructionDiscriminator:Ot}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const Xt=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"RemoveManagerInstructionArgs"),Yt=[150,55,157,77,128,148,7,15];function ei(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Xt.serialize({instructionDiscriminator:Yt}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const ti=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"RemovePairInstructionArgs"),ii=[181,42,154,249,167,123,20,81];function ni(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=ti.serialize({instructionDiscriminator:ii}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const si=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"RemoveUserFromWhitelistInstructionArgs"),ri=[198,73,139,218,243,209,180,182];function ai(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=si.serialize({instructionDiscriminator:ri}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const oi=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"ResumePairsInstructionArgs"),ci=[23,106,248,226,173,20,247,74];function ui(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=oi.serialize({instructionDiscriminator:ci}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const li=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"ResumePlatformInstructionArgs"),di=[23,162,56,123,186,207,109,131];function mi(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=li.serialize({instructionDiscriminator:di}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const fi=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["key",P.publicKey]],"SetAdminInstructionArgs"),pi=[251,163,0,52,91,194,187,92];function yi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=fi.serialize({instructionDiscriminator:pi,...e}),n=[{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const gi=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)]],"UnblockUserInstructionArgs"),hi=[216,208,128,98,74,210,18,114];function ki(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=gi.serialize({instructionDiscriminator:hi}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)s.push(r);return new M({programId:e,keys:s,data:t})}const bi=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["amount",o.u64]],"UnlockTokensInstructionArgs"),Si=[233,35,95,159,37,185,47,88];function Ai(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=bi.serialize({instructionDiscriminator:Si,...e}),n=[{pubkey:i.proofRequest??t,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!1,isSigner:!1},{pubkey:i.userAuthority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.sourceA,isWritable:!0,isSigner:!1},{pubkey:i.destinationA,isWritable:!0,isSigner:!1},{pubkey:i.sourceB,isWritable:!0,isSigner:!1},{pubkey:i.feePayer,isWritable:!0,isSigner:!0},{pubkey:i.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:i.tokenProgram??ne,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const wi=new o.FixableBeetArgsStruct([["newAuthority",o.coption(P.publicKey)],["isPaused",o.coption(o.bool)],["ratio",o.coption(_e)],["lockFee",o.coption(o.u16)],["unlockFee",o.coption(o.u16)],["feeReceiver",o.coption(P.publicKey)]],"UpdatePairData"),vi=new o.FixableBeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["data",wi]],"UpdatePairInstructionArgs"),_i=[176,62,36,215,255,206,35,12];function Pi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=vi.serialize({instructionDiscriminator:_i,...e}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const Ti=new o.BeetArgsStruct([["instructionDiscriminator",o.uniformFixedSizeArray(o.u8,8)],["amount",o.u64]],"WithdrawFeeInstructionArgs"),Ii=[14,122,231,218,31,238,223,150];function Bi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[s]=Ti.serialize({instructionDiscriminator:Ii,...e}),n=[{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!0,isSigner:!1},{pubkey:i.destination,isWritable:!0,isSigner:!1},{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)n.push(c);return new M({programId:t,keys:n,data:s})}const xi="JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm",ze=new g(xi),Mi={version:"0.0.6",name:"smart_converter",instructions:[{name:"setAdmin",accounts:[{name:"admin",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addPair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"policy",type:{option:"publicKey"}},{name:"ratio",type:{defined:"Ratio"}}]},{name:"addUserToWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"userAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removeUserFromWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"lockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"user",isMut:!1,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"destinationB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"unlockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"user",isMut:!1,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"sourceB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"removeManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updatePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"UpdatePairData"}}]},{name:"blockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"unblockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"withdrawFee",accounts:[{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]}],accounts:[{name:"pair",type:{kind:"struct",fields:[{name:"authority",docs:["Manager authority"],type:"publicKey"},{name:"tokenA",docs:["Security token mint address"],type:"publicKey"},{name:"tokenB",docs:["Utility token mint address"],type:"publicKey"},{name:"lockedAmount",docs:["Amount of security tokens currently locked"],type:"u64"},{name:"ratio",docs:["Ratio of token A to token B"],type:{defined:"Ratio"}},{name:"isPaused",docs:["Indicates if pair is paused or not"],type:"bool"},{name:"lockFee",docs:["Fee for locking token A"],type:"u16"},{name:"unlockFee",docs:["Fee for unlocking token A"],type:"u16"},{name:"feeReceiver",docs:["Wallet that will receive fee"],type:"publicKey"},{name:"policy",docs:["Albus policy"],type:{option:"publicKey"}}]}},{name:"admin",type:{kind:"struct",fields:[{name:"authority",docs:["Manager wallet address"],type:"publicKey"},{name:"isPlatformPaused",docs:["Indicates if platform is paused or not"],type:"bool"}]}},{name:"manager",type:{kind:"struct",fields:[{name:"authority",docs:["Manager address"],type:"publicKey"},{name:"isAllPaused",docs:["Indicates if manager's pairs are paused or not"],type:"bool"}]}},{name:"user",type:{kind:"struct",fields:[{name:"authority",docs:["User address"],type:"publicKey"},{name:"isBlocked",docs:["Indicates if user is blocked or not"],type:"bool"}]}},{name:"whitelistedUserInfo",type:{kind:"struct",fields:[{name:"user",docs:["User address"],type:"publicKey"},{name:"pair",docs:["Pair address"],type:"publicKey"}]}}],types:[{name:"UpdatePairData",type:{kind:"struct",fields:[{name:"newAuthority",type:{option:"publicKey"}},{name:"isPaused",type:{option:"bool"}},{name:"ratio",type:{option:{defined:"Ratio"}}},{name:"lockFee",type:{option:"u16"}},{name:"unlockFee",type:{option:"u16"}},{name:"feeReceiver",type:{option:"publicKey"}}]}},{name:"Ratio",type:{kind:"struct",fields:[{name:"num",type:"u64"},{name:"denom",type:"u64"}]}}],events:[{name:"LockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!1},{name:"userAuthority",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"UnlockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!1},{name:"userAuthority",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]}],errors:[{code:6e3,name:"Unauthorized",msg:"Unauthorized action"},{code:6001,name:"IsPaused",msg:"Paused"},{code:6002,name:"AlreadyResumed",msg:"Already resumed"},{code:6003,name:"StillRemainingLockedTokens",msg:"Pair still have locked tokens"},{code:6004,name:"IsBlocked",msg:"User is blocked"},{code:6005,name:"AlreadyUnblocked",msg:"User is already unblocked"},{code:6006,name:"InsufficientLockedAmount",msg:"Insufficient locked amount"},{code:6007,name:"InsufficientFunds",msg:"Insufficient funds"}]};function Re(i){return"version"in i}class Di{constructor(e){this.payer=e}async signTransaction(e){return Re(e)?e.sign([this.payer]):e.partialSign(this.payer),e}async signAllTransactions(e){return e.map(t=>(Re(t)?t.sign([this.payer]):t.partialSign(this.payer),t))}get publicKey(){return this.payer.publicKey}}const Wi="user",zi="manager",Ri="pair",Ui="admin",Fi="whitelist",ce=class ce{constructor(e){A(this,"program");this.provider=e,this.program=new Ye(Mi,ze,e)}static fromWallet(e,t,s){return new this(new Pe(e,t??{publicKey:g.default},{...Pe.defaultOptions(),...s}))}static fromKeypair(e,t,s){return ce.fromWallet(e,new Di(t),s)}get idl(){return this.program.idl}get pda(){return new Ji}fetchManager(e){return this.program.account.manager.fetchNullable(e)}fetchAdmin(e){return this.program.account.admin.fetchNullable(e??this.pda.admin()[0])}fetchUser(e){return this.program.account.user.fetchNullable(e)}fetchPair(e){return this.program.account.pair.fetchNullable(e)}fetchWhitelistedUserInfo(e){return this.program.account.whitelistedUserInfo.fetchNullable(e)}fetchWhitelistedUserInfoByUserAndPair(e,t){const[s]=this.pda.whitelistedUserInfo(e,t);return this.fetchWhitelistedUserInfo(s)}findManagers(){return this.program.account.manager.all()}findPairs(){return this.program.account.pair.all()}async findManagerPairs(e){return(await this.program.account.pair.all()).filter(s=>s.account.authority.toBase58()===e.toBase58())}async findWhitelistedUsers(e){return(await this.program.account.whitelistedUserInfo.all()).filter(s=>s.account.pair.toBase58()===e.toBase58())}async findUserWhitelistInfos(e){return(await this.program.account.whitelistedUserInfo.all()).filter(s=>s.account.user.toBase58()===e.toBase58())}async addManager(e){const t=this.provider.publicKey,[s]=this.pda.manager(e.managerWallet),[n]=this.pda.admin(),r=zt({authority:t,admin:n,manager:s},{key:e.managerWallet}),c=new x().add(r);return{signature:await this.provider.sendAndConfirm(c),manager:s}}async addPair(e){const t=this.provider.publicKey,[s]=this.pda.manager(t),n=e.tokenA;let r=e.tokenB;const c=new x,l=[];let d,p;if(r)d=this.pda.pair(n,r)[0],p=this.pda.pairAuthority(d)[0],c.add(At(r,this.provider.publicKey,wt.MintTokens,p));else{const m=e.tokenBKeypair??Ke.generate();r=m.publicKey,l.push(m),d=this.pda.pair(n,r)[0],p=this.pda.pairAuthority(d)[0];const f=await et(this.provider.connection);c.add(B.createAccount({fromPubkey:t,newAccountPubkey:m.publicKey,space:tt,lamports:f,programId:ne}),it(m.publicKey,9,p,null,ne))}return await this.handleMissingTokenAccount(c,n,p),await this.handleMissingTokenAccount(c,r,p),c.add(Ft({authority:t,manager:s,pair:d,pairAuthority:p,tokenA:n,tokenB:r},{ratio:e.ratio??{num:1,denom:1},policy:e.policy??null})),{signature:await this.provider.sendAndConfirm(c,l),pair:d}}async lockTokens(e){const t=this.provider.publicKey,s=e.tokenA,n=e.tokenB,[r]=this.pda.user(t),[c]=this.pda.pair(s,n),l=await this.fetchPair(c),[d]=this.pda.admin(),[p]=this.pda.manager(l.authority),[w]=this.pda.pairAuthority(c),[m]=this.pda.whitelistedUserInfo(t,c),f=new x,b=Te(s,t),S=await this.handleMissingTokenAccount(f,s,w),v=await this.handleMissingTokenAccount(f,n,t);return f.add(Zt({proofRequest:e.proofRequest,user:r,userAuthority:t,pair:c,pairAuthority:w,admin:d,manager:p,whitelistedUserInfo:m,feePayer:e.feePayer??t,feeReceiver:l.feeReceiver,sourceA:b,destinationA:S,destinationB:v,tokenA:s,tokenB:n},{amount:new we(e.amount)})),{signature:await this.provider.sendAndConfirm(f),pair:c}}async unlockTokens(e){const t=this.provider.publicKey,s=e.tokenA,n=e.tokenB,[r]=this.pda.admin(),[c]=this.pda.user(t),[l]=this.pda.pair(s,n),[d]=this.pda.pairAuthority(l),[p]=this.pda.whitelistedUserInfo(t,l),w=await this.fetchPair(l),[m]=this.pda.manager(w.authority),f=new x,b=await this.handleMissingTokenAccount(f,n,t),S=await this.handleMissingTokenAccount(f,s,d),v=await this.handleMissingTokenAccount(f,s,t);return f.add(Ai({proofRequest:e.proofRequest,user:c,userAuthority:t,pair:l,pairAuthority:d,feePayer:e.feePayer??t,feeReceiver:w.feeReceiver,whitelistedUserInfo:p,admin:r,destinationA:v,manager:m,sourceA:S,sourceB:b,tokenA:s,tokenB:n},{amount:new we(e.amount)})),{signature:await this.provider.sendAndConfirm(f),pair:l,user:c}}async addUserToWhitelist(e){const t=this.provider.publicKey,[s]=this.pda.manager(t),n=e.userWallet,[r]=this.pda.user(n),c=e.tokenA,l=e.tokenB,[d]=this.pda.pair(c,l),[p]=this.pda.whitelistedUserInfo(n,d),w=Ct({userAuthority:n,authority:t,manager:s,pair:d,tokenA:c,tokenB:l,user:r,whitelistedUserInfo:p}),m=new x().add(w);return{signature:await this.provider.sendAndConfirm(m),user:r,whitelistedUserInfo:p}}async removeUserFromWhitelist(e){const t=this.provider.publicKey,s=e.userWallet,[n]=this.pda.user(s),[r]=this.pda.pair(e.tokenA,e.tokenB),[c]=this.pda.whitelistedUserInfo(s,r),l=ai({authority:t,pair:r,whitelistedUserInfo:c}),d=new x().add(l);return{signature:await this.provider.sendAndConfirm(d),user:n,whitelistedUserInfo:c}}async blockUser(e){const t=this.provider.publicKey,[s]=this.pda.manager(t),n=e.userWallet,[r]=this.pda.user(n),c=Vt({authority:t,manager:s,user:r}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),user:r}}async unblockUser(e){const t=this.provider.publicKey,s=e.userWallet,[n]=this.pda.manager(t),[r]=this.pda.user(s),c=ki({authority:t,manager:n,user:r}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),user:r}}async pausePairs(e){const t=this.provider.publicKey,s=e.managerWallet,[n]=this.pda.manager(s),[r]=this.pda.admin(),c=jt({admin:r,authority:t,manager:n}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:n}}async pausePlatform(){const e=this.provider.publicKey,[t]=this.pda.admin(),s=Gt({admin:t,authority:e}),n=new x().add(s);return{signature:await this.provider.sendAndConfirm(n),admin:t}}async removeManager(e){const t=this.provider.publicKey,s=e.managerWallet,[n]=this.pda.manager(s),[r]=this.pda.admin(),c=ei({admin:r,authority:t,manager:n}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:n}}async removePair(e){const t=this.provider.publicKey,s=e.tokenA,n=e.tokenB,[r]=this.pda.pair(s,n),c=ni({authority:t,pair:r}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),pair:r}}async resumePairs(e){const t=this.provider.publicKey,s=e.managerWallet,[n]=this.pda.manager(s),[r]=this.pda.admin(),c=ui({authority:t,admin:r,manager:n}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:n}}async resumePlatform(){const e=this.provider.publicKey,[t]=this.pda.admin(),s=mi({authority:e,admin:t}),n=new x().add(s);return{signature:await this.provider.sendAndConfirm(n),admin:t}}async setAdmin(e){const t=this.provider.publicKey,[s]=this.pda.admin(),n=yi({authority:t,admin:s},{key:e.authority}),r=new x().add(n);return{signature:await this.provider.sendAndConfirm(r)}}async withdrawFee(e){const t=this.provider.publicKey,[s]=this.pda.pair(e.tokenA,e.tokenB),[n]=this.pda.pairAuthority(s),r=Bi({authority:t,pair:s,pairAuthority:n,destination:e.destination},{amount:new we(e.amount)}),c=new x().add(r);return{signature:await this.provider.sendAndConfirm(c)}}async updatePair(e){const t=this.provider.publicKey,s=e.tokenA,n=e.tokenB,[r]=this.pda.pair(s,n),c=Pi({authority:t,pair:r},{data:{feeReceiver:e.feeReceiver??null,lockFee:e.lockFee??null,unlockFee:e.unlockFee??null,newAuthority:e.newAuthority??null,isPaused:e.isPaused??null,ratio:e.ratio??null}}),l=new x().add(c);return{signature:await this.provider.sendAndConfirm(l),pair:r}}async handleMissingTokenAccount(e,t,s){const n=s??this.provider.publicKey,r=Te(t,n,!0);try{await nt(this.provider.connection,r)}catch(c){(c instanceof st||c instanceof rt)&&e.add(at(this.provider.publicKey,r,n,t))}return r}};A(ce,"programId",ze);let oe=ce;class Ji{constructor(){A(this,"pairAuthority",e=>this.pda([new g(e).toBuffer()]));A(this,"admin",()=>this.pda([j.Buffer.from(Ui)]));A(this,"manager",e=>this.pda([j.Buffer.from(zi),new g(e).toBuffer()]));A(this,"user",e=>this.pda([j.Buffer.from(Wi),new g(e).toBuffer()]));A(this,"pair",(e,t)=>this.pda([j.Buffer.from(Ri),new g(e).toBuffer(),new g(t).toBuffer()]));A(this,"whitelistedUserInfo",(e,t)=>this.pda([j.Buffer.from(Fi),new g(e).toBuffer(),new g(t).toBuffer()]))}pda(e){return g.findProgramAddressSync(e,oe.programId)}}const be=ot("converter",()=>{const i=ue(),e=Ce(),{setContractPolicy:t,contractPolicy:s}=Ee(),n=ct({from:{amount:void 0},to:{amount:void 0},token:void 0,allTokens:[],pairs:[],selectedPair:void 0,searchToken:"",converting:!1,loading:!1,isLock:!0}),r=_(()=>oe.fromWallet(i.connection,e.value));async function c(m,f,b){try{const S=await lt.Metadata.fromAccountAddress(m,dt(f)),v=S.data?.uri;if(v){const{data:y}=await mt.get(v);return{...y,image:ae(y?.image)}}return S}catch{return{symbol:b,image:ae()}}}const l=m=>n.allTokens.find(b=>b.mint.toBase58()===m)?.balance??0,d=async()=>{try{const m=e.value?.publicKey;if(!m)return;n.allTokens=await ut(i.connection,m)}catch(m){console.log(m)}},p=async()=>{try{n.loading=!0;const m=await r.value.findPairs();if(n.pairs.length!==0)return;const f=await Promise.all(m.map(async b=>{const S=b.account,v=S.tokenA.toBase58(),y=S.tokenB.toBase58(),W=await c(i.connection,v,"tokenA"),I=await c(i.connection,y,"tokenB"),z={[v]:W,[y]:I};return{...b,tokensMetadata:z}}));n.pairs=f}catch(m){console.log(m)}finally{n.loading=!1}},w=async m=>{try{n.loading=!0;const f=await r.value.fetchPair(m);if(f){const b=n.pairs.findIndex(S=>S.publicKey.toBase58()===m);if(b!==-1){const S=n.pairs[b];n.pairs[b]={...S,account:f},n.selectedPair=n.pairs[b]}}}catch(f){console.log(f),await p()}finally{n.loading=!1}};return Le([()=>i.cluster,()=>r.value],async()=>{i.cluster==="devnet"&&Promise.all([await p(),await d()])},{immediate:!0,debounce:500,maxWait:1e3}),q(()=>i.cluster,m=>{m!=="devnet"&&(n.pairs=[],n.selectedPair=void 0,n.token=void 0,n.from={amount:void 0},n.to={amount:void 0},s?.converter&&delete s?.converter)}),q(()=>e.value?.publicKey,async m=>{if(!m){n.allTokens=[],n.from.balance=0,n.to.balance=0;return}await d()},{immediate:!0}),q([()=>n.token,()=>n.allTokens,()=>n.pairs],([m])=>{const f=n.selectedPair;if(!f)return;const b=f.account?.policy;b&&t(String(b));for(const S in f.tokensMetadata){const v=f.tokensMetadata[S],y=l(String(S));S===m?.mint?n.from={...v,balance:y,amount:void 0}:n.to={...v,balance:y,amount:void 0}}}),q(()=>n.isLock,()=>{n.token=void 0}),{state:n,getAllTokens:d,updatePairData:w,converterClient:r}});function je(){const i=be(),e=Ee(),t=ue(),{notify:s}=Ve();function n(y){console.log("set token ======== ",y),i.state.selectedPair=i.state.pairs.find(W=>W.publicKey.toBase58()===y?.publicKey?.toBase58()),i.state.token=y}function r(y){i.state.searchToken=y}const c=_(()=>i.state.pairs.map(I=>{const z=Object.entries(I.tokensMetadata)[i.state.isLock?0:1];return{...z[1],mint:z[0],publicKey:I.publicKey}}).flat().filter(I=>I.symbol.toLowerCase().includes(i.state.searchToken.toLowerCase()))),l=_(()=>i.state.selectedPair?.account),d=_(()=>l.value?.ratio?.num?.toNumber()??1),p=_(()=>l.value?.lockedAmount?l.value?.lockedAmount?.toNumber()/Ie:0),w=_(()=>l.value?.lockFee),m=_(()=>{const y=l.value?.tokenA?.toString();return De(y,i.state.selectedPair?.tokensMetadata)}),f=_(()=>{const y=l.value?.tokenB?.toString();return De(y,i.state.selectedPair?.tokensMetadata)}),b=_(()=>i.state.pairs.length===0),S=_(()=>!!e.state.certificates?.find(y=>y.data?.policy.toBase58()===String(e.requiredPolicy)));async function v(y=!0){const W=e.state.certificates?.find(I=>I.data?.policy.toBase58()===String(e.requiredPolicy))?.pubkey;if(!(!l.value||!W))try{i.state.converting=!0;const I=l.value.tokenA,z=l.value.tokenB,U=Number(i.state.from.amount*Ie)/(i.state.isLock?1:d.value);let H;y?H=await i.converterClient.lockTokens({tokenA:I,tokenB:z,amount:U,proofRequest:W}):H=await i.converterClient.unlockTokens({tokenA:I,tokenB:z,amount:U,proofRequest:W}),s({message:"Transaction confirmed",type:"positive",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${H.signature}?cluster=${t.cluster}`,onClick:()=>!1}]}),setTimeout(async()=>{Promise.all([await i.getAllTokens(),await i.updatePairData(i.state.selectedPair.publicKey.toBase58())])},1e3)}catch(I){console.error("lockedToken error: ",I),s({type:"negative",message:`${I}`})}finally{i.state.converting=!1}}return Le(c,y=>{y.length!==0&&!i.state.token&&n(y[0])},{immediate:!0,debounce:100,maxWait:1e3}),q(()=>i.state.from.amount,y=>{if(!y||Number.isNaN(Number(y))){i.state.to.amount=void 0;return}i.state.to.amount=i.state.isLock?y*d.value:y/d.value}),{options:c,setToken:n,handleSearchToken:r,pairRatio:d,pairLockedAmount:p,pairLockFee:w,tokenASymbol:m,tokenBSymbol:f,isHaveCertificate:S,lockUnlockToken:v,isDisabledInputs:b}}const Ki={class:"swap-form"},Ci={class:"swap-field"},Ei={class:"swap-field__info"},Li={class:"row items-end"},Vi=u("div",{class:"col swap-field__label"}," FROM: ",-1),Qi={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Ni={key:0,class:"insufficient-error"},Zi=u("div",{class:"swap-change"},null,-1),$i={class:"swap-field"},Hi={class:"swap-field__info"},ji={class:"row"},qi=u("div",{class:"col swap-field__label"}," TO: ",-1),Oi={class:"col swap-field__balance"},Gi={class:"convert-to"},Xi=["src"],Yi={class:"swap-info q-mt-md q-pt-xs"},en=u("dt",null,"Received",-1),tn=u("dt",null,"Locked amount",-1),nn=u("dt",null,"Exchange rate",-1),sn={key:0},rn={key:1},an=u("dt",null,"Lock fee",-1),on={class:"swap-submit q-mt-md"},cn={class:"row q-mt-md text-center relative-position full-width"},un={class:"swap-rate q-mx-auto"},ln=le({__name:"UnlockCard",setup(i){const{state:e}=be(),{options:t,setToken:s,handleSearchToken:n,pairRatio:r,pairLockedAmount:c,pairLockFee:l,tokenASymbol:d,tokenBSymbol:p,isHaveCertificate:w,lockUnlockToken:m,isDisabledInputs:f}=je();e.isLock=!1;const b=Ce(),{certificateExpired:S}=Qe(),v=_(()=>e.from.balance),y=_(()=>e.to.balance),W=_(()=>e.to.amount??0);function I(){e.from.amount=v.value}async function z(){await m(!1)}const U=_(()=>e.from.amount>v.value?"Insufficient funds":!1);return(H,F)=>{const Se=Je,Ae=Ue;return D(),O(ve,{class:"swap-card swap-widget converting-card"},{default:T(()=>[k(Ne,{class:"swap-card__body"},{default:T(()=>[u("div",Ki,[u("div",Ci,[u("div",Ei,[u("div",Li,[Vi,u("div",Qi,[a(U)?(D(),J("div",Ni,h(a(U)),1)):G("",!0),R(" Balance: "+h(a(se)(a(v))),1)])])]),k(re,{modelValue:a(e).from.amount,"onUpdate:modelValue":F[0]||(F[0]=E=>a(e).from.amount=E),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",disable:a(f),onKeypress:a(Fe)},{append:T(()=>[k($,{disable:a(f),dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:I},{default:T(()=>[R(" MAX ")]),_:1},8,["disable"]),a(e).token?(D(),O(Se,{key:0,options:a(t),token:a(e).token,"swap-token":String(a(e).to.symbol),onHandleSearchToken:a(n),onSetToken:a(s)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):G("",!0)]),_:1},8,["modelValue","disable","onKeypress"])]),Zi,u("div",$i,[u("div",Hi,[u("div",ji,[qi,u("div",Oi," Balance: "+h(a(se)(a(y))),1)])]),k(re,{modelValue:a(e).to.amount,"onUpdate:modelValue":F[1]||(F[1]=E=>a(e).to.amount=E),disable:a(f),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Ze({_:2},[a(e).to?.symbol?{name:"append",fn:T(()=>[u("div",Gi,[u("img",{src:a(ae)(a(e).to?.image)},null,8,Xi),R(),u("span",null,h(a(e).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue","disable"])])]),u("div",Yi,[u("dl",null,[en,u("dd",null,h(a(W))+" "+h(a(p)),1)]),u("dl",null,[tn,u("dd",null,h(a(c))+" "+h(a(d)),1)]),u("dl",null,[nn,a(r)?(D(),J("dd",sn," 1 "+h(a(p))+" = "+h(1/a(r))+" "+h(a(d)),1)):(D(),J("dd",rn," - "))]),u("dl",null,[an,u("dd",null,h(a(l))+" SOL",1)])]),k(Ae,{class:"q-mt-md q-mx-auto"}),u("div",on,[k($,{loading:a(e).converting,rounded:"",ripple:!1,disable:!a(b)?.publicKey||!a(e).from.amount||a(e).from.amount<=0||!!a(U)||!a(w)||a(S),onClick:z},{default:T(()=>[R(" Unlock token ")]),_:1},8,["loading","disable"])]),u("div",cn,[u("div",un," 1 "+h(a(p))+" = "+h(1/a(r))+" "+h(a(d)),1)])]),_:1}),k($e,{showing:a(e)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),dn={class:"swap-form"},mn={class:"swap-field"},fn={class:"swap-field__info"},pn={class:"row items-end"},yn=u("div",{class:"col swap-field__label"}," FROM: ",-1),gn={class:"col-8 col-xs-10 row justify-end swap-field__balance"},hn={key:0,class:"insufficient-error"},kn=u("div",{class:"swap-change"},null,-1),bn={class:"swap-field"},Sn={class:"swap-field__info"},An={class:"row"},wn=u("div",{class:"col swap-field__label"}," TO: ",-1),vn={class:"col swap-field__balance"},_n={class:"convert-to"},Pn=["src"],Tn={class:"swap-info q-mt-md q-pt-xs"},In=u("dt",null,"Received",-1),Bn=u("dt",null,"Locked amount",-1),xn=u("dt",null,"Exchange rate",-1),Mn={key:0},Dn={key:1},Wn=u("dt",null,"Lock fee",-1),zn={class:"swap-submit q-mt-md"},Rn={class:"row q-mt-md text-center relative-position full-width"},Un={class:"swap-rate q-mx-auto"},Fn=le({__name:"LockCard",setup(i){const e=He(),{state:t}=be(),{options:s,setToken:n,handleSearchToken:r,pairRatio:c,pairLockedAmount:l,pairLockFee:d,tokenASymbol:p,tokenBSymbol:w,isHaveCertificate:m,lockUnlockToken:f,isDisabledInputs:b}=je();t.isLock=!0;const S=_(()=>t.from.balance),v=_(()=>t.to.balance),y=_(()=>t.to.amount??0),{certificateExpired:W}=Qe();function I(){t.from.amount=S.value}async function z(){await f()}const U=_(()=>t.from.amount>S.value?"Insufficient funds":!1);return(H,F)=>{const Se=Je,Ae=Ue;return D(),O(ve,{class:"swap-card swap-widget converting-card"},{default:T(()=>[k(Ne,{class:"swap-card__body"},{default:T(()=>[u("div",dn,[u("div",mn,[u("div",fn,[u("div",pn,[yn,u("div",gn,[a(U)?(D(),J("div",hn,h(a(U)),1)):G("",!0),R(" Balance: "+h(a(se)(a(S))),1)])])]),k(re,{modelValue:a(t).from.amount,"onUpdate:modelValue":F[0]||(F[0]=E=>a(t).from.amount=E),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",disable:a(b),onKeypress:a(Fe)},{append:T(()=>[k($,{disable:a(b),dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:I},{default:T(()=>[R(" MAX ")]),_:1},8,["disable"]),a(t).token?(D(),O(Se,{key:0,options:a(s),token:a(t).token,"swap-token":String(a(t).to.symbol),onHandleSearchToken:a(r),onSetToken:a(n)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):G("",!0)]),_:1},8,["modelValue","disable","onKeypress"])]),kn,u("div",bn,[u("div",Sn,[u("div",An,[wn,u("div",vn," Balance: "+h(a(se)(a(v))),1)])]),k(re,{modelValue:a(t).to.amount,"onUpdate:modelValue":F[1]||(F[1]=E=>a(t).to.amount=E),disable:a(b),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Ze({_:2},[a(t).to?.symbol?{name:"append",fn:T(()=>[u("div",_n,[u("img",{src:a(ae)(a(t).to?.image)},null,8,Pn),R(),u("span",null,h(a(t).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue","disable"])])]),u("div",Tn,[u("dl",null,[In,u("dd",null,h(a(y))+" "+h(a(w)),1)]),u("dl",null,[Bn,u("dd",null,h(a(l))+" "+h(a(p)),1)]),u("dl",null,[xn,a(c)?(D(),J("dd",Mn," 1 "+h(a(p))+" = "+h(a(c))+" "+h(a(w)),1)):(D(),J("dd",Dn," - "))]),u("dl",null,[Wn,u("dd",null,h(a(d))+" SOL",1)])]),k(Ae,{class:"q-mt-md q-mx-auto"}),u("div",zn,[k($,{loading:a(t).converting,rounded:"",ripple:!1,disable:!a(e)?.publicKey||!a(t).from.amount||a(t).from.amount<=0||!!a(U)||!a(m)||a(W),onClick:z},{default:T(()=>[R(" Lock token ")]),_:1},8,["loading","disable"])]),u("div",Rn,[u("div",Un," 1 "+h(a(p))+" = "+h(a(c))+" "+h(a(w)),1)])]),_:1}),k($e,{showing:a(t)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),Jn="/assets/faucet-icon-e5ad8100.svg",Kn={class:"converter"},Cn=u("div",{class:"converter-faucet__descr"}," Click the faucet to get opTK tokens. ",-1),En=["src"],Ln=le({__name:"ConverterCard",setup(i){const e=ue(),{publicKey:t}=He(),s=be(),{notify:n}=Ve(),r=ft("lock"),c=_(()=>e.cluster==="devnet");async function l(){if(t.value)try{s.state.loading=!0;const d=Ke.fromSecretKey(vt.decode("38f57pVjJEb9wGuzAmonU2k76ctmrDWBVyn9v5hMMURLVqYC5xWwd31UhHAWmNkTwvh1r8d1SgNoLKTiDUDnTo1u")),p=new g("CDcwg5UiZcXBtQ7eBRZpSr23vHntpGotmmgCSoxAjfrM"),w=await _t(e.connection,d,p,t.value);await Pt(e.connection,d,p,w.address,d,1e10),await s.getAllTokens(),s.state.from.amount=10,n({type:"positive",message:"You got 10 opTK"})}catch(d){console.log("failed mint e:",d)}finally{s.state.loading=!1}}return(d,p)=>{const w=Fn,m=ln;return D(),J("div",Kn,[a(s).state.pairs.length!==0&&a(c)&&a(t)?(D(),O($,{key:0,class:"converter-faucet",unelevated:"",dense:"",loading:a(s).state.loading,onClick:l},{default:T(()=>[Cn,u("img",{src:a(Jn),alt:"faucet icon"},null,8,En)]),_:1},8,["loading"])):G("",!0),k(ve,{class:"liquidity-tabs swap-card swap-widget"},{default:T(()=>[k(pt,{modelValue:a(r),"onUpdate:modelValue":p[0]||(p[0]=f=>Be(r)?r.value=f:null),align:"justify","indicator-color":"transparent",class:yt(d.$q.dark.isActive?"bg-blue-grey-9":"bg-grey-3"),"active-color":"white","active-bg-color":"primary"},{default:T(()=>[k(xe,{ripple:!1,label:"LOCK",name:"lock"}),k(xe,{ripple:!1,label:"UNLOCK",name:"unlock"})]),_:1},8,["modelValue","class"]),k(gt,{modelValue:a(r),"onUpdate:modelValue":p[1]||(p[1]=f=>Be(r)?r.value=f:null),animated:"",class:"bg-transparent"},{default:T(()=>[k(Me,{name:"lock"},{default:T(()=>[k(w)]),_:1}),k(Me,{name:"unlock"},{default:T(()=>[k(m)]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});const Vn={class:"app-description converter-description"},Qn=u("div",{class:"app-description__details"},[R(" The converter works exclusively in presentation mode and only on the "),u("b",null,"devnet network"),R(". You can get acquainted with the functionality by switching Solana RPC Network ")],-1),Nn=le({__name:"ConverterDescription",setup(i){const e=ht("rpc",""),t=ue(),s=_(()=>e.value==="devnet");function n(){s.value||t.setRpc("devnet")}return kt(()=>{}),(r,c)=>(D(),J("div",Vn,[k($,{disable:a(s),class:"switch-network-btn",unelevated:"",onClick:n},{default:T(()=>[R(h(a(s)?"devnet":"switch network"),1)]),_:1},8,["disable"]),Qn]))}});const Zn={},$n={class:"main-block row justify-center"};function Hn(i,e){const t=Nn,s=Ln,n=Ge,r=Xe;return D(),J(St,null,[k(t,{class:"q-mt-lg"}),u("div",$n,[k(s)]),k(n,{class:"q-mt-lg"}),k(r,{class:"q-mt-lg"})],64)}const is=bt(Zn,[["render",Hn]]);export{is as default};
