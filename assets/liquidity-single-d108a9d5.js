import{_ as O,a as W}from"./AppDescription-977702ab.js";import{_ as G}from"./SelectPool.vue_vue_type_script_setup_true_lang-c9a06883.js";import{o as z,_ as J}from"./SelectToken.vue_vue_type_script_setup_true_lang-ec816a4d.js";import{x as X,y as Z,C as Y,F as ee,G as oe,A as i,I as ae,N as L,aG as ne,Z as te,$ as se,M as I,B as le,ak as V,L as ie,J as ce,o as w,a2 as re,a3 as d,a4 as de,k as n,a5 as S,a6 as D,a7 as a,a8 as e,j as b,aa as l,a9 as ue,ab as T,ac as F,ad as y,al as pe,ao as me,ap as _e,ae as fe,a0 as ke,ag as we,ah as ge,U as ve,_ as he,ai as Se}from"./index-3ffc9397.js";import{s as Te}from"./swap-circle-a93e350f.js";import{u as Q,S as ye}from"./swap-879f5691.js";import{_ as be}from"./AppDescriptionTop-2398cb68.js";import"./PoolsListItem.vue_vue_type_script_setup_true_lang-bfea85f1.js";import"./internal-59b3b800.js";const Ae=X("liquidity-single",()=>{const A=Z(),p=Y(),{publicKey:o}=ee(),{notify:m}=oe(),c=Q(),s=i(()=>c.tokenSwap),u=i(()=>c.state),B=i(()=>c.swapClient),t=ae({swapping:!1,active:!1,amountTokenA:0});function C(){c.loadPoolTokenAccounts(),c.reloadUserLP(),t.amountTokenA=0}async function g(){if(!s.value||!o.value){console.log("Pool is not selected...");return}try{t.swapping=!0;const r=u.value.direction===ye.ASC?s.value.data.tokenAMint:s.value.data.tokenBMint,v=await L(r,p.value.publicKey),h=await L(s.value.data.poolMint,p.value.publicKey),q=Number(ne(t.amountTokenA??0,u.value.from.decimals)),x=await B.value.depositSingleTokenTypeExactAmountIn({tokenSwap:s.value?.pubkey,poolMint:s.value.data.poolMint,sourceTokenMint:r,source:v,destination:h,swapTokenA:s.value.data.tokenA,swapTokenB:s.value.data.tokenB,sourceTokenAmount:q,minimumPoolTokenAmount:0});C(),m({message:"Transaction confirmed",type:"positive",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${x}?cluster=${A.cluster}`,onClick:()=>!1}]})}catch(r){console.log(r),console.error(r.logs),`${r}`.includes("User rejected the request")||m({type:"negative",message:`${r}`})}finally{t.swapping=!1}}return{state:t,depositSingleToken:g}}),Be={class:"swap-form"},Ce={class:"swap-field"},qe={class:"swap-field__info"},xe={class:"row items-end"},Me=a("div",{class:"col swap-field__label"},null,-1),Ne={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Ee={key:0,class:"insufficient-error"},$e={class:"swap-change"},Pe=["innerHTML"],Le={class:"swap-field"},Ie={class:"swap-field__info q-mt-sm"},Ve={class:"row"},De={class:"col swap-field__balance"},Fe={class:"swap-submit q-mt-lg"},Qe={key:0,class:"text-weight-medium fs-13 text-center q-mt-md text-negative"},He={key:1,class:"row q-mt-md text-center relative-position full-width"},Re={class:"absolute-right swap-rate__refresh"},Ue={class:"swap-info q-mt-lg"},Ke=te({__name:"DepositSingleCard",setup(A){const p=Q(),{state:o,loadingPoolTokens:m,changeDirection:c,loadPoolTokenAccounts:s}=p,u=i(()=>p.tokenSwap),B=Ae(),{state:t,depositSingleToken:C}=B,{handleSearchToken:g,handleFilterToken:r,tokens:v}=se();r(I);const h=le(),q=i(()=>o.poolBalance[o.from.mint]?V(o.poolBalance[o.from.mint],o.from.decimals):0),x=i(()=>o.poolBalance[o.to.mint]?V(o.poolBalance[o.to.mint],o.to.decimals):0),E=ie(0),H=i(()=>`transform: rotate(${E.value*180}deg)`),f=i(()=>h.tokenBalance(o.from.mint)),R=i(()=>h.tokenBalance(o.to.mint));function U(){c(),E.value++}function $(k,_){o[_?"to":"from"]=k}function K(){o.from?.mint===I||o.from?.mint===ke?t.amountTokenA=f.value-we-3*ge-ve:t.amountTokenA=f.value}const M=i(()=>Number(t.amountTokenA)>f.value?"Insufficient funds":!1);return ce([()=>t.amountTokenA,u,f],k=>{t.active=!M.value}),(k,_)=>{const P=J,j=G;return w(),re(de,{class:"swap-card swap-widget"},{default:d(()=>[n(D,{class:"swap-card__header"},{default:d(()=>[S(" Deposit ")]),_:1}),n(D,{class:"swap-card__body"},{default:d(()=>[a("div",Be,[a("div",Ce,[a("div",qe,[a("div",xe,[Me,a("div",Ne,[e(M)?(w(),b("div",Ee,l(e(M)),1)):ue("",!0),S(" Balance: "+l(e(T)(e(f)))+" "+l(e(o).from.symbol),1)])])]),n(F,{modelValue:e(t).amountTokenA,"onUpdate:modelValue":_[0]||(_[0]=N=>e(t).amountTokenA=N),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",onKeypress:e(z)},{append:d(()=>[n(y,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:K},{default:d(()=>[S(" MAX ")]),_:1}),n(P,{options:e(v),token:e(o).from,"swap-token":String(e(o).to.symbol),onHandleSearchToken:e(g),onSetToken:$},null,8,["options","token","swap-token","onHandleSearchToken"])]),_:1},8,["modelValue","onKeypress"])]),a("div",$e,[n(y,{ripple:!1,dense:"",unelevated:"",style:pe(e(H)),onClick:U},{default:d(()=>[a("i",{innerHTML:e(Te)},null,8,Pe)]),_:1},8,["style"])]),a("div",Le,[a("div",Ie,[a("div",Ve,[a("div",De," Balance: "+l(e(T)(e(R)))+" "+l(e(o).to.symbol),1)])]),n(F,{modelValue:void 0,"onUpdate:modelValue":_[1]||(_[1]=N=>undefined=N),readonly:"",outlined:"",class:"swap-input"},{append:d(()=>[n(P,{"swap-token":String(e(o).from.symbol),options:e(v),direction:!0,token:e(o).to,"destination-unavailable":!e(u),onHandleSearchToken:e(g),onSetToken:$},null,8,["swap-token","options","token","destination-unavailable","onHandleSearchToken"])]),_:1})])]),n(j,{class:"q-mt-md"}),a("div",Fe,[n(y,{loading:e(t).swapping,disable:!e(t).active||!e(u)||!e(t).amountTokenA,rounded:"",ripple:!1,onClick:e(C)},{default:d(()=>[S(" Add Liquidity ("+l(e(o).from.symbol)+") ",1)]),_:1},8,["loading","disable","onClick"])]),e(u)?(w(),b("div",He,[a("div",Re,[n(y,{loading:e(m),class:"swap-card__reload",unelevated:"",color:k.$q.dark.isActive?"white":"primary",round:"",onClick:e(s)},{default:d(()=>[n(me,{name:e(_e),color:k.$q.dark.isActive?"primary":"white"},null,8,["name","color"])]),_:1},8,["loading","color","onClick"])])])):(w(),b("div",Qe," Pool not found ")),a("div",Ue,[a("dl",null,[a("dt",null,"Pool "+l(e(o).from.symbol)+" balance",1),a("dd",null,l(e(T)(e(q))),1)]),a("dl",null,[a("dt",null,"Pool "+l(e(o).to.symbol)+" balance",1),a("dd",null,l(e(T)(e(x))),1)])])]),_:1}),n(fe,{showing:e(o)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),je={},Oe={class:"main-block row justify-center"};function We(A,p){const o=be,m=Ke,c=O,s=W;return w(),b(Se,null,[n(o,{class:"q-mt-lg"}),a("div",Oe,[n(m)]),n(c,{class:"q-mt-lg"}),n(s,{class:"q-mt-lg"})],64)}const no=he(je,[["render",We]]);export{no as default};
