import{_ as W,a as z,b as O}from"./AppDescriptionTop-95b7626c.js";import{_ as X}from"./SelectPool.vue_vue_type_script_setup_true_lang-a52de419.js";import{_ as G}from"./SelectToken.vue_vue_type_script_setup_true_lang-3d1b8d85.js";import{s as Y,u as Z,x as J,y as ee,z as oe,v as i,B as ne,I as V,aN as ae,V as te,W as se,H as I,w as le,ax as L,G as ie,C as ce,o as w,Y as re,Z as r,$ as de,j as a,a0 as S,a1 as D,a2 as n,a3 as e,i as b,a5 as l,a4 as ue,a6 as T,a7 as F,a8 as y,az as pe,aA as me,aB as _e,a9 as fe,X as ke,ab as we,ac as ve,N as ge,_ as he,ad as Se}from"./index-7dab536f.js";import{o as Te}from"./common-21d1f462.js";import{s as ye}from"./swap-circle-a93e350f.js";import{u as H,S as be}from"./swap-94abc5a4.js";import"./PoolsListItem.vue_vue_type_script_setup_true_lang-e9064406.js";import"./associatedTokenAccount-53570150.js";const Ae=Y("liquidity-single",()=>{const A=Z(),p=J(),{publicKey:o}=ee(),{notify:m}=oe(),c=H(),s=i(()=>c.tokenSwap),u=i(()=>c.state),B=i(()=>c.swapClient),t=ne({swapping:!1,active:!1,amountTokenA:0});function C(){c.loadPoolTokenAccounts(),c.reloadUserLP(),t.amountTokenA=0}async function v(){if(!s.value||!o.value){console.log("Pool is not selected...");return}try{t.swapping=!0;const d=u.value.direction===be.ASC?s.value.data.tokenAMint:s.value.data.tokenBMint,g=await V(d,p.value.publicKey),h=await V(s.value.data.poolMint,p.value.publicKey),x=Number(ae(t.amountTokenA??0,u.value.from.decimals)),q=await B.value.depositSingleTokenTypeExactAmountIn({tokenSwap:s.value?.pubkey,poolMint:s.value.data.poolMint,sourceTokenMint:d,source:g,destination:h,swapTokenA:s.value.data.tokenA,swapTokenB:s.value.data.tokenB,sourceTokenAmount:x,minimumPoolTokenAmount:0});C(),m({message:"Transaction confirmed",type:"positive",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${q}?cluster=${A.cluster}`,onClick:()=>!1}]})}catch(d){console.log(d),`${d}`.includes("User rejected the request")||m({type:"negative",message:`${d}`})}finally{t.swapping=!1}}return{state:t,depositSingleToken:v}}),Be={class:"swap-form"},Ce={class:"swap-field"},xe={class:"swap-field__info"},qe={class:"row items-end"},Ne=n("div",{class:"col swap-field__label"},null,-1),Me={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Ee={key:0,class:"insufficient-error"},$e={class:"swap-change"},Pe=["innerHTML"],Ve={class:"swap-field"},Ie={class:"swap-field__info q-mt-sm"},Le={class:"row"},De={class:"col swap-field__balance"},Fe={class:"swap-submit q-mt-lg"},He={key:0,class:"text-weight-medium fs-13 text-center q-mt-md text-negative"},Qe={key:1,class:"row q-mt-md text-center relative-position full-width"},Re={class:"absolute-right swap-rate__refresh"},Ke={class:"swap-info q-mt-lg"},Ue=te({__name:"DepositSingleCard",setup(A){const p=H(),{state:o,loadingPoolTokens:m,changeDirection:c,loadPoolTokenAccounts:s}=p,u=i(()=>p.tokenSwap),B=Ae(),{state:t,depositSingleToken:C}=B,{handleSearchToken:v,handleFilterToken:d,tokens:g}=se();d(I);const h=le(),x=i(()=>o.poolBalance[o.from.mint]?L(o.poolBalance[o.from.mint],o.from.decimals):0),q=i(()=>o.poolBalance[o.to.mint]?L(o.poolBalance[o.to.mint],o.to.decimals):0),E=ie(0),Q=i(()=>`transform: rotate(${E.value*180}deg)`),f=i(()=>h.tokenBalance(o.from.mint)),R=i(()=>h.tokenBalance(o.to.mint));function K(){c(),E.value++}function $(k,_){o[_?"to":"from"]=k}function U(){o.from?.mint===I||o.from?.mint===ke?t.amountTokenA=f.value-we-3*ve-ge:t.amountTokenA=f.value}const N=i(()=>Number(t.amountTokenA)>f.value?"Insufficient funds":!1);return ce([()=>t.amountTokenA,u,f],k=>{t.active=!N.value}),(k,_)=>{const P=G,j=X;return w(),re(de,{class:"swap-card swap-widget"},{default:r(()=>[a(D,{class:"swap-card__header"},{default:r(()=>[S(" Deposit ")]),_:1}),a(D,{class:"swap-card__body"},{default:r(()=>[n("div",Be,[n("div",Ce,[n("div",xe,[n("div",qe,[Ne,n("div",Me,[e(N)?(w(),b("div",Ee,l(e(N)),1)):ue("",!0),S(" Balance: "+l(e(T)(e(f)))+" "+l(e(o).from.symbol),1)])])]),a(F,{modelValue:e(t).amountTokenA,"onUpdate:modelValue":_[0]||(_[0]=M=>e(t).amountTokenA=M),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",onKeypress:e(Te)},{append:r(()=>[a(y,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:U},{default:r(()=>[S(" MAX ")]),_:1}),a(P,{options:e(g),token:e(o).from,"swap-token":String(e(o).to.symbol),onHandleSearchToken:e(v),onSetToken:$},null,8,["options","token","swap-token","onHandleSearchToken"])]),_:1},8,["modelValue","onKeypress"])]),n("div",$e,[a(y,{ripple:!1,dense:"",unelevated:"",style:pe(e(Q)),onClick:K},{default:r(()=>[n("i",{innerHTML:e(ye)},null,8,Pe)]),_:1},8,["style"])]),n("div",Ve,[n("div",Ie,[n("div",Le,[n("div",De," Balance: "+l(e(T)(e(R)))+" "+l(e(o).to.symbol),1)])]),a(F,{modelValue:void 0,"onUpdate:modelValue":_[1]||(_[1]=M=>undefined=M),readonly:"",outlined:"",class:"swap-input"},{append:r(()=>[a(P,{"swap-token":String(e(o).from.symbol),options:e(g),direction:!0,token:e(o).to,"destination-unavailable":!e(u),onHandleSearchToken:e(v),onSetToken:$},null,8,["swap-token","options","token","destination-unavailable","onHandleSearchToken"])]),_:1})])]),a(j,{class:"q-mt-md"}),n("div",Fe,[a(y,{loading:e(t).swapping,disable:!e(t).active||!e(u)||!e(t).amountTokenA,rounded:"",ripple:!1,onClick:e(C)},{default:r(()=>[S(" Add Liquidity ("+l(e(o).from.symbol)+") ",1)]),_:1},8,["loading","disable","onClick"])]),e(u)?(w(),b("div",Qe,[n("div",Re,[a(y,{loading:e(m),class:"swap-card__reload",unelevated:"",color:k.$q.dark.isActive?"white":"primary",round:"",onClick:e(s)},{default:r(()=>[a(me,{name:e(_e),color:k.$q.dark.isActive?"primary":"white"},null,8,["name","color"])]),_:1},8,["loading","color","onClick"])])])):(w(),b("div",He," Pool not found ")),n("div",Ke,[n("dl",null,[n("dt",null,"Pool "+l(e(o).from.symbol)+" balance",1),n("dd",null,l(e(T)(e(x))),1)]),n("dl",null,[n("dt",null,"Pool "+l(e(o).to.symbol)+" balance",1),n("dd",null,l(e(T)(e(q))),1)])])]),_:1}),a(fe,{showing:e(o)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),je={},We={class:"main-block row justify-center"};function ze(A,p){const o=W,m=Ue,c=z,s=O;return w(),b(Se,null,[a(o,{class:"q-mt-lg"}),n("div",We,[a(m)]),a(c,{class:"q-mt-lg"}),a(s,{class:"q-mt-lg"})],64)}const ao=he(je,[["render",ze]]);export{ao as default};
