import{g as Gt,l as Ut,a as G,c as Et,D as Ft,T as Fe,d as jt,e as Xt,f as Vt}from"./index-f862f4d4.js";var dt={};const Bt=Gt(Ut);(function(r){r.__esModule=!0;var e=Bt,t=5;function n(a){var f=G.Buffer.alloc(2);return f.writeUInt16BE(a,0),f}var i={data:G.Buffer.alloc(0),dataLength:0,sequence:0},s=function(a,f){return{makeBlocks:function(o){var h=G.Buffer.concat([n(o.length),o]),l=f-5,u=Math.ceil(h.length/l);h=G.Buffer.concat([h,G.Buffer.alloc(u*l-h.length+1).fill(0)]);for(var g=[],p=0;p<u;p++){var w=G.Buffer.alloc(5);w.writeUInt16BE(a,0),w.writeUInt8(t,2),w.writeUInt16BE(p,3);var B=h.slice(p*l,(p+1)*l);g.push(G.Buffer.concat([w,B]))}return g},reduceResponse:function(o,h){var l=o||i,u=l.data,g=l.dataLength,p=l.sequence;if(h.readUInt16BE(0)!==a)throw new e.TransportError("Invalid channel","InvalidChannel");if(h.readUInt8(2)!==t)throw new e.TransportError("Invalid tag","InvalidTag");if(h.readUInt16BE(3)!==p)throw new e.TransportError("Invalid sequence","InvalidSequence");o||(g=h.readUInt16BE(5)),p++;var w=h.slice(o?5:7);return u=G.Buffer.concat([u,w]),u.length>g&&(u=u.slice(0,g)),{data:u,dataLength:g,sequence:p}},getReducedResult:function(o){if(o&&o.dataLength===o.data.length)return o.data}}};r.default=s})(dt);const qt=Et(dt);var Te={exports:{}};const Mt="2.0.0",Ht=256,zt=Number.MAX_SAFE_INTEGER||9007199254740991,Yt=16,Wt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var he={MAX_LENGTH:Ht,MAX_SAFE_COMPONENT_LENGTH:Yt,MAX_SAFE_INTEGER:zt,RELEASE_TYPES:Wt,SEMVER_SPEC_VERSION:Mt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const Zt=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var fe=Zt;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t}=he,n=fe;e=r.exports={};const i=e.re=[],s=e.src=[],a=e.t={};let f=0;const o=(h,l,u)=>{const g=f++;n(h,g,l),a[h]=g,s[g]=l,i[g]=new RegExp(l,u?"g":void 0)};o("NUMERICIDENTIFIER","0|[1-9]\\d*"),o("NUMERICIDENTIFIERLOOSE","[0-9]+"),o("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),o("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),o("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),o("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),o("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),o("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),o("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),o("BUILDIDENTIFIER","[0-9A-Za-z-]+"),o("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),o("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),o("FULL",`^${s[a.FULLPLAIN]}$`),o("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),o("LOOSE",`^${s[a.LOOSEPLAIN]}$`),o("GTLT","((?:<|>)?=?)"),o("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),o("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),o("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),o("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),o("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),o("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),o("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),o("COERCERTL",s[a.COERCE],!0),o("LONETILDE","(?:~>?)"),o("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",o("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),o("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),o("LONECARET","(?:\\^)"),o("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",o("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),o("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),o("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),o("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),o("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",o("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),o("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),o("STAR","(<|>)?=?\\s*\\*"),o("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),o("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Te,Te.exports);var ne=Te.exports;const Kt=Object.freeze({loose:!0}),Jt=Object.freeze({}),Qt=r=>r?typeof r!="object"?Kt:r:Jt;var be=Qt;const je=/^[0-9]+$/,mt=(r,e)=>{const t=je.test(r),n=je.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},kt=(r,e)=>mt(e,r);var $t={compareIdentifiers:mt,rcompareIdentifiers:kt};const se=fe,{MAX_LENGTH:Xe,MAX_SAFE_INTEGER:ie}=he,{re:Ve,t:Be}=ne,er=be,{compareIdentifiers:W}=$t;let tr=class C{constructor(e,t){if(t=er(t),e instanceof C){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Xe)throw new TypeError(`version is longer than ${Xe} characters`);se("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?Ve[Be.LOOSE]:Ve[Be.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ie||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ie||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ie||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<ie)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(se("SemVer.compare",this.version,this.options,e),!(e instanceof C)){if(typeof e=="string"&&e===this.version)return 0;e=new C(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof C||(e=new C(e,this.options)),W(this.major,e.major)||W(this.minor,e.minor)||W(this.patch,e.patch)}comparePre(e){if(e instanceof C||(e=new C(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(se("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return W(n,i)}while(++t)}compareBuild(e){e instanceof C||(e=new C(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(se("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return W(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),W(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};var b=tr;const qe=b,rr=(r,e,t=!1)=>{if(r instanceof qe)return r;try{return new qe(r,e)}catch(n){if(!t)return null;throw n}};var J=rr;const nr=J,sr=(r,e)=>{const t=nr(r,e);return t?t.version:null};var ir=sr;const ar=J,or=(r,e)=>{const t=ar(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var lr=or;const Me=b,cr=(r,e,t,n,i)=>{typeof t=="string"&&(i=n,n=t,t=void 0);try{return new Me(r instanceof Me?r.version:r,t).inc(e,n,i).version}catch{return null}};var ur=cr;const He=J,hr=(r,e)=>{const t=He(r,null,!0),n=He(e,null,!0),i=t.compare(n);if(i===0)return null;const s=i>0,a=s?t:n,f=s?n:t,o=!!a.prerelease.length,h=o?"pre":"";return t.major!==n.major?h+"major":t.minor!==n.minor?h+"minor":t.patch!==n.patch?h+"patch":o?"prerelease":f.patch?"patch":f.minor?"minor":"major"};var fr=hr;const pr=b,vr=(r,e)=>new pr(r,e).major;var Er=vr;const dr=b,mr=(r,e)=>new dr(r,e).minor;var $r=mr;const gr=b,Ir=(r,e)=>new gr(r,e).patch;var Rr=Ir;const Sr=J,yr=(r,e)=>{const t=Sr(r,e);return t&&t.prerelease.length?t.prerelease:null};var Nr=yr;const ze=b,Lr=(r,e,t)=>new ze(r,t).compare(new ze(e,t));var P=Lr;const Tr=P,Or=(r,e,t)=>Tr(e,r,t);var wr=Or;const Ar=P,br=(r,e)=>Ar(r,e,!0);var xr=br;const Ye=b,_r=(r,e,t)=>{const n=new Ye(r,t),i=new Ye(e,t);return n.compare(i)||n.compareBuild(i)};var xe=_r;const Pr=xe,Dr=(r,e)=>r.sort((t,n)=>Pr(t,n,e));var Cr=Dr;const Gr=xe,Ur=(r,e)=>r.sort((t,n)=>Gr(n,t,e));var Fr=Ur;const jr=P,Xr=(r,e,t)=>jr(r,e,t)>0;var pe=Xr;const Vr=P,Br=(r,e,t)=>Vr(r,e,t)<0;var _e=Br;const qr=P,Mr=(r,e,t)=>qr(r,e,t)===0;var gt=Mr;const Hr=P,zr=(r,e,t)=>Hr(r,e,t)!==0;var It=zr;const Yr=P,Wr=(r,e,t)=>Yr(r,e,t)>=0;var Pe=Wr;const Zr=P,Kr=(r,e,t)=>Zr(r,e,t)<=0;var De=Kr;const Jr=gt,Qr=It,kr=pe,en=Pe,tn=_e,rn=De,nn=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Jr(r,t,n);case"!=":return Qr(r,t,n);case">":return kr(r,t,n);case">=":return en(r,t,n);case"<":return tn(r,t,n);case"<=":return rn(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var Rt=nn;const sn=b,an=J,{re:ae,t:oe}=ne,on=(r,e)=>{if(r instanceof sn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(ae[oe.COERCE]);else{let n;for(;(n=ae[oe.COERCERTL].exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),ae[oe.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;ae[oe.COERCERTL].lastIndex=-1}return t===null?null:an(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};var ln=on,de,We;function cn(){return We||(We=1,de=function(r){r.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),de}var un=S;S.Node=Y;S.create=S;function S(r){var e=this;if(e instanceof S||(e=new S),e.tail=null,e.head=null,e.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)e.push(arguments[t]);return e}S.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var e=r.next,t=r.prev;return e&&(e.prev=t),t&&(t.next=e),r===this.head&&(this.head=e),r===this.tail&&(this.tail=t),r.list.length--,r.next=null,r.prev=null,r.list=null,e};S.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var e=this.head;r.list=this,r.next=e,e&&(e.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};S.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var e=this.tail;r.list=this,r.prev=e,e&&(e.next=r),this.tail=r,this.head||(this.head=r),this.length++}};S.prototype.push=function(){for(var r=0,e=arguments.length;r<e;r++)fn(this,arguments[r]);return this.length};S.prototype.unshift=function(){for(var r=0,e=arguments.length;r<e;r++)pn(this,arguments[r]);return this.length};S.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};S.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};S.prototype.forEach=function(r,e){e=e||this;for(var t=this.head,n=0;t!==null;n++)r.call(e,t.value,n,this),t=t.next};S.prototype.forEachReverse=function(r,e){e=e||this;for(var t=this.tail,n=this.length-1;t!==null;n--)r.call(e,t.value,n,this),t=t.prev};S.prototype.get=function(r){for(var e=0,t=this.head;t!==null&&e<r;e++)t=t.next;if(e===r&&t!==null)return t.value};S.prototype.getReverse=function(r){for(var e=0,t=this.tail;t!==null&&e<r;e++)t=t.prev;if(e===r&&t!==null)return t.value};S.prototype.map=function(r,e){e=e||this;for(var t=new S,n=this.head;n!==null;)t.push(r.call(e,n.value,this)),n=n.next;return t};S.prototype.mapReverse=function(r,e){e=e||this;for(var t=new S,n=this.tail;n!==null;)t.push(r.call(e,n.value,this)),n=n.prev;return t};S.prototype.reduce=function(r,e){var t,n=this.head;if(arguments.length>1)t=e;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)t=r(t,n.value,i),n=n.next;return t};S.prototype.reduceReverse=function(r,e){var t,n=this.tail;if(arguments.length>1)t=e;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)t=r(t,n.value,i),n=n.prev;return t};S.prototype.toArray=function(){for(var r=new Array(this.length),e=0,t=this.head;t!==null;e++)r[e]=t.value,t=t.next;return r};S.prototype.toArrayReverse=function(){for(var r=new Array(this.length),e=0,t=this.tail;t!==null;e++)r[e]=t.value,t=t.prev;return r};S.prototype.slice=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new S;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<e;n++,i=i.next)t.push(i.value);return t};S.prototype.sliceReverse=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new S;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=this.length,i=this.tail;i!==null&&n>e;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)t.push(i.value);return t};S.prototype.splice=function(r,e,...t){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var s=[],n=0;i&&n<e;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<t.length;n++)i=hn(this,i,t[n]);return s};S.prototype.reverse=function(){for(var r=this.head,e=this.tail,t=r;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=e,this.tail=r,this};function hn(r,e,t){var n=e===r.head?new Y(t,null,e,r):new Y(t,e,e.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function fn(r,e){r.tail=new Y(e,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function pn(r,e){r.head=new Y(e,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Y(r,e,t,n){if(!(this instanceof Y))return new Y(r,e,t,n);this.list=n,this.value=r,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{cn()(S)}catch{}const vn=un,H=Symbol("max"),F=Symbol("length"),Z=Symbol("lengthCalculator"),re=Symbol("allowStale"),z=Symbol("maxAge"),U=Symbol("dispose"),Ze=Symbol("noDisposeOnSet"),T=Symbol("lruList"),_=Symbol("cache"),St=Symbol("updateAgeOnGet"),me=()=>1;class En{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[H]=e.max||1/0;const t=e.length||me;if(this[Z]=typeof t!="function"?me:t,this[re]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[z]=e.maxAge||0,this[U]=e.dispose,this[Ze]=e.noDisposeOnSet||!1,this[St]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[H]=e||1/0,ee(this)}get max(){return this[H]}set allowStale(e){this[re]=!!e}get allowStale(){return this[re]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[z]=e,ee(this)}get maxAge(){return this[z]}set lengthCalculator(e){typeof e!="function"&&(e=me),e!==this[Z]&&(this[Z]=e,this[F]=0,this[T].forEach(t=>{t.length=this[Z](t.value,t.key),this[F]+=t.length})),ee(this)}get lengthCalculator(){return this[Z]}get length(){return this[F]}get itemCount(){return this[T].length}rforEach(e,t){t=t||this;for(let n=this[T].tail;n!==null;){const i=n.prev;Ke(this,e,n,t),n=i}}forEach(e,t){t=t||this;for(let n=this[T].head;n!==null;){const i=n.next;Ke(this,e,n,t),n=i}}keys(){return this[T].toArray().map(e=>e.key)}values(){return this[T].toArray().map(e=>e.value)}reset(){this[U]&&this[T]&&this[T].length&&this[T].forEach(e=>this[U](e.key,e.value)),this[_]=new Map,this[T]=new vn,this[F]=0}dump(){return this[T].map(e=>ce(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[T]}set(e,t,n){if(n=n||this[z],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,s=this[Z](t,e);if(this[_].has(e)){if(s>this[H])return K(this,this[_].get(e)),!1;const o=this[_].get(e).value;return this[U]&&(this[Ze]||this[U](e,o.value)),o.now=i,o.maxAge=n,o.value=t,this[F]+=s-o.length,o.length=s,this.get(e),ee(this),!0}const a=new dn(e,t,s,i,n);return a.length>this[H]?(this[U]&&this[U](e,t),!1):(this[F]+=a.length,this[T].unshift(a),this[_].set(e,this[T].head),ee(this),!0)}has(e){if(!this[_].has(e))return!1;const t=this[_].get(e).value;return!ce(this,t)}get(e){return $e(this,e,!0)}peek(e){return $e(this,e,!1)}pop(){const e=this[T].tail;return e?(K(this,e),e.value):null}del(e){K(this,this[_].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const i=e[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-t;a>0&&this.set(i.k,i.v,a)}}}prune(){this[_].forEach((e,t)=>$e(this,t,!1))}}const $e=(r,e,t)=>{const n=r[_].get(e);if(n){const i=n.value;if(ce(r,i)){if(K(r,n),!r[re])return}else t&&(r[St]&&(n.value.now=Date.now()),r[T].unshiftNode(n));return i.value}},ce=(r,e)=>{if(!e||!e.maxAge&&!r[z])return!1;const t=Date.now()-e.now;return e.maxAge?t>e.maxAge:r[z]&&t>r[z]},ee=r=>{if(r[F]>r[H])for(let e=r[T].tail;r[F]>r[H]&&e!==null;){const t=e.prev;K(r,e),e=t}},K=(r,e)=>{if(e){const t=e.value;r[U]&&r[U](t.key,t.value),r[F]-=t.length,r[_].delete(t.key),r[T].removeNode(e)}};class dn{constructor(e,t,n,i,s){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=s||0}}const Ke=(r,e,t,n)=>{let i=t.value;ce(r,i)&&(K(r,t),r[re]||(i=void 0)),i&&e.call(n,i.value,i.key,r)};var mn=En,ge,Je;function D(){if(Je)return ge;Je=1;class r{constructor(c,$){if($=n($),c instanceof r)return c.loose===!!$.loose&&c.includePrerelease===!!$.includePrerelease?c:new r(c.raw,$);if(c instanceof i)return this.raw=c.value,this.set=[[c]],this.format(),this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=c,this.set=c.split("||").map(d=>this.parseRange(d.trim())).filter(d=>d.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${c}`);if(this.set.length>1){const d=this.set[0];if(this.set=this.set.filter(m=>!w(m[0])),this.set.length===0)this.set=[d];else if(this.set.length>1){for(const m of this.set)if(m.length===1&&B(m[0])){this.set=[m];break}}}this.format()}format(){return this.range=this.set.map(c=>c.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(c){c=c.trim();const d=((this.options.includePrerelease&&g)|(this.options.loose&&p))+":"+c,m=t.get(d);if(m)return m;const E=this.options.loose,I=E?f[o.HYPHENRANGELOOSE]:f[o.HYPHENRANGE];c=c.replace(I,Dt(this.options.includePrerelease)),s("hyphen replace",c),c=c.replace(f[o.COMPARATORTRIM],h),s("comparator trim",c),c=c.replace(f[o.TILDETRIM],l),c=c.replace(f[o.CARETTRIM],u),c=c.split(/\s+/).join(" ");let y=c.split(" ").map(L=>q(L,this.options)).join(" ").split(/\s+/).map(L=>Pt(L,this.options));E&&(y=y.filter(L=>(s("loose invalid filter",L,this.options),!!L.match(f[o.COMPARATORLOOSE])))),s("range list",y);const R=new Map,N=y.map(L=>new i(L,this.options));for(const L of N){if(w(L))return[L];R.set(L.value,L)}R.size>1&&R.has("")&&R.delete("");const x=[...R.values()];return t.set(d,x),x}intersects(c,$){if(!(c instanceof r))throw new TypeError("a Range is required");return this.set.some(d=>Q(d,$)&&c.set.some(m=>Q(m,$)&&d.every(E=>m.every(I=>E.intersects(I,$)))))}test(c){if(!c)return!1;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}for(let $=0;$<this.set.length;$++)if(Ct(this.set[$],c,this.options))return!0;return!1}}ge=r;const e=mn,t=new e({max:1e3}),n=be,i=ve(),s=fe,a=b,{re:f,t:o,comparatorTrimReplace:h,tildeTrimReplace:l,caretTrimReplace:u}=ne,{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:p}=he,w=v=>v.value==="<0.0.0-0",B=v=>v.value==="",Q=(v,c)=>{let $=!0;const d=v.slice();let m=d.pop();for(;$&&d.length;)$=d.every(E=>m.intersects(E,c)),m=d.pop();return $},q=(v,c)=>(s("comp",v,c),v=wt(v,c),s("caret",v),v=Tt(v,c),s("tildes",v),v=bt(v,c),s("xrange",v),v=_t(v,c),s("stars",v),v),A=v=>!v||v.toLowerCase()==="x"||v==="*",Tt=(v,c)=>v.trim().split(/\s+/).map($=>Ot($,c)).join(" "),Ot=(v,c)=>{const $=c.loose?f[o.TILDELOOSE]:f[o.TILDE];return v.replace($,(d,m,E,I,y)=>{s("tilde",v,d,m,E,I,y);let R;return A(m)?R="":A(E)?R=`>=${m}.0.0 <${+m+1}.0.0-0`:A(I)?R=`>=${m}.${E}.0 <${m}.${+E+1}.0-0`:y?(s("replaceTilde pr",y),R=`>=${m}.${E}.${I}-${y} <${m}.${+E+1}.0-0`):R=`>=${m}.${E}.${I} <${m}.${+E+1}.0-0`,s("tilde return",R),R})},wt=(v,c)=>v.trim().split(/\s+/).map($=>At($,c)).join(" "),At=(v,c)=>{s("caret",v,c);const $=c.loose?f[o.CARETLOOSE]:f[o.CARET],d=c.includePrerelease?"-0":"";return v.replace($,(m,E,I,y,R)=>{s("caret",v,m,E,I,y,R);let N;return A(E)?N="":A(I)?N=`>=${E}.0.0${d} <${+E+1}.0.0-0`:A(y)?E==="0"?N=`>=${E}.${I}.0${d} <${E}.${+I+1}.0-0`:N=`>=${E}.${I}.0${d} <${+E+1}.0.0-0`:R?(s("replaceCaret pr",R),E==="0"?I==="0"?N=`>=${E}.${I}.${y}-${R} <${E}.${I}.${+y+1}-0`:N=`>=${E}.${I}.${y}-${R} <${E}.${+I+1}.0-0`:N=`>=${E}.${I}.${y}-${R} <${+E+1}.0.0-0`):(s("no pr"),E==="0"?I==="0"?N=`>=${E}.${I}.${y}${d} <${E}.${I}.${+y+1}-0`:N=`>=${E}.${I}.${y}${d} <${E}.${+I+1}.0-0`:N=`>=${E}.${I}.${y} <${+E+1}.0.0-0`),s("caret return",N),N})},bt=(v,c)=>(s("replaceXRanges",v,c),v.split(/\s+/).map($=>xt($,c)).join(" ")),xt=(v,c)=>{v=v.trim();const $=c.loose?f[o.XRANGELOOSE]:f[o.XRANGE];return v.replace($,(d,m,E,I,y,R)=>{s("xRange",v,d,m,E,I,y,R);const N=A(E),x=N||A(I),L=x||A(y),k=L;return m==="="&&k&&(m=""),R=c.includePrerelease?"-0":"",N?m===">"||m==="<"?d="<0.0.0-0":d="*":m&&k?(x&&(I=0),y=0,m===">"?(m=">=",x?(E=+E+1,I=0,y=0):(I=+I+1,y=0)):m==="<="&&(m="<",x?E=+E+1:I=+I+1),m==="<"&&(R="-0"),d=`${m+E}.${I}.${y}${R}`):x?d=`>=${E}.0.0${R} <${+E+1}.0.0-0`:L&&(d=`>=${E}.${I}.0${R} <${E}.${+I+1}.0-0`),s("xRange return",d),d})},_t=(v,c)=>(s("replaceStars",v,c),v.trim().replace(f[o.STAR],"")),Pt=(v,c)=>(s("replaceGTE0",v,c),v.trim().replace(f[c.includePrerelease?o.GTE0PRE:o.GTE0],"")),Dt=v=>(c,$,d,m,E,I,y,R,N,x,L,k,ei)=>(A(d)?$="":A(m)?$=`>=${d}.0.0${v?"-0":""}`:A(E)?$=`>=${d}.${m}.0${v?"-0":""}`:I?$=`>=${$}`:$=`>=${$}${v?"-0":""}`,A(N)?R="":A(x)?R=`<${+N+1}.0.0-0`:A(L)?R=`<${N}.${+x+1}.0-0`:k?R=`<=${N}.${x}.${L}-${k}`:v?R=`<${N}.${x}.${+L+1}-0`:R=`<=${R}`,`${$} ${R}`.trim()),Ct=(v,c,$)=>{for(let d=0;d<v.length;d++)if(!v[d].test(c))return!1;if(c.prerelease.length&&!$.includePrerelease){for(let d=0;d<v.length;d++)if(s(v[d].semver),v[d].semver!==i.ANY&&v[d].semver.prerelease.length>0){const m=v[d].semver;if(m.major===c.major&&m.minor===c.minor&&m.patch===c.patch)return!0}return!1}return!0};return ge}var Ie,Qe;function ve(){if(Qe)return Ie;Qe=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(l,u){if(u=t(u),l instanceof e){if(l.loose===!!u.loose)return l;l=l.value}a("comparator",l,u),this.options=u,this.loose=!!u.loose,this.parse(l),this.semver===r?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(l){const u=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],g=l.match(u);if(!g)throw new TypeError(`Invalid comparator: ${l}`);this.operator=g[1]!==void 0?g[1]:"",this.operator==="="&&(this.operator=""),g[2]?this.semver=new f(g[2],this.options.loose):this.semver=r}toString(){return this.value}test(l){if(a("Comparator.test",l,this.options.loose),this.semver===r||l===r)return!0;if(typeof l=="string")try{l=new f(l,this.options)}catch{return!1}return s(l,this.operator,this.semver,this.options)}intersects(l,u){if(!(l instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new o(l.value,u).test(this.value):l.operator===""?l.value===""?!0:new o(this.value,u).test(l.semver):(u=t(u),u.includePrerelease&&(this.value==="<0.0.0-0"||l.value==="<0.0.0-0")||!u.includePrerelease&&(this.value.startsWith("<0.0.0")||l.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&l.operator.startsWith(">")||this.operator.startsWith("<")&&l.operator.startsWith("<")||this.semver.version===l.semver.version&&this.operator.includes("=")&&l.operator.includes("=")||s(this.semver,"<",l.semver,u)&&this.operator.startsWith(">")&&l.operator.startsWith("<")||s(this.semver,">",l.semver,u)&&this.operator.startsWith("<")&&l.operator.startsWith(">")))}}Ie=e;const t=be,{re:n,t:i}=ne,s=Rt,a=fe,f=b,o=D();return Ie}const $n=D(),gn=(r,e,t)=>{try{e=new $n(e,t)}catch{return!1}return e.test(r)};var Ee=gn;const In=D(),Rn=(r,e)=>new In(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var Sn=Rn;const yn=b,Nn=D(),Ln=(r,e,t)=>{let n=null,i=null,s=null;try{s=new Nn(e,t)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new yn(n,t))}),n};var Tn=Ln;const On=b,wn=D(),An=(r,e,t)=>{let n=null,i=null,s=null;try{s=new wn(e,t)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new On(n,t))}),n};var bn=An;const Re=b,xn=D(),ke=pe,_n=(r,e)=>{r=new xn(r,e);let t=new Re("0.0.0");if(r.test(t)||(t=new Re("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){const i=r.set[n];let s=null;i.forEach(a=>{const f=new Re(a.semver.version);switch(a.operator){case">":f.prerelease.length===0?f.patch++:f.prerelease.push(0),f.raw=f.format();case"":case">=":(!s||ke(f,s))&&(s=f);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!t||ke(t,s))&&(t=s)}return t&&r.test(t)?t:null};var Pn=_n;const Dn=D(),Cn=(r,e)=>{try{return new Dn(r,e).range||"*"}catch{return null}};var Gn=Cn;const Un=b,yt=ve(),{ANY:Fn}=yt,jn=D(),Xn=Ee,et=pe,tt=_e,Vn=De,Bn=Pe,qn=(r,e,t,n)=>{r=new Un(r,n),e=new jn(e,n);let i,s,a,f,o;switch(t){case">":i=et,s=Vn,a=tt,f=">",o=">=";break;case"<":i=tt,s=Bn,a=et,f="<",o="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Xn(r,e,n))return!1;for(let h=0;h<e.set.length;++h){const l=e.set[h];let u=null,g=null;if(l.forEach(p=>{p.semver===Fn&&(p=new yt(">=0.0.0")),u=u||p,g=g||p,i(p.semver,u.semver,n)?u=p:a(p.semver,g.semver,n)&&(g=p)}),u.operator===f||u.operator===o||(!g.operator||g.operator===f)&&s(r,g.semver))return!1;if(g.operator===o&&a(r,g.semver))return!1}return!0};var Ce=qn;const Mn=Ce,Hn=(r,e,t)=>Mn(r,e,">",t);var zn=Hn;const Yn=Ce,Wn=(r,e,t)=>Yn(r,e,"<",t);var Zn=Wn;const rt=D(),Kn=(r,e,t)=>(r=new rt(r,t),e=new rt(e,t),r.intersects(e,t));var Jn=Kn;const Qn=Ee,kn=P;var es=(r,e,t)=>{const n=[];let i=null,s=null;const a=r.sort((l,u)=>kn(l,u,t));for(const l of a)Qn(l,e,t)?(s=l,i||(i=l)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);const f=[];for(const[l,u]of n)l===u?f.push(l):!u&&l===a[0]?f.push("*"):u?l===a[0]?f.push(`<=${u}`):f.push(`${l} - ${u}`):f.push(`>=${l}`);const o=f.join(" || "),h=typeof e.raw=="string"?e.raw:String(e);return o.length<h.length?o:e};const nt=D(),Ge=ve(),{ANY:Se}=Ge,te=Ee,Ue=P,ts=(r,e,t={})=>{if(r===e)return!0;r=new nt(r,t),e=new nt(e,t);let n=!1;e:for(const i of r.set){for(const s of e.set){const a=ns(i,s,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},rs=[new Ge(">=0.0.0-0")],st=[new Ge(">=0.0.0")],ns=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===Se){if(e.length===1&&e[0].semver===Se)return!0;t.includePrerelease?r=rs:r=st}if(e.length===1&&e[0].semver===Se){if(t.includePrerelease)return!0;e=st}const n=new Set;let i,s;for(const p of r)p.operator===">"||p.operator===">="?i=it(i,p,t):p.operator==="<"||p.operator==="<="?s=at(s,p,t):n.add(p.semver);if(n.size>1)return null;let a;if(i&&s){if(a=Ue(i.semver,s.semver,t),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const p of n){if(i&&!te(p,String(i),t)||s&&!te(p,String(s),t))return null;for(const w of e)if(!te(p,String(w),t))return!1;return!0}let f,o,h,l,u=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,g=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;u&&u.prerelease.length===1&&s.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(const p of e){if(l=l||p.operator===">"||p.operator===">=",h=h||p.operator==="<"||p.operator==="<=",i){if(g&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===g.major&&p.semver.minor===g.minor&&p.semver.patch===g.patch&&(g=!1),p.operator===">"||p.operator===">="){if(f=it(i,p,t),f===p&&f!==i)return!1}else if(i.operator===">="&&!te(i.semver,String(p),t))return!1}if(s){if(u&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===u.major&&p.semver.minor===u.minor&&p.semver.patch===u.patch&&(u=!1),p.operator==="<"||p.operator==="<="){if(o=at(s,p,t),o===p&&o!==s)return!1}else if(s.operator==="<="&&!te(s.semver,String(p),t))return!1}if(!p.operator&&(s||i)&&a!==0)return!1}return!(i&&h&&!s&&a!==0||s&&l&&!i&&a!==0||g||u)},it=(r,e,t)=>{if(!r)return e;const n=Ue(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},at=(r,e,t)=>{if(!r)return e;const n=Ue(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};var ss=ts;const ye=ne,ot=he,is=b,lt=$t,as=J,os=ir,ls=lr,cs=ur,us=fr,hs=Er,fs=$r,ps=Rr,vs=Nr,Es=P,ds=wr,ms=xr,$s=xe,gs=Cr,Is=Fr,Rs=pe,Ss=_e,ys=gt,Ns=It,Ls=Pe,Ts=De,Os=Rt,ws=ln,As=ve(),bs=D(),xs=Ee,_s=Sn,Ps=Tn,Ds=bn,Cs=Pn,Gs=Gn,Us=Ce,Fs=zn,js=Zn,Xs=Jn,Vs=es,Bs=ss;var qs={parse:as,valid:os,clean:ls,inc:cs,diff:us,major:hs,minor:fs,patch:ps,prerelease:vs,compare:Es,rcompare:ds,compareLoose:ms,compareBuild:$s,sort:gs,rsort:Is,gt:Rs,lt:Ss,eq:ys,neq:Ns,gte:Ls,lte:Ts,cmp:Os,coerce:ws,Comparator:As,Range:bs,satisfies:xs,toComparators:_s,maxSatisfying:Ps,minSatisfying:Ds,minVersion:Cs,validRange:Gs,outside:Us,gtr:Fs,ltr:js,intersects:Xs,simplifyRange:Vs,subset:Bs,SemVer:is,re:ye.re,src:ye.src,tokens:ye.t,SEMVER_SPEC_VERSION:ot.SEMVER_SPEC_VERSION,RELEASE_TYPES:ot.RELEASE_TYPES,compareIdentifiers:lt.compareIdentifiers,rcompareIdentifiers:lt.rcompareIdentifiers};const ct=Et(qs);var Oe=globalThis&&globalThis.__assign||function(){return Oe=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Oe.apply(this,arguments)},M,O;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.nanoFTS="nanoFTS"})(O||(O={}));var we=(M={},M[O.blue]={id:O.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(r){return 4*1024}},M[O.nanoS]={id:O.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(r){var e;return ct.lt((e=ct.coerce(r))!==null&&e!==void 0?e:"","2.0.0")?4*1024:2*1024}},M[O.nanoSP]={id:O.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(r){return 32}},M[O.nanoX]={id:O.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},M[O.nanoFTS]={id:O.nanoFTS,productName:"Ledger Nano FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:2*1024*1024,masks:[857735168],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},M);O.blue,O.nanoS,O.nanoSP,O.nanoX,O.nanoFTS;var ut=Object.values(we),Nt=11415,ht=function(r){var e=ut.find(function(i){return i.legacyUsbProductId===r});if(e)return e;var t=r>>8,n=ut.find(function(i){return i.productIdMM===t});return n},Ms=[],ft={};for(var Hs in we){var pt=we[Hs],Ne=pt.bluetoothSpec;if(Ne)for(var Le=0;Le<Ne.length;Le++){var le=Ne[Le];Ms.push(le.serviceUuid),ft[le.serviceUuid]=ft[le.serviceUuid.replace(/-/g,"")]=Oe({deviceModel:pt},le)}}var zs=0,V=[],vt=function(r,e,t){var n={type:r,id:String(++zs),date:new Date};e&&(n.message=e),t&&(n.data=t),Ws(n)},Ys=function(r){return V.push(r),function(){var e=V.indexOf(r);e!==-1&&(V[e]=V[V.length-1],V.pop())}};function Ws(r){for(var e=0;e<V.length;e++)try{V[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=Ys);var Zs=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),j=globalThis&&globalThis.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function f(l){try{h(n.next(l))}catch(u){a(u)}}function o(l){try{h(n.throw(l))}catch(u){a(u)}}function h(l){l.done?s(l.value):i(l.value).then(f,o)}h((n=n.apply(r,e||[])).next())})},X=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function f(h){return function(l){return o([h,l])}}function o(h){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){t.label=h[1];break}if(h[0]===6&&t.label<s[1]){t.label=s[1],s=h;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(h);break}s[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Ks=globalThis&&globalThis.__read||function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(f){a={error:f}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s},Js=[{vendorId:Nt}],Qs=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},ue=function(){var r=navigator.hid;if(!r)throw new Xt("navigator.hid is not supported","HIDNotSupported");return r};function Lt(){return j(this,void 0,void 0,function(){var r;return X(this,function(e){switch(e.label){case 0:return[4,ue().requestDevice({filters:Js})];case 1:return r=e.sent(),Array.isArray(r)?[2,r]:[2,[r]]}})})}function Ae(){return j(this,void 0,void 0,function(){var r;return X(this,function(e){switch(e.label){case 0:return[4,ue().getDevices()];case 1:return r=e.sent(),[2,r.filter(function(t){return t.vendorId===Nt})]}})})}function ks(){return j(this,void 0,void 0,function(){var r,e;return X(this,function(t){switch(t.label){case 0:return[4,Ae()];case 1:return r=t.sent(),r.length>0?[2,r[0]]:[4,Lt()];case 2:return e=t.sent(),[2,e[0]]}})})}var ri=function(r){Zs(e,r);function e(t){var n=r.call(this)||this;return n.channel=Math.floor(Math.random()*65535),n.packetSize=64,n.inputs=[],n.read=function(){return n.inputs.length?Promise.resolve(n.inputs.shift()):new Promise(function(i){n.inputCallback=i})},n.onInputReport=function(i){var s=G.Buffer.from(i.data.buffer);n.inputCallback?(n.inputCallback(s),n.inputCallback=null):n.inputs.push(s)},n._disconnectEmitted=!1,n._emitDisconnect=function(i){n._disconnectEmitted||(n._disconnectEmitted=!0,n.emit("disconnect",i))},n.exchange=function(i){return j(n,void 0,void 0,function(){var s,a=this;return X(this,function(f){switch(f.label){case 0:return[4,this.exchangeAtomicImpl(function(){return j(a,void 0,void 0,function(){var o,h,l,u,g,p,w,B,Q;return X(this,function(q){switch(q.label){case 0:o=this,h=o.channel,l=o.packetSize,vt("apdu","=> "+i.toString("hex")),u=qt(h,l),g=u.makeBlocks(i),p=0,q.label=1;case 1:return p<g.length?[4,this.device.sendReport(0,g[p])]:[3,4];case 2:q.sent(),q.label=3;case 3:return p++,[3,1];case 4:return(w=u.getReducedResult(B))?[3,6]:[4,this.read()];case 5:return Q=q.sent(),B=u.reduceResponse(B,Q),[3,4];case 6:return vt("apdu","<= "+w.toString("hex")),[2,w]}})})}).catch(function(o){throw o&&o.message&&o.message.includes("write")?(a._emitDisconnect(o),new Ft(o.message)):o})];case 1:return s=f.sent(),[2,s]}})})},n.device=t,n.deviceModel=typeof t.productId=="number"?ht(t.productId):void 0,t.addEventListener("inputreport",n.onInputReport),n}return e.request=function(){return j(this,void 0,void 0,function(){var t,n;return X(this,function(i){switch(i.label){case 0:return[4,Lt()];case 1:return t=Ks.apply(void 0,[i.sent(),1]),n=t[0],[2,e.open(n)]}})})},e.openConnected=function(){return j(this,void 0,void 0,function(){var t;return X(this,function(n){switch(n.label){case 0:return[4,Ae()];case 1:return t=n.sent(),t.length===0?[2,null]:[2,e.open(t[0])]}})})},e.open=function(t){return j(this,void 0,void 0,function(){var n,i;return X(this,function(s){switch(s.label){case 0:return[4,t.open()];case 1:return s.sent(),n=new e(t),i=function(a){t===a.device&&(ue().removeEventListener("disconnect",i),n._emitDisconnect(new Vt))},ue().addEventListener("disconnect",i),[2,n]}})})},e.prototype.close=function(){return j(this,void 0,void 0,function(){return X(this,function(t){switch(t.label){case 0:return[4,this.exchangeBusyPromise];case 1:return t.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return t.sent(),[2]}})})},e.prototype.setScrambleKey=function(){},e.isSupported=Qs,e.list=Ae,e.listen=function(t){var n=!1;ks().then(function(s){if(!s)t.error(new Fe("Access denied to use Ledger device"));else if(!n){var a=typeof s.productId=="number"?ht(s.productId):void 0;t.next({type:"add",descriptor:s,deviceModel:a}),t.complete()}},function(s){t.error(new Fe(s.message))});function i(){n=!0}return{unsubscribe:i}},e}(jt);export{ri as default};
