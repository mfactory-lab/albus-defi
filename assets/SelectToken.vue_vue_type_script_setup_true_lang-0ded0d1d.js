import{L as Ne,al as Qe,am as je,q as E,U as ne,an as We,P as z,ao as Oe,a0 as W,a6 as fe,Y as Pe,a4 as Ve,a9 as P,ap as $e,aq as he,ar as Ze,ac as Je,as as Z,ai as Ke,at as ye,au as J,ae as pe,av as Ie,aw as He,ax as Ye,ay as Xe,az as Ge,aA as qe,aB as De,aC as et,u as ve,t as tt,a5 as nt,v as ue,aD as we,aE as be,aF as at,aG as ot,J as st,aH as it,ad as lt,aa as Te,m as Ue,aI as Se,o as ee,aJ as ce,w as N,j as O,x as _e,aK as rt,aL as oe,H as se,A as q,aM as Le,i as me,B as ie,y as ge,z as ae,aN as Ae,Q as ut,aO as ke,ah as ct,aP as le,aQ as te,aR as dt,aS as ft,O as vt,aT as mt,aU as gt,aV as kt,aW as Me,aX as ht,aY as xe,aZ as yt,a_ as pt,a$ as wt,b0 as bt,b1 as Tt,b2 as St,s as Ce,b3 as Ee,b4 as Re,b5 as _t,b6 as de,b7 as At,C as Mt,b8 as xt,b9 as Ct}from"./index-982c17fd.js";function on(e){const n=e.keyCode?e.keyCode:e.which;(n<48||n>57)&&n!==46&&e.preventDefault(),n===46&&String(e.target.value).includes(".")&&e.preventDefault()}const Et=Ne({name:"QCardActions",props:{...Qe,vertical:Boolean},setup(e,{slots:n}){const l=je(e),d=E(()=>`q-card__actions ${l.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>ne("div",{class:d.value},We(n.default))}}),Rt=new z("EjCM3aozA6sFUzQQ7vXg2uTtjRydyuHSWRwvQX16pAS9");var Bt=(e=>(e.TOKEN_A="TOKEN_A",e.TOKEN_B="TOKEN_B",e))(Bt||{});const sn=Oe("swap",()=>{const e=W(),n=fe({loading:!1,slippageDialog:!1,status:void 0,poolBalance:{TOKEN_A:void 0,TOKEN_B:void 0,JPLU:void 0},userBalance:{TOKEN_A:void 0,TOKEN_B:void 0,JPLU:void 0},poolTokenSupply:0,rate:0}),l=Pe(),d=Ve();P(d,async i=>{i?u().then():H()},{immediate:!0}),P(e,async i=>{i&&await x()});async function u(){n.loading=!0;try{e.value=await $e.loadTokenSwap(l.connection,Rt),await c()}catch(i){console.log(i),e.value=void 0}finally{n.loading=!1}console.log("Token SWAP: ",e.value)}async function c(){if(!e.value)return;const i=await he(l.connection,e.value.authority);for(const y of i){const p=S(y.mint);p&&(n.poolBalance[p]=y.amount)}const A=await Ze(l.connection,e.value.poolToken);n.poolTokenSupply=Number(A.supply),n.rate=F()}async function x(){if(!e.value)return;const i=d.value?.publicKey;if(!i){console.log("Wallet is not connected...");return}const A=await he(l.connection,i,[e.value.poolToken,e.value.mintA,e.value.mintB]),y={TOKEN_A:0,TOKEN_B:0};for(const p of A){const R=S(p.mint);R&&(y[R]=+p.amount)}n.userBalance=y,console.log("[Pool Balance]",n.poolBalance),console.log("[User Balance]",n.userBalance)}function F(){return Je(v(Ke))}function S(i){if(e.value)switch(String(i)){case String(e.value.mintA):return"TOKEN_A";case String(e.value.mintB):return"TOKEN_B"}}function v(i){const A=new Z(n.poolBalance.TOKEN_A),y=new Z(i).div(A),p=new Z(1),w=p.add(y).sqrt().sub(p);return new Z(n.poolTokenSupply).mul(w).toNumber()}function h(i,A){const y=new Z(n.poolBalance[A]??0),p=new Z(i).div(y),R=new Z(1),w=R.sub(p);if(w.isNeg())return 0;const D=R.sub(w.sqrt());return new Z(n.poolTokenSupply).mul(D).toNumber()}async function g(i,A){const y=e.value?.mintA,p=e.value?.mintB;if(!y||!p)return;const R=y.toBase58()===i,w=await ye(l.connection,y.toBase58()),D=await ye(l.connection,p.toBase58()),Q=10**(R?D:w),L=10**(R?w:D),I=A*L;return(R?n.userBalance.TOKEN_B/n.userBalance.TOKEN_A*I:n.userBalance.TOKEN_A/n.userBalance.TOKEN_B*I)/Q}function H(){n.loading=!1,n.slippageDialog=!1,n.status=void 0,n.poolBalance={TOKEN_A:void 0,TOKEN_B:void 0,JPLU:void 0},n.userBalance={TOKEN_A:void 0,TOKEN_B:void 0,JPLU:void 0},n.poolTokenSupply=0,n.rate=0}return{state:n,tokenSwap:e,loadUserTokenAccounts:x,depositSingleTokenType:v,withdrawSingleTokenTypeExactOut:h,calculateDependentAmount:g}});var Ft=Object.defineProperty,Nt=(e,n,l)=>n in e?Ft(e,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[n]=l,Ot=(e,n,l)=>(Nt(e,typeof n!="symbol"?n+"":n,l),l);const Pt=new J.BeetArgsStruct([["instructionDiscriminator",J.uniformFixedSizeArray(J.u8,8)],["amount",J.u64]],"SplTransferInstructionArgs"),Vt=[67,186,237,99,235,243,166,198];function Kt(e,n,l=new z("J4pyN7p9dAovEQKoZJV1jUbM3FrCBPLCS2dyiRUnwi5c")){const[d]=Pt.serialize({instructionDiscriminator:Vt,...n}),u=[{pubkey:e.sender,isWritable:!0,isSigner:!0},{pubkey:e.receiver,isWritable:!0,isSigner:!1},{pubkey:e.tokenMint,isWritable:!1,isSigner:!1},{pubkey:e.source,isWritable:!0,isSigner:!1},{pubkey:e.destination,isWritable:!0,isSigner:!1},{pubkey:e.policy,isWritable:!1,isSigner:!1},{pubkey:e.proofRequest,isWritable:!1,isSigner:!1},{pubkey:e.tokenProgram??Ge,isWritable:!1,isSigner:!1},{pubkey:e.systemProgram??qe.programId,isWritable:!1,isSigner:!1}];if(e.anchorRemainingAccounts!=null)for(const c of e.anchorRemainingAccounts)u.push(c);return new De({programId:l,keys:u,data:d})}const It=new J.BeetArgsStruct([["instructionDiscriminator",J.uniformFixedSizeArray(J.u8,8)],["amount",J.u64]],"TransferInstructionArgs"),qt=[163,52,200,231,140,3,69,186];function Dt(e,n,l=new z("J4pyN7p9dAovEQKoZJV1jUbM3FrCBPLCS2dyiRUnwi5c")){const[d]=It.serialize({instructionDiscriminator:qt,...n}),u=[{pubkey:e.sender,isWritable:!0,isSigner:!0},{pubkey:e.receiver,isWritable:!0,isSigner:!1},{pubkey:e.policy,isWritable:!1,isSigner:!1},{pubkey:e.proofRequest,isWritable:!1,isSigner:!1},{pubkey:e.systemProgram??qe.programId,isWritable:!1,isSigner:!1}];if(e.anchorRemainingAccounts!=null)for(const c of e.anchorRemainingAccounts)u.push(c);return new De({programId:l,keys:u,data:d})}const Ut="J4pyN7p9dAovEQKoZJV1jUbM3FrCBPLCS2dyiRUnwi5c",Lt=new z(Ut);class zt{constructor(n){Ot(this,"programId",Lt),this.provider=n}get connection(){return this.provider.connection}async transfer(n,l){const d=this.createTransferTx(n);return this.provider.sendAndConfirm(d,[],l)}createTransferTx(n){const l=Dt({proofRequest:n.proofRequest,policy:n.policy,sender:this.provider.publicKey,receiver:n.receiver},{amount:n.amount});return new pe().add(l)}async getTransferFee(n){const l=this.createTransferTx(n);return this.transactionFee(l)}async transferToken(n,l){const d=await this.createTransferTokenTx(n);return this.provider.sendAndConfirm(d,[],l)}async createTransferTokenTx(n){const l=new pe;try{await Ie(this.connection,n.destination)}catch(d){(d instanceof He||d instanceof Ye)&&l.add(Xe(this.provider.publicKey,n.destination,n.receiver,n.tokenMint))}return l.add(Kt({proofRequest:n.proofRequest,policy:n.policy,sender:this.provider.publicKey,receiver:n.receiver,source:n.source,destination:n.destination,tokenMint:n.tokenMint},{amount:n.amount})),l}async getTransferTokenFee(n){const l=await this.createTransferTokenTx(n);return this.transactionFee(l)}async transactionFee(n){n.recentBlockhash=(await this.connection.getLatestBlockhash("finalized")).blockhash,n.feePayer=this.provider.publicKey;const{value:l}=await this.connection.getFeeForMessage(n.compileMessage(),"confirmed");return Number(l)}}const ln=Oe("transfer",()=>{const e=Pe(),{tokens:n}=et(),l=ve(),{state:d,getUserTokens:u}=ve(),c=E(()=>l.certificate),x=E(()=>l.requiredPolicy),F=E(()=>l.certificateValid),S=0,v=Ve(),{publicKey:h}=tt(),{notify:g}=nt(),H=fe(n[0]),i=fe({address:"",value:void 0,loading:!1,token:H,fee:S,valid:!1});function A(){i.value=void 0,i.fee=S}P(()=>i.token,()=>{A(),l.policySpec=i.token.name}),P(()=>v.value?.publicKey,t=>{t||(A(),i.address="")}),P(()=>i.address,async()=>{i.valid=ue(i.address)});const y=E(()=>{const t=i.token.mint??"";return ue(t)?new z(t):""}),p=E(()=>ue(i.address)?new z(i.address):""),R=W(),w=W(!1);P([y,p,()=>i.valid],async()=>{if(i.token.label==="sol")return w.value=!0;if(y.value&&p.value&&i.valid)try{return R.value=await we(y.value,p.value),await Ie(e.connection,R.value),w.value=!0}catch{w.value=!1}w.value=!1}),P([()=>i.valid,()=>i.value,R],()=>{i.valid&&Number(i.value)>0?Q():i.fee=S});const D=E(()=>new zt(new be(e.connection,v.value??{publicKey:z.default},be.defaultOptions())));async function Q(){const t=await at(v.value?.publicKey,i.address,Number(i.value),e.connection),r=await ot(t,e.connection)+st;return i.fee=w.value?r:r+it}async function L(){try{if(i.loading=!0,console.log("[debug] on transfer certificate === ",c.value),F.value){let t;i.token.label==="sol"?t=await I():t=await K(),g({type:"positive",message:"Transaction confirmed",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${t}?cluster=${e.cluster}`,onClick:()=>!1}]}),A(),await u()}else lt()}catch(t){console.error("verifyTransfer error: ",t),g({type:"negative",message:`${t}`})}finally{i.loading=!1}}async function I(){const t=new Te(Number(i.value)*Ke),r=new z(i.address);return await D.value.transfer({amount:t,receiver:r,proofRequest:c.value.pubkey,policy:new z(x.value)})}async function K(){if(!h.value||!i.token.mint)return;const t=d.tokens.find(f=>f.mint===i.token.mint);if(!t||!y.value||!p.value||!v.value)return;const r=await we(y.value,h.value),o=new Te(Number(i.value)*10**t.decimals);return await D.value.transferToken({destination:R.value,source:r,tokenMint:y.value,amount:o,receiver:p.value,proofRequest:c.value.pubkey,policy:new z(x.value)})}function X(t){i.value=t}function s(t){i.token=t}return{state:i,setMax:X,setToken:s,verifyTransfer:L}}),Qt=ae("div",{class:"text-h6"}," Info ",-1),jt={key:0},Wt={key:1},$t=["href"],Zt=["href"],rn=Ue({__name:"ZkpRequestDialog",setup(e){const n=ve(),l=W(!1),d=E(()=>Se.Empty===n.certificate?.data.status),u=E(()=>Se.Pending===n.certificate?.data.status);return(c,x)=>(ee(),ce(ct,{modelValue:q(l),"onUpdate:modelValue":x[0]||(x[0]=F=>ke(l)?l.value=F:null)},{default:N(()=>[O(ut,{class:"zkp-dialog"},{default:N(()=>[O(_e,{class:"row items-center q-pb-none zkp-dialog__header"},{default:N(()=>[Qt,O(rt),oe(O(se,{icon:q(Le),flat:"",round:"",dense:""},null,8,["icon"]),[[le]])]),_:1}),O(_e,{class:"q-pt-none zkp-dialog__body"},{default:N(()=>[q(d)?(ee(),me("div",jt," To continue, you need to create a ZKP request ")):ie("",!0),q(u)?(ee(),me("div",Wt,[ge(' To continue, you need to "prove" the request. Follow this link. '),ae("a",{class:"prove-link",href:q(Ae),target:"_blank"},"__Albus account__",8,$t)])):ie("",!0)]),_:1}),O(Et,{align:"right",class:"zkp-dialog__actions"},{default:N(()=>[oe(O(se,{flat:"",label:"Cancel",class:"zkp-dialog__actions--cancel"},null,512),[[le]]),q(d)?oe((ee(),ce(se,{key:0,outline:"",label:"Create",color:"yellow"},null,512)),[[le]]):ie("",!0),q(u)?oe((ee(),ce(se,{key:1,color:"yellow",outline:""},{default:N(()=>[ae("a",{href:q(Ae),target:"_blank"},"prove",8,Zt)]),_:1})),[[le]]):ie("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const Be={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},re={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}},ze=Object.keys(re);ze.forEach(e=>{re[e].regex=new RegExp(re[e].pattern)});const Jt=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+ze.join("")+"])|(.)","g"),Fe=/[.*+?^${}()|[\]\\]/g,C=String.fromCharCode(1),Ht={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function Yt(e,n,l,d){let u,c,x,F,S,v;const h=W(null),g=W(i());function H(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}P(()=>e.type+e.autogrow,y),P(()=>e.mask,s=>{if(s!==void 0)p(g.value,!0);else{const t=K(g.value);y(),e.modelValue!==t&&n("update:modelValue",t)}}),P(()=>e.fillMask+e.reverseFillMask,()=>{h.value===!0&&p(g.value,!0)}),P(()=>e.unmaskedValue,()=>{h.value===!0&&p(g.value)});function i(){if(y(),h.value===!0){const s=L(K(e.modelValue));return e.fillMask!==!1?X(s):s}return e.modelValue}function A(s){if(s<u.length)return u.slice(-s);let t="",r=u;const o=r.indexOf(C);if(o>-1){for(let f=s-r.length;f>0;f--)t+=C;r=r.slice(0,o)+t+r.slice(o)}return r}function y(){if(h.value=e.mask!==void 0&&e.mask.length!==0&&H(),h.value===!1){F=void 0,u="",c="";return}const s=Be[e.mask]===void 0?e.mask:Be[e.mask],t=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",r=t.replace(Fe,"\\$&"),o=[],f=[],m=[];let M=e.reverseFillMask===!0,k="",b="";s.replace(Jt,(B,a,_,j,U)=>{if(j!==void 0){const V=re[j];m.push(V),b=V.negate,M===!0&&(f.push("(?:"+b+"+)?("+V.pattern+"+)?(?:"+b+"+)?("+V.pattern+"+)?"),M=!1),f.push("(?:"+b+"+)?("+V.pattern+")?")}else if(_!==void 0)k="\\"+(_==="\\"?"":_),m.push(_),o.push("([^"+k+"]+)?"+k+"?");else{const V=a!==void 0?a:U;k=V==="\\"?"\\\\\\\\":V.replace(Fe,"\\\\$&"),m.push(V),o.push("([^"+k+"]+)?"+k+"?")}});const Y=new RegExp("^"+o.join("")+"("+(k===""?".":"[^"+k+"]")+"+)?"+(k===""?"":"["+k+"]*")+"$"),$=f.length-1,T=f.map((B,a)=>a===0&&e.reverseFillMask===!0?new RegExp("^"+r+"*"+B):a===$?new RegExp("^"+B+"("+(b===""?".":b)+"+)?"+(e.reverseFillMask===!0?"$":r+"*")):new RegExp("^"+B));x=m,F=B=>{const a=Y.exec(e.reverseFillMask===!0?B:B.slice(0,m.length+1));a!==null&&(B=a.slice(1).join(""));const _=[],j=T.length;for(let U=0,V=B;U<j;U++){const G=T[U].exec(V);if(G===null)break;V=V.slice(G.shift().length),_.push(...G)}return _.length!==0?_.join(""):B},u=m.map(B=>typeof B=="string"?B:C).join(""),c=u.split(C).join(t)}function p(s,t,r){const o=d.value,f=o.selectionEnd,m=o.value.length-f,M=K(s);t===!0&&y();const k=L(M),b=e.fillMask!==!1?X(k):k,Y=g.value!==b;o.value!==b&&(o.value=b),Y===!0&&(g.value=b),document.activeElement===o&&te(()=>{if(b===c){const T=e.reverseFillMask===!0?c.length:0;o.setSelectionRange(T,T,"forward");return}if(r==="insertFromPaste"&&e.reverseFillMask!==!0){const T=o.selectionEnd;let B=f-1;for(let a=S;a<=B&&a<T;a++)u[a]!==C&&B++;w.right(o,B);return}if(["deleteContentBackward","deleteContentForward"].indexOf(r)>-1){const T=e.reverseFillMask===!0?f===0?b.length>k.length?1:0:Math.max(0,b.length-(b===c?0:Math.min(k.length,m)+1))+1:f;o.setSelectionRange(T,T,"forward");return}if(e.reverseFillMask===!0)if(Y===!0){const T=Math.max(0,b.length-(b===c?0:Math.min(k.length,m+1)));T===1&&f===1?o.setSelectionRange(T,T,"forward"):w.rightReverse(o,T)}else{const T=b.length-m;o.setSelectionRange(T,T,"backward")}else if(Y===!0){const T=Math.max(0,u.indexOf(C),Math.min(k.length,f)-1);w.right(o,T)}else{const T=f-1;w.right(o,T)}});const $=e.unmaskedValue===!0?K(b):b;String(e.modelValue)!==$&&(e.modelValue!==null||$!=="")&&l($,!0)}function R(s,t,r){const o=L(K(s.value));t=Math.max(0,u.indexOf(C),Math.min(o.length,t)),S=t,s.setSelectionRange(t,r,"forward")}const w={left(s,t){const r=u.slice(t-1).indexOf(C)===-1;let o=Math.max(0,t-1);for(;o>=0;o--)if(u[o]===C){t=o,r===!0&&t++;break}if(o<0&&u[t]!==void 0&&u[t]!==C)return w.right(s,0);t>=0&&s.setSelectionRange(t,t,"backward")},right(s,t){const r=s.value.length;let o=Math.min(r,t+1);for(;o<=r;o++)if(u[o]===C){t=o;break}else u[o-1]===C&&(t=o);if(o>r&&u[t-1]!==void 0&&u[t-1]!==C)return w.left(s,r);s.setSelectionRange(t,t,"forward")},leftReverse(s,t){const r=A(s.value.length);let o=Math.max(0,t-1);for(;o>=0;o--)if(r[o-1]===C){t=o;break}else if(r[o]===C&&(t=o,o===0))break;if(o<0&&r[t]!==void 0&&r[t]!==C)return w.rightReverse(s,0);t>=0&&s.setSelectionRange(t,t,"backward")},rightReverse(s,t){const r=s.value.length,o=A(r),f=o.slice(0,t+1).indexOf(C)===-1;let m=Math.min(r,t+1);for(;m<=r;m++)if(o[m-1]===C){t=m,t>0&&f===!0&&t--;break}if(m>r&&o[t-1]!==void 0&&o[t-1]!==C)return w.leftReverse(s,r);s.setSelectionRange(t,t,"forward")}};function D(s){n("click",s),v=void 0}function Q(s){if(n("keydown",s),dt(s)===!0||s.altKey===!0)return;const t=d.value,r=t.selectionStart,o=t.selectionEnd;if(s.shiftKey||(v=void 0),s.keyCode===37||s.keyCode===39){s.shiftKey&&v===void 0&&(v=t.selectionDirection==="forward"?r:o);const f=w[(s.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(s.preventDefault(),f(t,v===r?o:r),s.shiftKey){const m=t.selectionStart;t.setSelectionRange(Math.min(v,m),Math.max(v,m),"forward")}}else s.keyCode===8&&e.reverseFillMask!==!0&&r===o?(w.left(t,r),t.setSelectionRange(t.selectionStart,o,"backward")):s.keyCode===46&&e.reverseFillMask===!0&&r===o&&(w.rightReverse(t,o),t.setSelectionRange(r,t.selectionEnd,"forward"))}function L(s){if(s==null||s==="")return"";if(e.reverseFillMask===!0)return I(s);const t=x;let r=0,o="";for(let f=0;f<t.length;f++){const m=s[r],M=t[f];if(typeof M=="string")o+=M,m===M&&r++;else if(m!==void 0&&M.regex.test(m))o+=M.transform!==void 0?M.transform(m):m,r++;else return o}return o}function I(s){const t=x,r=u.indexOf(C);let o=s.length-1,f="";for(let m=t.length-1;m>=0&&o>-1;m--){const M=t[m];let k=s[o];if(typeof M=="string")f=M+f,k===M&&o--;else if(k!==void 0&&M.regex.test(k))do f=(M.transform!==void 0?M.transform(k):k)+f,o--,k=s[o];while(r===m&&k!==void 0&&M.regex.test(k));else return f}return f}function K(s){return typeof s!="string"||F===void 0?typeof s=="number"?F(""+s):s:F(s)}function X(s){return c.length-s.length<=0?s:e.reverseFillMask===!0&&s.length!==0?c.slice(0,-s.length)+s:s+c.slice(s.length)}return{innerValue:g,hasMask:h,moveCursorForPaste:R,updateMaskValue:p,onMaskedKeydown:Q,onMaskedClick:D}}function Xt(e,n){function l(){const d=e.modelValue;try{const u="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(d)===d&&("length"in d?Array.from(d):[d]).forEach(c=>{u.items.add(c)}),{files:u.files}}catch{return{files:void 0}}}return n===!0?E(()=>{if(e.type==="file")return l()}):E(l)}const Gt=Ne({name:"QInput",inheritAttrs:!1,props:{...ft,...Ht,...vt,modelValue:{required:!1},shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...mt,"paste","change","keydown","click","animationend"],setup(e,{emit:n,attrs:l}){const{proxy:d}=gt(),{$q:u}=d,c={};let x=NaN,F,S,v=null,h;const g=W(null),H=kt(e),{innerValue:i,hasMask:A,moveCursorForPaste:y,updateMaskValue:p,onMaskedKeydown:R,onMaskedClick:w}=Yt(e,n,k,g),D=Xt(e,!0),Q=E(()=>Me(i.value)),L=Tt(m),I=ht(),K=E(()=>e.type==="textarea"||e.autogrow===!0),X=E(()=>K.value===!0||["text","search","url","tel","password"].includes(e.type)),s=E(()=>{const a={...I.splitAttrs.listeners.value,onInput:m,onPaste:f,onChange:Y,onBlur:$,onFocus:xe};return a.onCompositionstart=a.onCompositionupdate=a.onCompositionend=L,A.value===!0&&(a.onKeydown=R,a.onClick=w),e.autogrow===!0&&(a.onAnimationend=M),a}),t=E(()=>{const a={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:H.value,...I.splitAttrs.attributes.value,id:I.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return K.value===!1&&(a.type=e.type),e.autogrow===!0&&(a.rows=1),a});P(()=>e.type,()=>{g.value&&(g.value.value=e.modelValue)}),P(()=>e.modelValue,a=>{if(A.value===!0){if(S===!0&&(S=!1,String(a)===x))return;p(a)}else i.value!==a&&(i.value=a,e.type==="number"&&c.hasOwnProperty("value")===!0&&(F===!0?F=!1:delete c.value));e.autogrow===!0&&te(b)}),P(()=>e.autogrow,a=>{a===!0?te(b):g.value!==null&&l.rows>0&&(g.value.style.height="auto")}),P(()=>e.dense,()=>{e.autogrow===!0&&te(b)});function r(){St(()=>{const a=document.activeElement;g.value!==null&&g.value!==a&&(a===null||a.id!==I.targetUid.value)&&g.value.focus({preventScroll:!0})})}function o(){g.value!==null&&g.value.select()}function f(a){if(A.value===!0&&e.reverseFillMask!==!0){const _=a.target;y(_,_.selectionStart,_.selectionEnd)}n("paste",a)}function m(a){if(!a||!a.target)return;if(e.type==="file"){n("update:modelValue",a.target.files);return}const _=a.target.value;if(a.target.qComposing===!0){c.value=_;return}if(A.value===!0)p(_,!1,a.inputType);else if(k(_),X.value===!0&&a.target===document.activeElement){const{selectionStart:j,selectionEnd:U}=a.target;j!==void 0&&U!==void 0&&te(()=>{a.target===document.activeElement&&_.indexOf(a.target.value)===0&&a.target.setSelectionRange(j,U)})}e.autogrow===!0&&b()}function M(a){n("animationend",a),b()}function k(a,_){h=()=>{v=null,e.type!=="number"&&c.hasOwnProperty("value")===!0&&delete c.value,e.modelValue!==a&&x!==a&&(x=a,_===!0&&(S=!0),n("update:modelValue",a),te(()=>{x===a&&(x=NaN)})),h=void 0},e.type==="number"&&(F=!0,c.value=a),e.debounce!==void 0?(v!==null&&clearTimeout(v),c.value=a,v=setTimeout(h,e.debounce)):h()}function b(){requestAnimationFrame(()=>{const a=g.value;if(a!==null){const _=a.parentNode.style,{scrollTop:j}=a,{overflowY:U,maxHeight:V}=u.platform.is.firefox===!0?{}:window.getComputedStyle(a),G=U!==void 0&&U!=="scroll";G===!0&&(a.style.overflowY="hidden"),_.marginBottom=a.scrollHeight-1+"px",a.style.height="1px",a.style.height=a.scrollHeight+"px",G===!0&&(a.style.overflowY=parseInt(V,10)<a.scrollHeight?"auto":"hidden"),_.marginBottom="",a.scrollTop=j}})}function Y(a){L(a),v!==null&&(clearTimeout(v),v=null),h!==void 0&&h(),n("change",a.target.value)}function $(a){a!==void 0&&xe(a),v!==null&&(clearTimeout(v),v=null),h!==void 0&&h(),F=!1,S=!1,delete c.value,e.type!=="file"&&setTimeout(()=>{g.value!==null&&(g.value.value=i.value!==void 0?i.value:"")})}function T(){return c.hasOwnProperty("value")===!0?c.value:i.value!==void 0?i.value:""}yt(()=>{$()}),pt(()=>{e.autogrow===!0&&b()}),Object.assign(I,{innerValue:i,fieldClass:E(()=>`q-${K.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:E(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:g,emitValue:k,hasValue:Q,floatingLabel:E(()=>Q.value===!0&&(e.type!=="number"||isNaN(i.value)===!1)||Me(e.displayValue)),getControl:()=>ne(K.value===!0?"textarea":"input",{ref:g,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...t.value,...s.value,...e.type!=="file"?{value:T()}:D.value}),getShadowControl:()=>ne("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(K.value===!0?"":" text-no-wrap")},[ne("span",{class:"invisible"},T()),ne("span",e.shadowText)])});const B=wt(I);return Object.assign(d,{focus:r,select:o,getNativeElement:()=>g.value}),bt(d,"nativeEl",()=>g.value),B}}),en={class:"token-select"},tn=["src"],nn=["src"],un=Ue({__name:"SelectToken",props:{options:Object,searchToken:String,direction:{type:Boolean,default:!1},token:Object,swapToken:String,disable:{type:Boolean,default:!1}},emits:["handleSearchToken","setToken"],setup(e,{emit:n}){const l=e,d=n,u=W(l.searchToken),c=W(l.token??l.options[0]);P(()=>l.token,S=>{c.value=S});function x(){u.value=""}const F=E(()=>l.options.map(S=>({...S,inactive:Ce(String(S.value))===Ce(l.swapToken)})));return P(u,S=>{d("handleSearchToken",S)}),P(c,S=>{d("setToken",S,l.direction)}),(S,v)=>(ee(),me("div",en,[O(Ct,{modelValue:q(c),"onUpdate:modelValue":v[2]||(v[2]=h=>ke(c)?c.value=h:null),"option-disable":"inactive","popup-content-class":"transition-duration",outlined:"",options:q(F),dense:"","options-dense":!1,disable:e.disable,onPopupHide:x},{prepend:N(()=>[O(Ee,null,{default:N(()=>[ae("img",{src:q(c).image},null,8,tn)]),_:1})]),option:N(h=>[O(Re,_t(h.itemProps,{class:"token-select__token"}),{default:N(()=>[O(de,{avatar:"",class:"token-select__token--item"},{default:N(()=>[O(Ee,null,{default:N(()=>[ae("img",{src:h.opt.image},null,8,nn)]),_:2},1024)]),_:2},1024),O(de,null,{default:N(()=>[O(At,null,{default:N(()=>[ge(Mt(h.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":N(()=>[O(Gt,{modelValue:q(u),"onUpdate:modelValue":v[1]||(v[1]=h=>ke(u)?u.value=h:null),maxlength:8,outlined:"",class:"token-search"},{append:N(()=>[O(xt,{name:q(Le),class:"cursor-pointer token-search__close",onClick:v[0]||(v[0]=h=>u.value="")},null,8,["name"])]),_:1},8,["modelValue"]),O(Re,null,{default:N(()=>[O(de,{class:"text-grey"},{default:N(()=>[ge(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","disable"])]))}});export{Bt as P,Gt as Q,rn as _,un as a,sn as b,on as o,ln as u};
