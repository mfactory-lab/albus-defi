var Ee=Object.defineProperty;var Le=(t,e,i)=>e in t?Ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var S=(t,e,i)=>(Le(t,typeof e!="symbol"?e+"":e,i),i);import{_ as Qe,a as Ze,b as Ne}from"./AppDescriptionTop-3532d1df.js";import{_ as We}from"./PolicyCard.vue_vue_type_script_setup_true_lang-4ea4b58c.js";import{o as ze,_ as De}from"./SelectToken.vue_vue_type_script_setup_true_lang-df9fccc4.js";import{k as a,bk as w,P as p,bg as _,as as I,am as X,bq as $e,K as we,ah as P,aw as He,br as qe,bs as je,bt as Oe,ae as ve,R as ge,J as Ge,af as Xe,ag as Ye,ai as et,a as Z,s as tt,u as it,x as he,w as Re,B as nt,v as T,bu as Ue,C as G,bn as rt,bb as st,bv as at,aE as ot,z as ut,V as ke,o as x,Y as N,Z as B,j as k,a1 as Fe,a2 as c,a3 as u,i as Q,a5 as h,a4 as Y,a0 as R,a6 as ee,a7 as te,a8 as ie,bw as Je,a9 as Ke,$ as be,G as ct,aV as _e,aK as Pe,aW as lt,aX as mt,aY as Te,aZ as dt,_ as ft,ad as pt}from"./index-d32ec668.js";const yt="/assets/unrecognized-token-3289de57.svg";function Be(t,e){if(e)return e[t]?.symbol??""}function ne(t){return t??yt}const gt=[244,158,220,65,8,73,4,65];class K{constructor(e,i){this.authority=e,this.isPlatformPaused=i}static fromArgs(e){return new K(e.authority,e.isPlatformPaused)}static fromAccountInfo(e,i=0){return K.deserialize(e.data,i)}static async fromAccountAddress(e,i,n){const r=await e.getAccountInfo(i,n);if(r==null)throw new Error(`Unable to find Admin account at ${i}`);return K.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return w.GpaBuilder.fromStruct(e,$)}static deserialize(e,i=0){return $.deserialize(e,i)}serialize(){return $.serialize({accountDiscriminator:gt,...this})}static get byteSize(){return $.byteSize}static async getMinimumBalanceForRentExemption(e,i){return e.getMinimumBalanceForRentExemption(K.byteSize,i)}static hasCorrectByteSize(e,i=0){return e.byteLength-i===K.byteSize}pretty(){return{authority:this.authority.toBase58(),isPlatformPaused:this.isPlatformPaused}}}const $=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",w.publicKey],["isPlatformPaused",a.bool]],K.fromArgs,"Admin"),ht=[221,78,171,233,213,142,113,56];class V{constructor(e,i){this.authority=e,this.isAllPaused=i}static fromArgs(e){return new V(e.authority,e.isAllPaused)}static fromAccountInfo(e,i=0){return V.deserialize(e.data,i)}static async fromAccountAddress(e,i,n){const r=await e.getAccountInfo(i,n);if(r==null)throw new Error(`Unable to find Manager account at ${i}`);return V.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return w.GpaBuilder.fromStruct(e,H)}static deserialize(e,i=0){return H.deserialize(e,i)}serialize(){return H.serialize({accountDiscriminator:ht,...this})}static get byteSize(){return H.byteSize}static async getMinimumBalanceForRentExemption(e,i){return e.getMinimumBalanceForRentExemption(V.byteSize,i)}static hasCorrectByteSize(e,i=0){return e.byteLength-i===V.byteSize}pretty(){return{authority:this.authority.toBase58(),isAllPaused:this.isAllPaused}}}const H=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",w.publicKey],["isAllPaused",a.bool]],V.fromArgs,"Manager"),Se=new a.BeetArgsStruct([["num",a.u64],["denom",a.u64]],"Ratio"),Ie=[85,72,49,176,182,228,141,82];class C{constructor(e,i,n,r,s,o,m,l,d,b){this.authority=e,this.tokenA=i,this.tokenB=n,this.lockedAmount=r,this.ratio=s,this.isPaused=o,this.lockFee=m,this.unlockFee=l,this.feeReceiver=d,this.policy=b}static fromArgs(e){return new C(e.authority,e.tokenA,e.tokenB,e.lockedAmount,e.ratio,e.isPaused,e.lockFee,e.unlockFee,e.feeReceiver,e.policy)}static fromAccountInfo(e,i=0){return C.deserialize(e.data,i)}static async fromAccountAddress(e,i,n){const r=await e.getAccountInfo(i,n);if(r==null)throw new Error(`Unable to find Pair account at ${i}`);return C.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return w.GpaBuilder.fromStruct(e,q)}static deserialize(e,i=0){return q.deserialize(e,i)}serialize(){return q.serialize({accountDiscriminator:Ie,...this})}static byteSize(e){const i=C.fromArgs(e);return q.toFixedFromValue({accountDiscriminator:Ie,...i}).byteSize}static async getMinimumBalanceForRentExemption(e,i,n){return i.getMinimumBalanceForRentExemption(C.byteSize(e),n)}pretty(){return{authority:this.authority.toBase58(),tokenA:this.tokenA.toBase58(),tokenB:this.tokenB.toBase58(),lockedAmount:(()=>{const e=this.lockedAmount;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),ratio:this.ratio,isPaused:this.isPaused,lockFee:this.lockFee,unlockFee:this.unlockFee,feeReceiver:this.feeReceiver.toBase58(),policy:this.policy}}}const q=new a.FixableBeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",w.publicKey],["tokenA",w.publicKey],["tokenB",w.publicKey],["lockedAmount",a.u64],["ratio",Se],["isPaused",a.bool],["lockFee",a.u16],["unlockFee",a.u16],["feeReceiver",w.publicKey],["policy",a.coption(w.publicKey)]],C.fromArgs,"Pair"),kt=[159,117,95,227,239,151,58,236];class E{constructor(e,i){this.authority=e,this.isBlocked=i}static fromArgs(e){return new E(e.authority,e.isBlocked)}static fromAccountInfo(e,i=0){return E.deserialize(e.data,i)}static async fromAccountAddress(e,i,n){const r=await e.getAccountInfo(i,n);if(r==null)throw new Error(`Unable to find User account at ${i}`);return E.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return w.GpaBuilder.fromStruct(e,j)}static deserialize(e,i=0){return j.deserialize(e,i)}serialize(){return j.serialize({accountDiscriminator:kt,...this})}static get byteSize(){return j.byteSize}static async getMinimumBalanceForRentExemption(e,i){return e.getMinimumBalanceForRentExemption(E.byteSize,i)}static hasCorrectByteSize(e,i=0){return e.byteLength-i===E.byteSize}pretty(){return{authority:this.authority.toBase58(),isBlocked:this.isBlocked}}}const j=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",w.publicKey],["isBlocked",a.bool]],E.fromArgs,"User"),bt=[17,50,115,0,10,220,15,157];class L{constructor(e,i){this.user=e,this.pair=i}static fromArgs(e){return new L(e.user,e.pair)}static fromAccountInfo(e,i=0){return L.deserialize(e.data,i)}static async fromAccountAddress(e,i,n){const r=await e.getAccountInfo(i,n);if(r==null)throw new Error(`Unable to find WhitelistedUserInfo account at ${i}`);return L.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return w.GpaBuilder.fromStruct(e,O)}static deserialize(e,i=0){return O.deserialize(e,i)}serialize(){return O.serialize({accountDiscriminator:bt,...this})}static get byteSize(){return O.byteSize}static async getMinimumBalanceForRentExemption(e,i){return e.getMinimumBalanceForRentExemption(L.byteSize,i)}static hasCorrectByteSize(e,i=0){return e.byteLength-i===L.byteSize}pretty(){return{user:this.user.toBase58(),pair:this.pair.toBase58()}}}const O=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["user",w.publicKey],["pair",w.publicKey]],L.fromArgs,"WhitelistedUserInfo"),U=new Map,F=new Map;class ae extends Error{constructor(){super("Unauthorized action");S(this,"code",6e3);S(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ae)}}U.set(6e3,()=>new ae);F.set("Unauthorized",()=>new ae);class oe extends Error{constructor(){super("Paused");S(this,"code",6001);S(this,"name","IsPaused");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,oe)}}U.set(6001,()=>new oe);F.set("IsPaused",()=>new oe);class ue extends Error{constructor(){super("Already resumed");S(this,"code",6002);S(this,"name","AlreadyResumed");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ue)}}U.set(6002,()=>new ue);F.set("AlreadyResumed",()=>new ue);class ce extends Error{constructor(){super("Pair still have locked tokens");S(this,"code",6003);S(this,"name","StillRemainingLockedTokens");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ce)}}U.set(6003,()=>new ce);F.set("StillRemainingLockedTokens",()=>new ce);class le extends Error{constructor(){super("User is blocked");S(this,"code",6004);S(this,"name","IsBlocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,le)}}U.set(6004,()=>new le);F.set("IsBlocked",()=>new le);class me extends Error{constructor(){super("User is already unblocked");S(this,"code",6005);S(this,"name","AlreadyUnblocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,me)}}U.set(6005,()=>new me);F.set("AlreadyUnblocked",()=>new me);class de extends Error{constructor(){super("Insufficient locked amount");S(this,"code",6006);S(this,"name","InsufficientLockedAmount");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,de)}}U.set(6006,()=>new de);F.set("InsufficientLockedAmount",()=>new de);class fe extends Error{constructor(){super("Insufficient funds");S(this,"code",6007);S(this,"name","InsufficientFunds");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,fe)}}U.set(6007,()=>new fe);F.set("InsufficientFunds",()=>new fe);const St=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["key",w.publicKey]],"AddManagerInstructionArgs"),At=[125,38,192,212,101,91,179,16];function wt(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=St.serialize({instructionDiscriminator:At,...e}),r=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.manager,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const vt=new a.FixableBeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["policy",a.coption(w.publicKey)],["ratio",Se]],"AddPairInstructionArgs"),_t=[209,230,17,236,218,162,86,118];function Pt(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=vt.serialize({instructionDiscriminator:_t,...e}),r=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:t.tokenA,isWritable:!0,isSigner:!1},{pubkey:t.tokenB,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const Tt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"AddUserToWhitelistInstructionArgs"),Bt=[244,177,124,12,22,50,139,152];function It(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Tt.serialize({instructionDiscriminator:Bt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.user,isWritable:!0,isSigner:!1},{pubkey:t.userAuthority,isWritable:!1,isSigner:!1},{pubkey:t.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.tokenA,isWritable:!0,isSigner:!1},{pubkey:t.tokenB,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Mt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"BlockUserInstructionArgs"),xt=[10,164,178,6,231,175,185,191];function Wt(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Mt.serialize({instructionDiscriminator:xt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.user,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const zt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"LockTokensInstructionArgs"),Dt=[136,11,32,232,161,117,54,211];function Rt(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=zt.serialize({instructionDiscriminator:Dt,...e}),r=[{pubkey:t.proofRequest??i,isWritable:!1,isSigner:!1},{pubkey:t.user,isWritable:!0,isSigner:!1},{pubkey:t.userAuthority,isWritable:!0,isSigner:!0},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:t.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.tokenA,isWritable:!0,isSigner:!1},{pubkey:t.tokenB,isWritable:!0,isSigner:!1},{pubkey:t.sourceA,isWritable:!0,isSigner:!1},{pubkey:t.destinationA,isWritable:!0,isSigner:!1},{pubkey:t.destinationB,isWritable:!0,isSigner:!1},{pubkey:t.feePayer,isWritable:!0,isSigner:!0},{pubkey:t.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:t.tokenProgram??X,isWritable:!1,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const Ut=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"PausePairsInstructionArgs"),Ft=[147,150,152,192,119,95,137,64];function Jt(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Ut.serialize({instructionDiscriminator:Ft}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!0,isSigner:!1},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Kt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"PausePlatformInstructionArgs"),Vt=[232,46,204,130,181,0,172,57];function Ct(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Kt.serialize({instructionDiscriminator:Vt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.admin,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Et=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemoveManagerInstructionArgs"),Lt=[150,55,157,77,128,148,7,15];function Qt(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Et.serialize({instructionDiscriminator:Lt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!0,isSigner:!1},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Zt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemovePairInstructionArgs"),Nt=[181,42,154,249,167,123,20,81];function $t(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Zt.serialize({instructionDiscriminator:Nt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Ht=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemoveUserFromWhitelistInstructionArgs"),qt=[198,73,139,218,243,209,180,182];function jt(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Ht.serialize({instructionDiscriminator:qt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Ot=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"ResumePairsInstructionArgs"),Gt=[23,106,248,226,173,20,247,74];function Xt(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Ot.serialize({instructionDiscriminator:Gt}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!0,isSigner:!1},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const Yt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"ResumePlatformInstructionArgs"),ei=[23,162,56,123,186,207,109,131];function ti(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=Yt.serialize({instructionDiscriminator:ei}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.admin,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const ii=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["key",w.publicKey]],"SetAdminInstructionArgs"),ni=[251,163,0,52,91,194,187,92];function ri(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=ii.serialize({instructionDiscriminator:ni,...e}),r=[{pubkey:t.admin,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const si=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"UnblockUserInstructionArgs"),ai=[216,208,128,98,74,210,18,114];function oi(t,e=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[i]=si.serialize({instructionDiscriminator:ai}),n=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.user,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)n.push(s);return new I({programId:e,keys:n,data:i})}const ui=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"UnlockTokensInstructionArgs"),ci=[233,35,95,159,37,185,47,88];function li(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=ui.serialize({instructionDiscriminator:ci,...e}),r=[{pubkey:t.proofRequest??i,isWritable:!1,isSigner:!1},{pubkey:t.user,isWritable:!0,isSigner:!1},{pubkey:t.userAuthority,isWritable:!0,isSigner:!0},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:t.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:t.manager,isWritable:!1,isSigner:!1},{pubkey:t.admin,isWritable:!1,isSigner:!1},{pubkey:t.tokenA,isWritable:!0,isSigner:!1},{pubkey:t.tokenB,isWritable:!0,isSigner:!1},{pubkey:t.sourceA,isWritable:!0,isSigner:!1},{pubkey:t.destinationA,isWritable:!0,isSigner:!1},{pubkey:t.sourceB,isWritable:!0,isSigner:!1},{pubkey:t.feePayer,isWritable:!0,isSigner:!0},{pubkey:t.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:t.tokenProgram??X,isWritable:!1,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const mi=new a.FixableBeetArgsStruct([["newAuthority",a.coption(w.publicKey)],["isPaused",a.coption(a.bool)],["ratio",a.coption(Se)],["lockFee",a.coption(a.u16)],["unlockFee",a.coption(a.u16)],["feeReceiver",a.coption(w.publicKey)]],"UpdatePairData"),di=new a.FixableBeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["data",mi]],"UpdatePairInstructionArgs"),fi=[176,62,36,215,255,206,35,12];function pi(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=di.serialize({instructionDiscriminator:fi,...e}),r=[{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const yi=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"WithdrawFeeInstructionArgs"),gi=[14,122,231,218,31,238,223,150];function hi(t,e,i=new p("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=yi.serialize({instructionDiscriminator:gi,...e}),r=[{pubkey:t.pair,isWritable:!0,isSigner:!1},{pubkey:t.pairAuthority,isWritable:!0,isSigner:!1},{pubkey:t.destination,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.systemProgram??_.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)r.push(o);return new I({programId:i,keys:r,data:n})}const ki="JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm",Me=new p(ki),bi={version:"0.0.5",name:"smart_converter",instructions:[{name:"setAdmin",accounts:[{name:"admin",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addPair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"policy",type:{option:"publicKey"}},{name:"ratio",type:{defined:"Ratio"}}]},{name:"addUserToWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"userAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removeUserFromWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"lockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"user",isMut:!0,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"destinationB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"unlockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"user",isMut:!0,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"sourceB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"removeManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updatePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"UpdatePairData"}}]},{name:"blockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"unblockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"withdrawFee",accounts:[{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]}],accounts:[{name:"pair",type:{kind:"struct",fields:[{name:"authority",docs:["Manager authority"],type:"publicKey"},{name:"tokenA",docs:["Security token mint address"],type:"publicKey"},{name:"tokenB",docs:["Utility token mint address"],type:"publicKey"},{name:"lockedAmount",docs:["Amount of security tokens currently locked"],type:"u64"},{name:"ratio",docs:["Ratio of token A to token B"],type:{defined:"Ratio"}},{name:"isPaused",docs:["Indicates if pair is paused or not"],type:"bool"},{name:"lockFee",docs:["Fee for locking token A"],type:"u16"},{name:"unlockFee",docs:["Fee for unlocking token A"],type:"u16"},{name:"feeReceiver",docs:["Wallet that will receive fee"],type:"publicKey"},{name:"policy",docs:["Albus policy"],type:{option:"publicKey"}}]}},{name:"admin",type:{kind:"struct",fields:[{name:"authority",docs:["Manager wallet address"],type:"publicKey"},{name:"isPlatformPaused",docs:["Indicates if platform is paused or not"],type:"bool"}]}},{name:"manager",type:{kind:"struct",fields:[{name:"authority",docs:["Manager address"],type:"publicKey"},{name:"isAllPaused",docs:["Indicates if manager's pairs are paused or not"],type:"bool"}]}},{name:"user",type:{kind:"struct",fields:[{name:"authority",docs:["User address"],type:"publicKey"},{name:"isBlocked",docs:["Indicates if user is blocked or not"],type:"bool"}]}},{name:"whitelistedUserInfo",type:{kind:"struct",fields:[{name:"user",docs:["User address"],type:"publicKey"},{name:"pair",docs:["Pair address"],type:"publicKey"}]}}],types:[{name:"UpdatePairData",type:{kind:"struct",fields:[{name:"newAuthority",type:{option:"publicKey"}},{name:"isPaused",type:{option:"bool"}},{name:"ratio",type:{option:{defined:"Ratio"}}},{name:"lockFee",type:{option:"u16"}},{name:"unlockFee",type:{option:"u16"}},{name:"feeReceiver",type:{option:"publicKey"}}]}},{name:"Ratio",type:{kind:"struct",fields:[{name:"num",type:"u64"},{name:"denom",type:"u64"}]}}],events:[{name:"LockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!0},{name:"userWallet",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"UnlockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!0},{name:"userWallet",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]}],errors:[{code:6e3,name:"Unauthorized",msg:"Unauthorized action"},{code:6001,name:"IsPaused",msg:"Paused"},{code:6002,name:"AlreadyResumed",msg:"Already resumed"},{code:6003,name:"StillRemainingLockedTokens",msg:"Pair still have locked tokens"},{code:6004,name:"IsBlocked",msg:"User is blocked"},{code:6005,name:"AlreadyUnblocked",msg:"User is already unblocked"},{code:6006,name:"InsufficientLockedAmount",msg:"Insufficient locked amount"},{code:6007,name:"InsufficientFunds",msg:"Insufficient funds"}]};function xe(t){return"version"in t}class Si{constructor(e){this.payer=e}async signTransaction(e){return xe(e)?e.sign([this.payer]):e.partialSign(this.payer),e}async signAllTransactions(e){return e.map(i=>(xe(i)?i.sign([this.payer]):i.partialSign(this.payer),i))}get publicKey(){return this.payer.publicKey}}const Ai="user",wi="manager",vi="pair",_i="admin",Pi="whitelist",se=class se{constructor(e){S(this,"program");this.provider=e,this.program=new $e(bi,Me,e)}static fromWallet(e,i,n){return new this(new we(e,i??{publicKey:p.default},{...we.defaultOptions(),...n}))}static fromKeypair(e,i,n){return se.fromWallet(e,new Si(i),n)}get idl(){return this.program.idl}get pda(){return new Ti}fetchManager(e){return this.program.account.manager.fetchNullable(e)}fetchAdmin(e){return this.program.account.admin.fetchNullable(e??this.pda.admin()[0])}fetchUser(e){return this.program.account.user.fetchNullable(e)}fetchPair(e){return this.program.account.pair.fetchNullable(e)}fetchWhitelistedUserInfo(e){return this.program.account.whitelistedUserInfo.fetchNullable(e)}fetchWhitelistedUserInfoByUserAndPair(e,i){const[n]=this.pda.whitelistedUserInfo(e,i);return this.fetchWhitelistedUserInfo(n)}findManagers(){return this.program.account.manager.all()}findPairs(){return this.program.account.pair.all()}async findManagerPairs(e){return(await this.program.account.pair.all()).filter(n=>n.account.authority.toBase58()===e.toBase58())}async findWhitelistedUsers(e){return(await this.program.account.whitelistedUserInfo.all()).filter(n=>n.account.pair.toBase58()===e.toBase58())}async findUserWhitelistInfos(e){return(await this.program.account.whitelistedUserInfo.all()).filter(n=>n.account.user.toBase58()===e.toBase58())}async addManager(e){const i=this.provider.publicKey,[n]=this.pda.manager(e.managerWallet),[r]=this.pda.admin(),s=wt({authority:i,admin:r,manager:n},{key:e.managerWallet}),o=new P().add(s);return{signature:await this.provider.sendAndConfirm(o),manager:n}}async addPair(e){const i=this.provider.publicKey,[n]=this.pda.manager(i),r=e.tokenA;let s=e.tokenB;const o=new P,m=[];let l,d;if(s)l=this.pda.pair(r,s)[0],d=this.pda.pairAuthority(l)[0];else{const g=e.tokenBKeypair??He.generate();s=g.publicKey,m.push(g),l=this.pda.pair(r,s)[0],d=this.pda.pairAuthority(l)[0];const y=await qe(this.provider.connection);o.add(_.createAccount({fromPubkey:i,newAccountPubkey:g.publicKey,space:je,lamports:y,programId:X}),Oe(g.publicKey,9,d,null,X))}return await this.handleMissingTokenAccount(o,r,d),await this.handleMissingTokenAccount(o,s,d),o.add(Pt({authority:i,manager:n,pair:l,pairAuthority:d,tokenA:r,tokenB:s},{ratio:e.ratio??{num:1,denom:1},policy:e.policy??null})),{signature:await this.provider.sendAndConfirm(o,m),pair:l}}async lockTokens(e){const i=this.provider.publicKey,n=e.tokenA,r=e.tokenB,[s]=this.pda.user(i),[o]=this.pda.pair(n,r),m=await this.fetchPair(o),[l]=this.pda.admin(),[d]=this.pda.manager(m.authority),[b]=this.pda.pairAuthority(o),[g]=this.pda.whitelistedUserInfo(i,o),y=new P,A=ve(n,i),f=await this.handleMissingTokenAccount(y,n,b),v=await this.handleMissingTokenAccount(y,r,i);return y.add(Rt({proofRequest:e.proofRequest,user:s,userAuthority:i,pair:o,pairAuthority:b,admin:l,manager:d,whitelistedUserInfo:g,feePayer:e.feePayer??i,feeReceiver:m.feeReceiver,sourceA:A,destinationA:f,destinationB:v,tokenA:n,tokenB:r},{amount:new ge(e.amount)})),{signature:await this.provider.sendAndConfirm(y),pair:o}}async unlockTokens(e){const i=this.provider.publicKey,n=e.tokenA,r=e.tokenB,[s]=this.pda.admin(),[o]=this.pda.user(i),[m]=this.pda.pair(n,r),[l]=this.pda.pairAuthority(m),[d]=this.pda.whitelistedUserInfo(i,m),b=await this.fetchPair(m),[g]=this.pda.manager(b.authority),y=new P,A=await this.handleMissingTokenAccount(y,r,i),f=await this.handleMissingTokenAccount(y,n,l),v=await this.handleMissingTokenAccount(y,n,i);return y.add(li({proofRequest:e.proofRequest,user:o,userAuthority:i,pair:m,pairAuthority:l,feePayer:e.feePayer??i,feeReceiver:b.feeReceiver,whitelistedUserInfo:d,admin:s,destinationA:v,manager:g,sourceA:f,sourceB:A,tokenA:n,tokenB:r},{amount:new ge(e.amount)})),{signature:await this.provider.sendAndConfirm(y),pair:m,user:o}}async addUserToWhitelist(e){const i=this.provider.publicKey,[n]=this.pda.manager(i),r=e.userWallet,[s]=this.pda.user(r),o=e.tokenA,m=e.tokenB,[l]=this.pda.pair(o,m),[d]=this.pda.whitelistedUserInfo(r,l),b=It({userAuthority:r,authority:i,manager:n,pair:l,tokenA:o,tokenB:m,user:s,whitelistedUserInfo:d}),g=new P().add(b);return{signature:await this.provider.sendAndConfirm(g),user:s,whitelistedUserInfo:d}}async removeUserFromWhitelist(e){const i=this.provider.publicKey,n=e.userWallet,[r]=this.pda.user(n),[s]=this.pda.pair(e.tokenA,e.tokenB),[o]=this.pda.whitelistedUserInfo(n,s),m=jt({authority:i,pair:s,whitelistedUserInfo:o}),l=new P().add(m);return{signature:await this.provider.sendAndConfirm(l),user:r,whitelistedUserInfo:o}}async blockUser(e){const i=this.provider.publicKey,[n]=this.pda.manager(i),r=e.userWallet,[s]=this.pda.user(r),o=Wt({authority:i,manager:n,user:s}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),user:s}}async unblockUser(e){const i=this.provider.publicKey,n=e.userWallet,[r]=this.pda.manager(i),[s]=this.pda.user(n),o=oi({authority:i,manager:r,user:s}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),user:s}}async pausePairs(e){const i=this.provider.publicKey,n=e.managerWallet,[r]=this.pda.manager(n),[s]=this.pda.admin(),o=Jt({admin:s,authority:i,manager:r}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),manager:r}}async pausePlatform(){const e=this.provider.publicKey,[i]=this.pda.admin(),n=Ct({admin:i,authority:e}),r=new P().add(n);return{signature:await this.provider.sendAndConfirm(r),admin:i}}async removeManager(e){const i=this.provider.publicKey,n=e.managerWallet,[r]=this.pda.manager(n),[s]=this.pda.admin(),o=Qt({admin:s,authority:i,manager:r}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),manager:r}}async removePair(e){const i=this.provider.publicKey,n=e.tokenA,r=e.tokenB,[s]=this.pda.pair(n,r),o=$t({authority:i,pair:s}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),pair:s}}async resumePairs(e){const i=this.provider.publicKey,n=e.managerWallet,[r]=this.pda.manager(n),[s]=this.pda.admin(),o=Xt({authority:i,admin:s,manager:r}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),manager:r}}async resumePlatform(){const e=this.provider.publicKey,[i]=this.pda.admin(),n=ti({authority:e,admin:i}),r=new P().add(n);return{signature:await this.provider.sendAndConfirm(r),admin:i}}async setAdmin(e){const i=this.provider.publicKey,[n]=this.pda.admin(),r=ri({authority:i,admin:n},{key:e.authority}),s=new P().add(r);return{signature:await this.provider.sendAndConfirm(s)}}async withdrawFee(e){const i=this.provider.publicKey,[n]=this.pda.pair(e.tokenA,e.tokenB),[r]=this.pda.pairAuthority(n),s=hi({authority:i,pair:n,pairAuthority:r,destination:e.destination},{amount:new ge(e.amount)}),o=new P().add(s);return{signature:await this.provider.sendAndConfirm(o)}}async updatePair(e){const i=this.provider.publicKey,n=e.tokenA,r=e.tokenB,[s]=this.pda.pair(n,r),o=pi({authority:i,pair:s},{data:{feeReceiver:e.feeReceiver??null,lockFee:e.lockFee??null,unlockFee:e.unlockFee??null,newAuthority:e.newAuthority??null,isPaused:e.isPaused??null,ratio:e.ratio??null}}),m=new P().add(o);return{signature:await this.provider.sendAndConfirm(m),pair:s}}async handleMissingTokenAccount(e,i,n){const r=n??this.provider.publicKey,s=ve(i,r,!0);try{await Ge(this.provider.connection,s)}catch(o){(o instanceof Xe||o instanceof Ye)&&e.add(et(this.provider.publicKey,s,r,i))}return s}};S(se,"programId",Me);let re=se;class Ti{constructor(){S(this,"pairAuthority",e=>this.pda([new p(e).toBuffer()]));S(this,"admin",()=>this.pda([Z.Buffer.from(_i)]));S(this,"manager",e=>this.pda([Z.Buffer.from(wi),new p(e).toBuffer()]));S(this,"user",e=>this.pda([Z.Buffer.from(Ai),new p(e).toBuffer()]));S(this,"pair",(e,i)=>this.pda([Z.Buffer.from(vi),new p(e).toBuffer(),new p(i).toBuffer()]));S(this,"whitelistedUserInfo",(e,i)=>this.pda([Z.Buffer.from(Pi),new p(e).toBuffer(),new p(i).toBuffer()]))}pda(e){return p.findProgramAddressSync(e,re.programId)}}const Ae=tt("converter",()=>{const t=it(),e=he(),{setContractPolicy:i}=Re(),n=nt({from:{amount:void 0},to:{amount:void 0},token:void 0,allTokens:[],pairs:[],selectedPair:void 0,searchToken:"",converting:!1,loading:!1,isLock:!0}),r=T(()=>re.fromWallet(t.connection,e.value));async function s(l,d,b){try{const g=await st.Metadata.fromAccountAddress(l,at(d)),y=g.data?.uri;if(y){const{data:A}=await ot.get(y);return{...A,image:ne(A?.image)}}return g}catch{return{symbol:b,image:ne()}}}const o=l=>n.allTokens.find(b=>b.mint.toBase58()===l)?.balance??0,m=async()=>{try{const l=e.value?.publicKey;if(!l)return;n.allTokens=await rt(t.connection,l)}catch(l){console.log(l)}};return Ue(r,async l=>{try{n.loading=!0;const d=await r.value.findPairs();if(n.pairs.length!==0)return;const b=await Promise.all(d.map(async g=>{const y=g.account,A=y.tokenA.toBase58(),f=y.tokenB.toBase58(),v=await s(t.connection,A,"tokenA"),M=await s(t.connection,f,"tokenB"),W={[A]:v,[f]:M};return{...g,tokensMetadata:W}}));n.pairs=b}catch(d){console.log(d)}finally{n.loading=!1}},{immediate:!0,debounce:500,maxWait:1e3}),G(()=>e.value?.publicKey,async l=>{if(!l){n.allTokens=[],n.from.balance=0,n.to.balance=0;return}await m()},{immediate:!0}),G([()=>n.token,()=>n.allTokens,()=>n.pairs],([l])=>{const d=n.selectedPair;if(!d)return;const b=d.account?.policy;b&&i(String(b));for(const g in d.tokensMetadata){const y=d.tokensMetadata[g],A=o(String(g));g===l?.mint?n.from={...y,balance:A,amount:void 0}:n.to={...y,balance:A,amount:void 0}}}),G(()=>n.isLock,()=>{n.token=void 0}),{state:n,getAllTokens:m,converterClient:r}});function Ve(){const t=Ae(),e=Re(),{notify:i}=ut();function n(f){console.log("set token ======== ",f),t.state.selectedPair=t.state.pairs.find(v=>v.publicKey.toBase58()===f?.publicKey?.toBase58()),t.state.token=f}function r(f){t.state.searchToken=f}const s=T(()=>t.state.pairs.map(M=>{const W=Object.entries(M.tokensMetadata)[t.state.isLock?0:1];return{...W[1],mint:W[0],publicKey:M.publicKey}}).flat().filter(M=>M.symbol.toLowerCase().includes(t.state.searchToken.toLowerCase()))),o=T(()=>t.state.selectedPair?.account),m=T(()=>o.value?.ratio?.num?.toNumber()??1),l=T(()=>o.value?.lockedAmount?.toNumber()??0),d=T(()=>o.value?.lockFee),b=T(()=>{const f=o.value?.tokenA?.toString();return Be(f,t.state.selectedPair?.tokensMetadata)}),g=T(()=>{const f=o.value?.tokenB?.toString();return Be(f,t.state.selectedPair?.tokensMetadata)}),y=T(()=>!!e.state.certificates?.find(f=>f.data?.policy.toBase58()===String(e.requiredPolicy)));async function A(f=!0){if(o.value)try{t.state.converting=!0;const v=o.value.tokenA,M=o.value.tokenB,W=o.value.policy,z=Number(t.state.from.amount);f?await t.converterClient.lockTokens({tokenA:v,tokenB:M,amount:z,proofRequest:W}):await t.converterClient.unlockTokens({tokenA:v,tokenB:M,amount:z,proofRequest:W}),await t.getAllTokens()}catch(v){console.error("lockedToken error: ",v),i({type:"negative",message:`${v}`})}finally{t.state.converting=!1}}return Ue(s,f=>{f.length!==0&&!t.state.token&&n(f[0])},{immediate:!0,debounce:100,maxWait:1e3}),G(()=>t.state.from.amount,f=>{f&&(t.state.to.amount=t.state.isLock?f*m.value:f/m.value)}),{options:s,setToken:n,handleSearchToken:r,pairRatio:m,pairLockedAmount:l,pairLockFee:d,tokenASymbol:b,tokenBSymbol:g,isHaveCertificate:y,lockUnlockToken:A}}const Bi={class:"swap-form"},Ii={class:"swap-field"},Mi={class:"swap-field__info"},xi={class:"row items-end"},Wi=c("div",{class:"col swap-field__label"}," FROM: ",-1),zi={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Di={key:0,class:"insufficient-error"},Ri=c("div",{class:"swap-change"},null,-1),Ui={class:"swap-field"},Fi={class:"swap-field__info"},Ji={class:"row"},Ki=c("div",{class:"col swap-field__label"}," TO: ",-1),Vi={class:"col swap-field__balance"},Ci={class:"convert-to"},Ei=["src"],Li={class:"swap-info q-mt-md q-pt-xs"},Qi={class:"text-weight-medium"},Zi=c("dt",null,"Received",-1),Ni=c("dt",null,"Locked amount",-1),$i=c("dt",null,"Ratio",-1),Hi={key:0},qi={key:1},ji=c("dt",null,"Lock fee",-1),Oi={class:"swap-submit q-mt-md"},Gi={class:"row q-mt-md text-center relative-position full-width"},Xi={class:"swap-rate q-mx-auto"},Yi=ke({__name:"UnlockCard",setup(t){const{state:e}=Ae(),{options:i,setToken:n,handleSearchToken:r,pairRatio:s,pairLockedAmount:o,pairLockFee:m,tokenASymbol:l,tokenBSymbol:d,isHaveCertificate:b,lockUnlockToken:g}=Ve();e.isLock=!1;const y=he(),A=T(()=>e.from.balance),f=T(()=>e.to.balance),v=T(()=>e.to.amount);function M(){e.from.amount=A.value}async function W(){await g(!1)}const z=T(()=>e.from.amount>A.value?"Insufficient funds":!1);return(Ce,D)=>{const pe=De,ye=We;return x(),N(be,{class:"swap-card swap-widget converting-card"},{default:B(()=>[k(Fe,{class:"swap-card__body"},{default:B(()=>[c("div",Bi,[c("div",Ii,[c("div",Mi,[c("div",xi,[Wi,c("div",zi,[u(z)?(x(),Q("div",Di,h(u(z)),1)):Y("",!0),R(" Balance: "+h(u(ee)(u(A))),1)])])]),k(te,{modelValue:u(e).from.amount,"onUpdate:modelValue":D[0]||(D[0]=J=>u(e).from.amount=J),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",onKeypress:u(ze)},{append:B(()=>[k(ie,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:M},{default:B(()=>[R(" MAX ")]),_:1}),u(e).token?(x(),N(pe,{key:0,options:u(i),token:u(e).token,"swap-token":String(u(e).to.symbol),onHandleSearchToken:u(r),onSetToken:u(n)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):Y("",!0)]),_:1},8,["modelValue","onKeypress"])]),Ri,c("div",Ui,[c("div",Fi,[c("div",Ji,[Ki,c("div",Vi," Balance: "+h(u(ee)(u(f))),1)])]),k(te,{modelValue:u(e).to.amount,"onUpdate:modelValue":D[1]||(D[1]=J=>u(e).to.amount=J),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Je({_:2},[u(e).to?.symbol?{name:"append",fn:B(()=>[c("div",Ci,[c("img",{src:u(ne)(u(e).to?.image)},null,8,Ei),R(),c("span",null,h(u(e).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue"])])]),c("div",Li,[c("dl",Qi,[Zi,c("dd",null,h(u(v))+" "+h(u(d)),1)]),c("dl",null,[Ni,c("dd",null,h(u(o))+" "+h(u(l)),1)]),c("dl",null,[$i,u(s)?(x(),Q("dd",Hi,h(u(s))+":1 ",1)):(x(),Q("dd",qi," - "))]),c("dl",null,[ji,c("dd",null,h(u(m))+" SOL",1)])]),k(ye,{class:"q-mt-md q-mx-auto"}),c("div",Oi,[k(ie,{loading:u(e).converting,rounded:"",ripple:!1,disable:!u(y)?.publicKey||!u(e).from.amount||u(e).from.amount<=0||!!u(z)||!u(b),onClick:W},{default:B(()=>[R(" Unlock token ")]),_:1},8,["loading","disable"])]),c("div",Gi,[c("div",Xi," 1 "+h(u(d))+" = "+h(1/u(s))+" "+h(u(l)),1)])]),_:1}),k(Ke,{showing:u(e)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),en={class:"swap-form"},tn={class:"swap-field"},nn={class:"swap-field__info"},rn={class:"row items-end"},sn=c("div",{class:"col swap-field__label"}," FROM: ",-1),an={class:"col-8 col-xs-10 row justify-end swap-field__balance"},on={key:0,class:"insufficient-error"},un=c("div",{class:"swap-change"},null,-1),cn={class:"swap-field"},ln={class:"swap-field__info"},mn={class:"row"},dn=c("div",{class:"col swap-field__label"}," TO: ",-1),fn={class:"col swap-field__balance"},pn={class:"convert-to"},yn=["src"],gn={class:"swap-info q-mt-md q-pt-xs"},hn={class:"text-weight-medium"},kn=c("dt",null,"Received",-1),bn=c("dt",null,"Locked amount",-1),Sn=c("dt",null,"Ratio",-1),An={key:0},wn={key:1},vn=c("dt",null,"Lock fee",-1),_n={class:"swap-submit q-mt-md"},Pn={class:"row q-mt-md text-center relative-position full-width"},Tn={class:"swap-rate q-mx-auto"},Bn=ke({__name:"LockCard",setup(t){const{state:e}=Ae(),{options:i,setToken:n,handleSearchToken:r,pairRatio:s,pairLockedAmount:o,pairLockFee:m,tokenASymbol:l,tokenBSymbol:d,isHaveCertificate:b,lockUnlockToken:g}=Ve();e.isLock=!0;const y=he(),A=T(()=>e.from.balance),f=T(()=>e.to.balance),v=T(()=>e.to.amount);function M(){e.from.amount=A.value}async function W(){await g()}const z=T(()=>e.from.amount>A.value?"Insufficient funds":!1);return(Ce,D)=>{const pe=De,ye=We;return x(),N(be,{class:"swap-card swap-widget converting-card"},{default:B(()=>[k(Fe,{class:"swap-card__body"},{default:B(()=>[c("div",en,[c("div",tn,[c("div",nn,[c("div",rn,[sn,c("div",an,[u(z)?(x(),Q("div",on,h(u(z)),1)):Y("",!0),R(" Balance: "+h(u(ee)(u(A))),1)])])]),k(te,{modelValue:u(e).from.amount,"onUpdate:modelValue":D[0]||(D[0]=J=>u(e).from.amount=J),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",onKeypress:u(ze)},{append:B(()=>[k(ie,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:M},{default:B(()=>[R(" MAX ")]),_:1}),u(e).token?(x(),N(pe,{key:0,options:u(i),token:u(e).token,"swap-token":String(u(e).to.symbol),onHandleSearchToken:u(r),onSetToken:u(n)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):Y("",!0)]),_:1},8,["modelValue","onKeypress"])]),un,c("div",cn,[c("div",ln,[c("div",mn,[dn,c("div",fn," Balance: "+h(u(ee)(u(f))),1)])]),k(te,{modelValue:u(e).to.amount,"onUpdate:modelValue":D[1]||(D[1]=J=>u(e).to.amount=J),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Je({_:2},[u(e).to?.symbol?{name:"append",fn:B(()=>[c("div",pn,[c("img",{src:u(ne)(u(e).to?.image)},null,8,yn),R(),c("span",null,h(u(e).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue"])])]),c("div",gn,[c("dl",hn,[kn,c("dd",null,h(u(v))+" "+h(u(d)),1)]),c("dl",null,[bn,c("dd",null,h(u(o))+" "+h(u(l)),1)]),c("dl",null,[Sn,u(s)?(x(),Q("dd",An," 1:"+h(u(s)),1)):(x(),Q("dd",wn," - "))]),c("dl",null,[vn,c("dd",null,h(u(m))+" SOL",1)])]),k(ye,{class:"q-mt-md q-mx-auto"}),c("div",_n,[k(ie,{loading:u(e).converting,rounded:"",ripple:!1,disable:!u(y)?.publicKey||!u(e).from.amount||u(e).from.amount<=0||!!u(z)||!u(b),onClick:W},{default:B(()=>[R(" Lock token ")]),_:1},8,["loading","disable"])]),c("div",Pn,[c("div",Tn," 1 "+h(u(l))+" = "+h(u(s))+" "+h(u(d)),1)])]),_:1}),k(Ke,{showing:u(e)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),In=ke({__name:"ConverterCard",setup(t){const e=ct("lock");return(i,n)=>{const r=Bn,s=Yi;return x(),N(be,{class:"liquidity-tabs swap-card swap-widget"},{default:B(()=>[k(mt,{modelValue:u(e),"onUpdate:modelValue":n[0]||(n[0]=o=>Pe(e)?e.value=o:null),align:"justify","indicator-color":"transparent",class:lt(i.$q.dark.isActive?"bg-blue-grey-9":"bg-grey-3"),"active-color":"white","active-bg-color":"primary"},{default:B(()=>[k(_e,{ripple:!1,label:"LOCK",name:"lock"}),k(_e,{ripple:!1,label:"UNLOCK",name:"unlock"})]),_:1},8,["modelValue","class"]),k(dt,{modelValue:u(e),"onUpdate:modelValue":n[1]||(n[1]=o=>Pe(e)?e.value=o:null),animated:"",class:"bg-transparent"},{default:B(()=>[k(Te,{name:"lock"},{default:B(()=>[k(r)]),_:1}),k(Te,{name:"unlock"},{default:B(()=>[k(s)]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Mn={},xn={class:"main-block row justify-center"};function Wn(t,e){const i=Qe,n=In,r=Ze,s=Ne;return x(),Q(pt,null,[k(i,{class:"q-mt-lg"}),c("div",xn,[k(n)]),k(r,{class:"q-mt-lg"}),k(s,{class:"q-mt-lg"})],64)}const Jn=ft(Mn,[["render",Wn]]);export{Jn as default};
