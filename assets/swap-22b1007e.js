import{Q as O,o as co,_ as lo,a as uo,b as po}from"./AppDescriptionTop-2760284b.js";import{k as l,ae as P,P as S,m as V,af as Xe,S as mo,V as v,n as wo,q as ko,s as fo,t as go,u as L,v as $,w as ho,x as Re,B as Ue,z as F,M as Ge,J as Ye,G as j,H as R,ag as J,ah as He,ai as So,aj as yo,ak as To,al as Ao,am as bo,an as vo,C as qe,F as eo,A as oo,ao as Bo,ap as je,aq as Ke,X as to,o as ce,Z as Co,$ as _,a0 as Oe,j as f,a1 as q,a2 as Z,a4 as i,a3 as w,a8 as X,ar as Fo,as as Eo,at as Mo,au as Je,av as _o,aw as Do,ax as Io,ay as Wo,az as No,aA as re,aB as ae,aC as xo,U as Po,L as Ze,Y as Ko,W as ie,i as Ve,aD as Oo,ad as no,a6 as E,a5 as Vo,a7 as Y,aE as zo,a9 as Ro,aF as Uo,_ as Yo}from"./index-29f35ee8.js";var qo=Object.defineProperty,Lo=(o,e,t)=>e in o?qo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,s=(o,e,t)=>(Lo(o,typeof e!="symbol"?e+"":e,t),t);const ro=new l.BeetArgsStruct([["tradeFeeNumerator",l.u64],["tradeFeeDenominator",l.u64],["ownerTradeFeeNumerator",l.u64],["ownerTradeFeeDenominator",l.u64],["ownerWithdrawFeeNumerator",l.u64],["ownerWithdrawFeeDenominator",l.u64],["hostFeeNumerator",l.u64],["hostFeeDenominator",l.u64]],"FeesInfo"),ao=new l.BeetArgsStruct([["curveType",l.u8],["curveParameters",l.uniformFixedSizeArray(l.u8,32)]],"CurveInfo"),ze=[135,144,215,161,140,125,41,96];class x{constructor(e,t,a,n,u,B,c,p,C,d,y,m){this.isInitialized=e,this.bumpSeed=t,this.tokenProgramId=a,this.tokenA=n,this.tokenB=u,this.poolMint=B,this.tokenAMint=c,this.tokenBMint=p,this.poolFeeAccount=C,this.fees=d,this.curve=y,this.policy=m}static fromArgs(e){return new x(e.isInitialized,e.bumpSeed,e.tokenProgramId,e.tokenA,e.tokenB,e.poolMint,e.tokenAMint,e.tokenBMint,e.poolFeeAccount,e.fees,e.curve,e.policy)}static fromAccountInfo(e,t=0){return x.deserialize(e.data,t)}static async fromAccountAddress(e,t,a){const n=await e.getAccountInfo(t,a);if(n==null)throw new Error(`Unable to find TokenSwap account at ${t}`);return x.fromAccountInfo(n,0)[0]}static gpaBuilder(e=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){return P.GpaBuilder.fromStruct(e,se)}static deserialize(e,t=0){return se.deserialize(e,t)}serialize(){return se.serialize({accountDiscriminator:ze,...this})}static byteSize(e){const t=x.fromArgs(e);return se.toFixedFromValue({accountDiscriminator:ze,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,a){return t.getMinimumBalanceForRentExemption(x.byteSize(e),a)}pretty(){return{isInitialized:this.isInitialized,bumpSeed:this.bumpSeed,tokenProgramId:this.tokenProgramId.toBase58(),tokenA:this.tokenA.toBase58(),tokenB:this.tokenB.toBase58(),poolMint:this.poolMint.toBase58(),tokenAMint:this.tokenAMint.toBase58(),tokenBMint:this.tokenBMint.toBase58(),poolFeeAccount:this.poolFeeAccount.toBase58(),fees:this.fees,curve:this.curve,policy:this.policy}}}const se=new l.FixableBeetStruct([["accountDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["isInitialized",l.bool],["bumpSeed",l.u8],["tokenProgramId",P.publicKey],["tokenA",P.publicKey],["tokenB",P.publicKey],["poolMint",P.publicKey],["tokenAMint",P.publicKey],["tokenBMint",P.publicKey],["poolFeeAccount",P.publicKey],["fees",ro],["curve",ao],["policy",l.coption(P.publicKey)]],x.fromArgs,"TokenSwap"),g=new Map,h=new Map;class le extends Error{constructor(){super("Swap account already in use"),s(this,"code",6e3),s(this,"name","AlreadyInUse"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,le)}}g.set(6e3,()=>new le);h.set("AlreadyInUse",()=>new le);class ue extends Error{constructor(){super("Invalid program address generated from bump seed and key"),s(this,"code",6001),s(this,"name","InvalidProgramAddress"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ue)}}g.set(6001,()=>new ue);h.set("InvalidProgramAddress",()=>new ue);class pe extends Error{constructor(){super("Input account owner is not the program address"),s(this,"code",6002),s(this,"name","InvalidOwner"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,pe)}}g.set(6002,()=>new pe);h.set("InvalidOwner",()=>new pe);class de extends Error{constructor(){super("Output pool account owner cannot be the program address"),s(this,"code",6003),s(this,"name","InvalidOutputOwner"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,de)}}g.set(6003,()=>new de);h.set("InvalidOutputOwner",()=>new de);class me extends Error{constructor(){super("Deserialized account is not an SPL Token mint"),s(this,"code",6004),s(this,"name","ExpectedMint"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,me)}}g.set(6004,()=>new me);h.set("ExpectedMint",()=>new me);class we extends Error{constructor(){super("Deserialized account is not an SPL Token account"),s(this,"code",6005),s(this,"name","ExpectedAccount"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,we)}}g.set(6005,()=>new we);h.set("ExpectedAccount",()=>new we);class ke extends Error{constructor(){super("Input token account empty"),s(this,"code",6006),s(this,"name","EmptySupply"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ke)}}g.set(6006,()=>new ke);h.set("EmptySupply",()=>new ke);class fe extends Error{constructor(){super("Pool token mint has a non-zero supply"),s(this,"code",6007),s(this,"name","InvalidSupply"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,fe)}}g.set(6007,()=>new fe);h.set("InvalidSupply",()=>new fe);class ge extends Error{constructor(){super("Token account has a delegate"),s(this,"code",6008),s(this,"name","InvalidDelegate"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ge)}}g.set(6008,()=>new ge);h.set("InvalidDelegate",()=>new ge);class he extends Error{constructor(){super("InvalidInput"),s(this,"code",6009),s(this,"name","InvalidInput"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,he)}}g.set(6009,()=>new he);h.set("InvalidInput",()=>new he);class Se extends Error{constructor(){super("Address of the provided swap token account is incorrect"),s(this,"code",6010),s(this,"name","IncorrectSwapAccount"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Se)}}g.set(6010,()=>new Se);h.set("IncorrectSwapAccount",()=>new Se);class ye extends Error{constructor(){super("Address of the provided pool token mint is incorrect"),s(this,"code",6011),s(this,"name","IncorrectPoolMint"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ye)}}g.set(6011,()=>new ye);h.set("IncorrectPoolMint",()=>new ye);class Te extends Error{constructor(){super("InvalidOutput"),s(this,"code",6012),s(this,"name","InvalidOutput"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Te)}}g.set(6012,()=>new Te);h.set("InvalidOutput",()=>new Te);class Ae extends Error{constructor(){super("General calculation failure due to overflow or underflow"),s(this,"code",6013),s(this,"name","CalculationFailure"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ae)}}g.set(6013,()=>new Ae);h.set("CalculationFailure",()=>new Ae);class be extends Error{constructor(){super("Invalid instruction"),s(this,"code",6014),s(this,"name","InvalidInstruction"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,be)}}g.set(6014,()=>new be);h.set("InvalidInstruction",()=>new be);class ve extends Error{constructor(){super("Swap input token accounts have the same mint"),s(this,"code",6015),s(this,"name","RepeatedMint"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ve)}}g.set(6015,()=>new ve);h.set("RepeatedMint",()=>new ve);class Be extends Error{constructor(){super("Swap instruction exceeds desired slippage limit"),s(this,"code",6016),s(this,"name","ExceededSlippage"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Be)}}g.set(6016,()=>new Be);h.set("ExceededSlippage",()=>new Be);class Ce extends Error{constructor(){super("Token account has a close authority"),s(this,"code",6017),s(this,"name","InvalidCloseAuthority"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ce)}}g.set(6017,()=>new Ce);h.set("InvalidCloseAuthority",()=>new Ce);class Fe extends Error{constructor(){super("Pool token mint has a freeze authority"),s(this,"code",6018),s(this,"name","InvalidFreezeAuthority"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Fe)}}g.set(6018,()=>new Fe);h.set("InvalidFreezeAuthority",()=>new Fe);class Ee extends Error{constructor(){super("Pool fee token account incorrect"),s(this,"code",6019),s(this,"name","IncorrectFeeAccount"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ee)}}g.set(6019,()=>new Ee);h.set("IncorrectFeeAccount",()=>new Ee);class Me extends Error{constructor(){super("Given pool token amount results in zero trading tokens"),s(this,"code",6020),s(this,"name","ZeroTradingTokens"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Me)}}g.set(6020,()=>new Me);h.set("ZeroTradingTokens",()=>new Me);class _e extends Error{constructor(){super("Fee calculation failed due to overflow, underflow, or unexpected 0"),s(this,"code",6021),s(this,"name","FeeCalculationFailure"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,_e)}}g.set(6021,()=>new _e);h.set("FeeCalculationFailure",()=>new _e);class De extends Error{constructor(){super("Conversion to u64/u128 failed with an overflow or underflow"),s(this,"code",6022),s(this,"name","ConversionFailure"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,De)}}g.set(6022,()=>new De);h.set("ConversionFailure",()=>new De);class Ie extends Error{constructor(){super("The provided fee does not match the program owner's constraints"),s(this,"code",6023),s(this,"name","InvalidFee"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ie)}}g.set(6023,()=>new Ie);h.set("InvalidFee",()=>new Ie);class We extends Error{constructor(){super("The provided token program does not match the token program expected by the swap"),s(this,"code",6024),s(this,"name","IncorrectTokenProgramId"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,We)}}g.set(6024,()=>new We);h.set("IncorrectTokenProgramId",()=>new We);class Ne extends Error{constructor(){super("The provided curve type is not supported by the program owner"),s(this,"code",6025),s(this,"name","UnsupportedCurveType"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ne)}}g.set(6025,()=>new Ne);h.set("UnsupportedCurveType",()=>new Ne);class xe extends Error{constructor(){super("The provided curve parameters are invalid"),s(this,"code",6026),s(this,"name","InvalidCurve"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,xe)}}g.set(6026,()=>new xe);h.set("InvalidCurve",()=>new xe);class Pe extends Error{constructor(){super("The operation cannot be performed on the given curve"),s(this,"code",6027),s(this,"name","UnsupportedCurveOperation"),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Pe)}}g.set(6027,()=>new Pe);h.set("UnsupportedCurveOperation",()=>new Pe);const $o=new l.BeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["poolTokenAmount",l.u64],["maximumTokenAAmount",l.u64],["maximumTokenBAmount",l.u64]],"DepositAllTokenTypesInstructionArgs"),Qo=[32,95,69,60,75,79,205,238];function Go(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=$o.serialize({instructionDiscriminator:Qo,...e}),n=[{pubkey:o.tokenSwap,isWritable:!1,isSigner:!1},{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.userTransferAuthority,isWritable:!1,isSigner:!0},{pubkey:o.userTokenA,isWritable:!0,isSigner:!1},{pubkey:o.userTokenB,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenA,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenB,isWritable:!0,isSigner:!1},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.destination,isWritable:!0,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}const Ho=new l.BeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["sourceTokenAmount",l.u64],["minimumPoolTokenAmount",l.u64]],"DepositSingleTokenTypeInstructionArgs"),jo=[175,0,152,41,199,0,148,43];function Jo(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=Ho.serialize({instructionDiscriminator:jo,...e}),n=[{pubkey:o.tokenSwap,isWritable:!1,isSigner:!1},{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.userTransferAuthority,isWritable:!1,isSigner:!0},{pubkey:o.source,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenA,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenB,isWritable:!0,isSigner:!1},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.destination,isWritable:!0,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}const Zo=new l.FixableBeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["feesInput",ro],["curveInput",ao],["policy",l.coption(P.publicKey)]],"InitializeInstructionArgs"),Xo=[175,175,109,31,13,152,155,237];function et(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=Zo.serialize({instructionDiscriminator:Xo,...e}),n=[{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.tokenSwap,isWritable:!0,isSigner:!0},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.tokenA,isWritable:!0,isSigner:!1},{pubkey:o.tokenB,isWritable:!0,isSigner:!1},{pubkey:o.poolFee,isWritable:!0,isSigner:!1},{pubkey:o.destination,isWritable:!0,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}const ot=new l.BeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["amountIn",l.u64],["minimumAmountOut",l.u64]],"SwapInstructionArgs"),tt=[248,198,158,145,225,117,135,200];function nt(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=ot.serialize({instructionDiscriminator:tt,...e}),n=[{pubkey:o.proofRequest??t,isWritable:!1,isSigner:!1},{pubkey:o.tokenSwap,isWritable:!1,isSigner:!1},{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.userTransferAuthority,isWritable:!1,isSigner:!0},{pubkey:o.userSource,isWritable:!0,isSigner:!1},{pubkey:o.userDestination,isWritable:!0,isSigner:!1},{pubkey:o.poolSource,isWritable:!0,isSigner:!1},{pubkey:o.poolDestination,isWritable:!0,isSigner:!1},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.poolFee,isWritable:!0,isSigner:!1},{pubkey:o.hostFeeAccount??t,isWritable:!1,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}const rt=new l.BeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["poolTokenAmount",l.u64],["minimumTokenAAmount",l.u64],["minimumTokenBAmount",l.u64]],"WithdrawAllTokenTypesInstructionArgs"),at=[189,254,156,174,210,9,164,216];function it(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=rt.serialize({instructionDiscriminator:at,...e}),n=[{pubkey:o.tokenSwap,isWritable:!1,isSigner:!1},{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.userTransferAuthority,isWritable:!1,isSigner:!0},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.source,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenA,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenB,isWritable:!0,isSigner:!1},{pubkey:o.destTokenA,isWritable:!0,isSigner:!1},{pubkey:o.destTokenB,isWritable:!0,isSigner:!1},{pubkey:o.poolFee,isWritable:!0,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}const st=new l.BeetArgsStruct([["instructionDiscriminator",l.uniformFixedSizeArray(l.u8,8)],["destinationTokenAmount",l.u64],["maximumPoolTokenAmount",l.u64]],"WithdrawSingleTokenTypeInstructionArgs"),ct=[111,171,21,77,237,181,241,56];function lt(o,e,t=new S("J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea")){const[a]=st.serialize({instructionDiscriminator:ct,...e}),n=[{pubkey:o.tokenSwap,isWritable:!1,isSigner:!1},{pubkey:o.authority,isWritable:!1,isSigner:!1},{pubkey:o.userTransferAuthority,isWritable:!1,isSigner:!0},{pubkey:o.poolMint,isWritable:!0,isSigner:!1},{pubkey:o.source,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenA,isWritable:!0,isSigner:!1},{pubkey:o.swapTokenB,isWritable:!0,isSigner:!1},{pubkey:o.destination,isWritable:!0,isSigner:!1},{pubkey:o.poolFee,isWritable:!0,isSigner:!1},{pubkey:o.tokenProgram??L,isWritable:!1,isSigner:!1}];if(o.anchorRemainingAccounts!=null)for(const u of o.anchorRemainingAccounts)n.push(u);return new $({programId:t,keys:n,data:a})}var Le=(o=>(o[o.ConstantProduct=0]="ConstantProduct",o[o.ConstantPrice=1]="ConstantPrice",o[o.Offset=2]="Offset",o))(Le||{});l.fixedScalarEnum(Le);var io=(o=>(o[o.Floor=0]="Floor",o[o.Ceiling=1]="Ceiling",o))(io||{});l.fixedScalarEnum(io);var so=(o=>(o[o.AtoB=0]="AtoB",o[o.BtoA=1]="BtoA",o))(so||{});l.fixedScalarEnum(so);const ut="J8YCNcS2xDvowMcSzWrDYNguk5y9NWfGStNT4YsiKuea",pt=new S(ut);class dt{constructor(e){s(this,"programId",pt),this.provider=e}get connection(){return this.provider.connection}swapAuthority(e){return S.findProgramAddressSync([e.toBuffer()],this.programId)[0]}async createTokenSwap(e,t){const a=new V,n=e.tokenSwap??Xe.generate(),u=Array.from({length:32}),B=Array.from(e.curveParameters??[]);for(let y=0;y<B.length;y++)u[y]=B[y];const c={curveType:e.curveType,curveParameters:u},p=x.byteSize({bumpSeed:0,curve:c,fees:{tradeFeeNumerator:0,tradeFeeDenominator:0,ownerTradeFeeNumerator:0,ownerTradeFeeDenominator:0,ownerWithdrawFeeNumerator:0,ownerWithdrawFeeDenominator:0,hostFeeNumerator:0,hostFeeDenominator:0},isInitialized:!1,policy:S.default,poolFeeAccount:S.default,poolMint:S.default,tokenA:S.default,tokenAMint:S.default,tokenB:S.default,tokenBMint:S.default,tokenProgramId:S.default}),C=await this.connection.getMinimumBalanceForRentExemption(p);a.add(mo.createAccount({fromPubkey:this.provider.publicKey,newAccountPubkey:n.publicKey,programId:this.programId,lamports:C,space:p})),a.add(et({authority:this.swapAuthority(n.publicKey),tokenSwap:n.publicKey,destination:e.destination,poolMint:e.poolMint,poolFee:e.poolFee,tokenA:e.tokenA,tokenB:e.tokenB},{feesInput:{tradeFeeNumerator:new v(e.fees.tradeFeeNumerator.toString()),tradeFeeDenominator:new v(e.fees.tradeFeeDenominator.toString()),ownerTradeFeeNumerator:new v(e.fees.ownerTradeFeeNumerator.toString()),ownerTradeFeeDenominator:new v(e.fees.ownerTradeFeeDenominator.toString()),ownerWithdrawFeeNumerator:new v(e.fees.ownerWithdrawFeeNumerator.toString()),ownerWithdrawFeeDenominator:new v(e.fees.ownerWithdrawFeeDenominator.toString()),hostFeeNumerator:new v(e.fees.hostFeeNumerator.toString()),hostFeeDenominator:new v(e.fees.hostFeeDenominator.toString())},curveInput:c,policy:e.policy??null}));const d=await this.provider.sendAndConfirm(a,[n],t);return{tokenSwap:n.publicKey,signature:d}}async swap(e,t){const a=new V;try{await wo(this.connection,e.userDestination)}catch(n){(n instanceof ko||n instanceof fo)&&e.receiver&&e.destinationTokenMint&&a.add(go(this.provider.publicKey,e.userDestination,e.receiver,e.destinationTokenMint))}return a.add(nt({authority:this.swapAuthority(e.tokenSwap),userTransferAuthority:this.provider.publicKey,userSource:e.userSource,userDestination:e.userDestination,tokenSwap:e.tokenSwap,poolFee:e.poolFee,poolMint:e.poolMint,poolSource:e.poolSource,poolDestination:e.poolDestination,proofRequest:e.proofRequest,hostFeeAccount:e.hostFeeAccount},{amountIn:new v(e.amountIn.toString()),minimumAmountOut:new v(e.minimumAmountOut.toString())})),this.provider.sendAndConfirm(a,[],t)}async depositAllTokenTypes(e,t){const a=Go({authority:this.swapAuthority(e.tokenSwap),userTransferAuthority:this.provider.publicKey,tokenSwap:e.tokenSwap,poolMint:e.poolMint,destination:e.destination,userTokenA:e.userTokenA,userTokenB:e.userTokenB,swapTokenA:e.swapTokenA,swapTokenB:e.swapTokenB},{poolTokenAmount:new v(e.poolTokenAmount.toString()),maximumTokenAAmount:new v(e.maximumTokenA.toString()),maximumTokenBAmount:new v(e.maximumTokenB.toString())}),n=new V().add(a);return this.provider.sendAndConfirm(n,[],t)}async withdrawAllTokenTypes(e,t){const a=it({authority:this.swapAuthority(e.tokenSwap),userTransferAuthority:this.provider.publicKey,tokenSwap:e.tokenSwap,poolMint:e.poolMint,poolFee:e.poolFee,source:e.source,destTokenA:e.destTokenA,destTokenB:e.destTokenB,swapTokenA:e.swapTokenA,swapTokenB:e.swapTokenB},{poolTokenAmount:new v(e.poolTokenAmount.toString()),minimumTokenAAmount:new v(e.minimumTokenA.toString()),minimumTokenBAmount:new v(e.minimumTokenB.toString())}),n=new V().add(a);return this.provider.sendAndConfirm(n,[],t)}async depositSingleTokenTypeExactAmountIn(e,t){const a=Jo({authority:this.swapAuthority(e.tokenSwap),userTransferAuthority:this.provider.publicKey,tokenSwap:e.tokenSwap,poolMint:e.poolMint,source:e.source,destination:e.destination,swapTokenA:e.swapTokenA,swapTokenB:e.swapTokenB},{sourceTokenAmount:new v(e.sourceTokenAmount.toString()),minimumPoolTokenAmount:new v(e.minimumPoolTokenAmount.toString())}),n=new V().add(a);return this.provider.sendAndConfirm(n,[],t)}async withdrawSingleTokenTypeExactAmountOut(e,t){const a=lt({authority:this.swapAuthority(e.tokenSwap),userTransferAuthority:this.provider.publicKey,tokenSwap:e.tokenSwap,poolMint:e.poolMint,poolFee:e.poolFee,source:e.source,destination:e.destination,swapTokenA:e.swapTokenA,swapTokenB:e.swapTokenB},{destinationTokenAmount:new v(e.destinationTokenAmount.toString()),maximumPoolTokenAmount:new v(e.maximumPoolTokenAmount.toString())}),n=new V().add(a);return this.provider.sendAndConfirm(n,[],t)}async load(e,t){return x.fromAccountAddress(this.provider.connection,new S(e),t)}async loadAll(e={}){const t=x.gpaBuilder().addFilter("accountDiscriminator",ze);return e.noData&&(t.config.dataSlice={offset:0,length:0}),e.tokenProgramId&&t.addFilter("tokenProgramId",new S(e.tokenProgramId)),e.poolMint&&t.addFilter("poolMint",new S(e.poolMint)),e.tokenAMint&&t.addFilter("tokenAMint",new S(e.tokenAMint)),e.tokenBMint&&t.addFilter("tokenBMint",new S(e.tokenBMint)),(await t.run(this.provider.connection)).map(({pubkey:a,account:n})=>({pubkey:a,data:e.noData?null:x.fromAccountInfo(n)[0]}))}}var H=(o=>(o.TOKEN_A="TOKEN_A",o.TOKEN_B="TOKEN_B",o))(H||{});const $e=ho("swap",()=>{const o=Re(),e=Ue(),t=F(()=>new dt(new Ge(o.connection,e.value??{publicKey:S.default},Ge.defaultOptions()))),a=Ye(),n=j({loading:!1,slippageDialog:!1,status:void 0,poolBalance:{TOKEN_A:void 0,TOKEN_B:void 0},userBalance:{TOKEN_A:void 0,TOKEN_B:void 0},poolTokenSupply:0});R(e,async d=>{d?u().then():C()},{immediate:!0}),R(a,async d=>{d&&await c()});async function u(){n.loading=!0;try{a.value=await t.value.load(J),console.log("Token SWAP: ",a.value),await B();const d=await t.value.loadAll();console.log("swaps ================: ",d)}catch(d){console.log(d),a.value=void 0}finally{n.loading=!1}}async function B(){if(console.log("loadPoolTokenAccounts ========= "),!a.value)return;const d=await He(o.connection,t.value.swapAuthority(J));for(const m of d){const k=p(m.mint);k&&(n.poolBalance[k]=m.amount)}const y=await So(o.connection,a.value.poolMint);n.poolTokenSupply=Number(y.supply),console.log("[Pool Balance]",n.poolBalance)}async function c(){if(console.log("loadUserTokenAccounts ========= "),!a.value)return;const d=e.value?.publicKey;if(!d){console.log("Wallet is not connected...");return}const y=await He(o.connection,d,[a.value.tokenAMint,a.value.tokenBMint]),m={TOKEN_A:0,TOKEN_B:0};for(const k of y){const A=p(k.mint);A&&(m[A]=+k.amount)}n.userBalance=m,console.log("[User Balance]",n.userBalance)}function p(d){if(a.value)switch(String(d)){case String(a.value.tokenAMint):return"TOKEN_A";case String(a.value.tokenBMint):return"TOKEN_B"}}function C(){n.loading=!1,n.slippageDialog=!1,n.status=void 0,n.poolBalance={TOKEN_A:void 0,TOKEN_B:void 0},n.userBalance={TOKEN_A:void 0,TOKEN_B:void 0},n.poolTokenSupply=0}return{state:n,tokenSwap:a,loadUserTokenAccounts:c,loadPoolTokenAccounts:B,swapClient:t}});function mt(){const o=Re(),{notify:e}=yo(),t=To(o,"cluster"),a=Ye(!1);async function n(u,{onSuccess:B,onError:c,idx:p,commitment:C=Ao,sendTimeout:d=bo,confirmTimeout:y=vo}={}){p=p??"";let m=e({progress:!0,type:"ongoing",message:p?`Sending transaction "${p}" ...`:"Sending transaction...",timeout:d});const k={label:"Close",color:"white"};a.value=!0;let A="";try{const r=await u;A=String(typeof r=="object"?await r.signature:await u)}catch(r){a.value=!1,m(),String(r?.message).startsWith("User rejected")||e({message:p?`Transaction "${p}" error`:"Transaction error",caption:r?.message,type:"negative",timeout:0,actions:[k]});return}const M={label:"Explore",color:"white",target:"_blank",href:`https://solscan.io/tx/${A}?cluster=${t.value}`,onClick:()=>!1};try{m(),m=e({progress:!0,type:"ongoing",message:p?`Confirming transaction "${p}" ...`:"Confirming transaction...",actions:[M],timeout:y});const r=await o.connection.getLatestBlockhash(),T=await o.connection.confirmTransaction({blockhash:r.blockhash,lastValidBlockHeight:r.lastValidBlockHeight,signature:A},C);if(m(),T.value.err)throw new Error(JSON.stringify(T.value.err));m=e({message:p?`Transaction "${p}" confirmed`:"Transaction confirmed",type:"positive",actions:[M]}),B&&B(A)}catch(r){m(),e({message:p?`Transaction "${p}" error`:"Transaction error",caption:r.message,type:"negative",timeout:0,actions:[M,k]}),c&&c(r),console.error(r)}finally{a.value=!1}}return{monitorTransaction:n,sending:a}}function wt(){const o=$e(),e=Ue(),{publicKey:t}=qe(),a=Re(),{monitorTransaction:n}=mt(),{notify:u}=eo(),B=oo(),c=F(()=>B.requiredPolicy),p=j({tokenA:"7pzAmiDUmASVTCLpLA2Q8bfDZDiiNCwiPsAkLnAQVFhX",tokenB:"CvWaX7hRctkaTDwM1oviAW3zau6iWD4XHmhNzdtBsm4E",policy:"CjnpmL6Svfr3Vhpp1jVWCcNbJRxbyPY5ZQF8QiNXWXtT",hostFee:1,tradeFee:0,ownerTradeFee:0,ownerWithdrawFee:0,creating:!1});async function C(){if(!t.value||!p.tokenA||!p.tokenB)return;const y=new S(p.tokenA),m=new S(p.tokenB),k=Xe.generate();console.log("[create swap] token swap pk = ",k.publicKey.toBase58()),console.log("[create swap] token swap sk = ",k.secretKey.toString());const A=o.swapClient.swapAuthority(k.publicKey);let b=new V;const M=await Bo(a.connection,b,t.value,A,9);console.log("[create swap] poolMint = ",M.toBase58()),b.instructions.length>0&&await n(je(a.connection,e.value,b.instructions),{commitment:"finalized",onSuccess:()=>u({type:"positive",message:`Pool created successfully. ${k.publicKey.toBase58()}`})}),b=new V;const r=await Ke(a.connection,b,M,t.value),T=await Ke(a.connection,b,y,A,t.value,!0),D=await Ke(a.connection,b,m,A,t.value,!0);console.log("[create swap] poolFeeAccount = ",r.toBase58()),console.log("[create swap] swapTokenA = ",T.toBase58()),console.log("[create swap] swapTokenB = ",D.toBase58()),b.instructions.length>0&&await n(je(a.connection,e.value,b.instructions),{commitment:"finalized",onSuccess:()=>u({type:"positive",message:`Pool created successfully. ${k.publicKey.toBase58()}`})});const I=await o.swapClient.createTokenSwap({poolMint:M,poolFee:r,destination:r,tokenA:y,tokenB:m,policy:new S(c.value),curveType:Le.ConstantProduct,curveParameters:[],fees:{tradeFeeNumerator:p.tradeFee,tradeFeeDenominator:1e3,ownerTradeFeeNumerator:p.ownerTradeFee,ownerTradeFeeDenominator:1e3,ownerWithdrawFeeNumerator:p.ownerWithdrawFee,ownerWithdrawFeeDenominator:1e3,hostFeeNumerator:p.hostFee,hostFeeDenominator:1e3}});console.log("[create swap] tokenSwap result = ",I)}function d(){p.hostFee=0,p.tradeFee=0,p.ownerTradeFee=0,p.ownerWithdrawFee=0,p.policy="",p.tokenA="",p.tokenB=""}return{state:p,reset:d,createTokenSwap:C}}const kt={class:"q-mt-lg row"},ft=to({__name:"CreateSwapCard",setup(o){const{state:e,createTokenSwap:t}=wt();return(a,n)=>(ce(),Co(Oe,{class:"swap-card swap-widget"},{default:_(()=>[f(Z,{class:"swap-card__header"},{default:_(()=>[q(" Create Swap ")]),_:1}),f(Z,{class:"swap-card__body"},{default:_(()=>[f(O,{modelValue:i(e).tokenA,"onUpdate:modelValue":n[0]||(n[0]=u=>i(e).tokenA=u),label:"Token A"},null,8,["modelValue"]),f(O,{modelValue:i(e).tokenB,"onUpdate:modelValue":n[1]||(n[1]=u=>i(e).tokenB=u),label:"Token B"},null,8,["modelValue"]),f(O,{modelValue:i(e).policy,"onUpdate:modelValue":n[2]||(n[2]=u=>i(e).policy=u),label:"Policy"},null,8,["modelValue"]),f(O,{modelValue:i(e).hostFee,"onUpdate:modelValue":n[3]||(n[3]=u=>i(e).hostFee=u),label:"Host fee, ‰"},null,8,["modelValue"]),f(O,{modelValue:i(e).tradeFee,"onUpdate:modelValue":n[4]||(n[4]=u=>i(e).tradeFee=u),label:"Trade fee, ‰"},null,8,["modelValue"]),f(O,{modelValue:i(e).ownerTradeFee,"onUpdate:modelValue":n[5]||(n[5]=u=>i(e).ownerTradeFee=u),label:"Owner trade fee, ‰"},null,8,["modelValue"]),f(O,{modelValue:i(e).ownerWithdrawFee,"onUpdate:modelValue":n[6]||(n[6]=u=>i(e).ownerWithdrawFee=u),label:"Owner withdraw fee, ‰"},null,8,["modelValue"]),w("div",kt,[f(X,{class:"q-ml-auto",onClick:i(t)},{default:_(()=>[q(" Create Swap ")]),_:1},8,["onClick"])])]),_:1})]),_:1}))}}),gt=Fo({name:"QBtnToggle",props:{...Eo,modelValue:{required:!0},options:{type:Array,required:!0,validator:o=>o.every(e=>("label"in e||"icon"in e||"slot"in e)&&"value"in e)},color:String,textColor:String,toggleColor:{type:String,default:"primary"},toggleTextColor:String,outline:Boolean,flat:Boolean,unelevated:Boolean,rounded:Boolean,push:Boolean,glossy:Boolean,size:String,padding:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,readonly:Boolean,disable:Boolean,stack:Boolean,stretch:Boolean,spread:Boolean,clearable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","clear","click"],setup(o,{slots:e,emit:t}){const a=F(()=>o.options.find(m=>m.value===o.modelValue)!==void 0),n=F(()=>({type:"hidden",name:o.name,value:o.modelValue})),u=Io(n),B=F(()=>Mo(o)),c=F(()=>({rounded:o.rounded,dense:o.dense,...B.value})),p=F(()=>o.options.map((m,k)=>{const{attrs:A,value:b,slot:M,...r}=m;return{slot:M,props:{key:k,"aria-pressed":b===o.modelValue?"true":"false",...A,...r,...c.value,disable:o.disable===!0||r.disable===!0,color:b===o.modelValue?d(r,"toggleColor"):d(r,"color"),textColor:b===o.modelValue?d(r,"toggleTextColor"):d(r,"textColor"),noCaps:d(r,"noCaps")===!0,noWrap:d(r,"noWrap")===!0,size:d(r,"size"),padding:d(r,"padding"),ripple:d(r,"ripple"),stack:d(r,"stack")===!0,stretch:d(r,"stretch")===!0,onClick(T){C(b,m,T)}}}}));function C(m,k,A){o.readonly!==!0&&(o.modelValue===m?o.clearable===!0&&(t("update:modelValue",null,null),t("clear")):t("update:modelValue",m,k),t("click",A))}function d(m,k){return m[k]===void 0?o[k]:m[k]}function y(){const m=p.value.map(k=>Je(X,k.props,k.slot!==void 0?e[k.slot]:void 0));return o.name!==void 0&&o.disable!==!0&&a.value===!0&&u(m,"push"),Do(e.default,m)}return()=>Je(_o,{class:"q-btn-toggle",...B.value,rounded:o.rounded,stretch:o.stretch,glossy:o.glossy,spread:o.spread},y)}}),ht=`<svg width="67" height="67" viewBox="0 0 67 67" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="33.5" cy="33.5" r="33.5" fill="#23353D"/>
<path d="M20.1164 28.7648C20.9418 26.6177 22.5532 24.83 24.2297 23.3017C25.8591 21.8172 27.7401 20.6021 29.8029 19.8138C30.9966 19.3579 32.2408 19.0323 33.5041 18.8402C33.667 18.8155 33.8365 18.7998 34.0095 18.7875C33.7197 19.0592 33.4401 19.34 33.1684 19.6229C32.6799 20.1305 32.2285 20.6684 31.8163 21.24C31.4244 21.7835 31.0191 22.3719 31.1123 23.0176C31.092 23.6959 31.8231 24.2596 32.4104 23.743C32.4182 23.7396 32.425 23.7363 32.434 23.7329C32.5575 23.6925 32.6642 23.624 32.7551 23.5274C32.8742 23.4084 32.9662 23.2467 33.0617 23.1086C33.2481 22.8379 33.4165 22.5561 33.6029 22.2854C33.9567 21.7723 34.3486 21.2871 34.7607 20.82C35.5221 19.9565 36.3755 19.1783 37.0324 18.2372C37.12 18.1788 37.2031 18.1137 37.2828 18.0396C37.558 17.7836 37.5355 17.3232 37.2828 17.0649C36.7652 16.5348 36.0409 16.4035 35.2941 16.4181C35.2368 16.4113 35.1807 16.4046 35.1245 16.3978C34.4126 16.3125 33.6939 16.2788 32.9775 16.2496C32.252 16.2204 31.5311 16.1721 30.8079 16.1093C30.4823 16.0812 30.1578 16.0408 29.8321 16.0093C29.4773 15.9756 29.1494 16.0441 28.7968 16.0452C27.9501 16.0475 27.6019 17.2356 28.3599 17.6589C28.4868 17.7297 28.6059 17.8015 28.726 17.87C26.8091 18.6673 25.045 19.7802 23.4594 21.1322C21.5235 22.7795 19.6931 24.7851 18.6263 27.1152C17.5673 29.4285 17.0586 32.1089 17.0036 34.6445C16.9733 36.0381 17.1372 37.4418 17.3686 38.814C17.628 40.3536 18.0232 41.9392 18.8048 43.3047C18.9643 43.5832 19.3842 43.4518 19.3932 43.1452C19.4314 41.81 19.1911 40.4794 19.0406 39.1565C18.9104 38.0078 18.8194 36.8601 18.8385 35.7035C18.8767 33.3453 19.2675 30.9748 20.1164 28.7648Z" fill="white"/>
<path d="M41.8667 21.8756C43.3344 21.9598 44.637 20.7953 44.9615 19.4197C45.1356 18.6786 44.9896 17.8947 44.491 17.3018C43.879 16.5719 42.9178 16.3979 42.0059 16.4888C41.2041 16.5697 40.3945 16.81 39.9554 17.5399C39.7398 17.8992 39.6747 18.4147 39.7679 18.874C39.5175 20.2125 40.4102 21.7925 41.8667 21.8756ZM42.0845 18.5214C42.3091 18.4877 42.7942 18.4023 42.9896 18.5775C43.0491 18.6303 43.0896 18.7729 43.103 18.8369C43.0907 18.8156 43.075 19.0222 43.0626 19.0705C42.9458 19.5129 42.5247 20.0508 42.0014 20.0384C41.5601 20.0283 41.3692 19.5668 41.2558 19.1255C41.3187 19.0222 41.3793 18.9211 41.4501 18.8335C41.6185 18.6247 41.7398 18.573 42.0845 18.5214Z" fill="white"/>
<path d="M24.7688 44.8016C24.3477 44.5444 23.7952 44.3266 23.2921 44.3254C22.7857 44.3243 22.0557 44.5545 21.7829 45.0205C21.7582 45.0632 21.738 45.107 21.7211 45.1508C20.752 45.3945 20.277 46.4501 20.2579 47.3922C20.2388 48.3995 20.7093 49.3742 21.5515 49.9357C23.4437 51.1967 26.1882 49.6516 26.2814 47.4405C26.3285 46.3613 25.6694 45.3529 24.7688 44.8016ZM24.0411 47.6538C23.7312 48.2086 22.9058 48.4612 22.5599 48.048C22.1299 47.5337 22.213 46.8902 22.4263 46.2693C22.7284 46.3378 23.0641 46.349 23.3438 46.4388C23.949 46.6331 24.3117 47.1676 24.0411 47.6538Z" fill="white"/>
<path d="M49.4881 28.0079C49.3275 27.2151 49.1478 26.4212 48.9154 25.6453C48.6717 24.8334 48.382 24.1203 48.0114 23.3634C47.7397 22.8087 46.7694 23.0603 46.8245 23.6846C46.8829 24.3449 46.9413 24.967 47.0648 25.6228C47.1973 26.3269 47.3332 27.031 47.4522 27.7362C47.6577 28.9501 47.8003 30.182 47.8508 31.4127C47.9519 33.8809 47.6386 36.4008 46.6235 38.6714C44.8874 42.5545 41.4231 45.5831 37.5838 47.3023C35.7017 48.1445 33.6669 48.6083 31.6131 48.6521C31.9174 48.3893 32.2116 48.1165 32.498 47.8402C33.3188 47.0486 34.3486 46.0042 34.4305 44.8015C34.4485 44.5332 34.1386 44.2962 33.8837 44.3849C32.8214 44.7589 32.0308 45.8268 31.2627 46.605C30.4205 47.4584 29.4829 48.2119 28.6373 49.0586C28.5351 49.1608 28.4756 49.272 28.4486 49.3831C28.1791 49.5774 28.0343 49.9278 28.2701 50.2501C29.265 51.6144 30.7698 52.4218 32.4227 52.7295C33.2447 52.8822 34.0993 52.9586 34.9314 52.8463C35.6018 52.7553 36.7382 52.3825 36.901 51.6133C36.9347 51.4527 36.9089 51.2674 36.7797 51.1529C36.3272 50.7509 35.5355 50.7981 34.9639 50.8127C34.2879 50.8295 33.6321 50.8958 32.9572 50.7913C32.8663 50.7767 32.7753 50.761 32.6844 50.743C36.8089 50.4252 40.7516 48.5555 43.8801 45.8638C47.7734 42.5152 50.054 37.7382 49.999 32.5794C49.9822 31.0433 49.7935 29.5104 49.4881 28.0079Z" fill="white"/>
</svg>
`;function St(){const o=oo(),e=$e(),t=Ue(),{publicKey:a}=qe(),{notify:n}=eo(),u=j({image:Wo,symbol:H.TOKEN_A,name:H.TOKEN_A}),B=j({image:No,symbol:H.TOKEN_B,name:H.TOKEN_B}),c=j({from:u,to:B,swapping:!1,active:!1,slippage:.01,rate:0,impact:0,fees:{host:0,trade:0,ownerTrade:0,ownerWithdraw:0},direction:0});R([()=>c.from.amount,()=>e.state.poolBalance],async()=>{const r=re(c.from.amount??0),T=Number(e.state.poolBalance[c.from.name]??0),D=Number(e.state.poolBalance[c.to.name]??0);if(r===0||Number.isNaN(r)){c.to.amount=0,c.rate=D/T,c.impact=0;return}console.log(c.fees);const I=D-T*D/(T+r);c.rate=r?I/r:D/T,c.to.amount=xo(I?I*(1-c.fees.ownerTrade-c.fees.trade):0),c.impact=r?1-I/r/(D/T):0},{immediate:!0});const C=F(()=>{const r=Number(re(c.to.amount??0));return Math.floor(r-r*c.slippage)});async function d(){const r=e.tokenSwap;if(!o.certificateValid)return Po();if(!r||!a.value){console.log("TokenSwap is not initialized...");return}t.value.publicKey||n({type:"info",message:"Please connect your wallet first"});const D=Number(re(c.from.amount??0)),I=Number(e.state.userBalance[c.from.name]??0),Q=Number(re(c.to.amount??0));if(D>I){n({type:"negative",message:"Insufficient balance."});return}try{c.swapping=!0;const{userSourceMint:z,userDestinationMint:ee,poolSourceAddress:oe,poolDestinationAddress:te}=y(),G=await Ze(z,t.value.publicKey),ne=await Ze(ee,t.value.publicKey),U=D;console.log("toAmount = ",Q),console.log("slippage = ",c.slippage),console.log("slippage 2 = ",Q*c.slippage);const N=e.swapClient.swapAuthority(J);console.log("proofRequest = ",o.certificate?.pubkey.toBase58()),console.log("swapAuthority = ",N),console.log("tokenSwap = ",J.toBase58()),console.log("userSource = ",G.toBase58()),console.log("userDestination = ",ne.toBase58()),console.log("poolSource = ",oe.toBase58()),console.log("poolDestination = ",te.toBase58()),console.log("poolMint = ",r.poolMint.toBase58()),console.log("poolFee = ",r.poolFeeAccount.toBase58()),console.log("amountIn = ",U),console.log("minimumAmountOut = ",C.value),await e.swapClient.swap({proofRequest:o.certificate?.pubkey,authority:N,tokenSwap:J,userSource:G,userDestination:ne,poolSource:oe,poolDestination:te,poolMint:r.poolMint,poolFee:r.poolFeeAccount,amountIn:U,minimumAmountOut:C.value,receiver:a.value,destinationTokenMint:ee},{commitment:"confirmed"}),M()}catch(z){console.log(z)}finally{c.swapping=!1}}function y(){const r=e.tokenSwap,T=c.direction;return{userSourceMint:T===0?r.tokenAMint:r.tokenBMint,userDestinationMint:T===0?r.tokenBMint:r.tokenAMint,poolSourceAddress:T===0?r.tokenA:r.tokenB,poolDestinationAddress:T===0?r.tokenB:r.tokenA}}function m(){const{from:r,to:T}=c;c.rate=0,c.to={...r,amount:void 0},c.from={...T,amount:void 0},c.direction=c.direction===0?1:0}function k(){e.state.slippageDialog=!0}function A(){e.state.slippageDialog=!1}function b(r){c.from.amount=r}function M(){e.loadUserTokenAccounts(),e.loadPoolTokenAccounts(),c.from.amount=void 0,c.to.amount=void 0}return R(()=>t.value?.publicKey,r=>{r||M()}),R(()=>c.to,r=>{r.amount&&(r.amount=void 0)}),R(()=>e.tokenSwap,r=>{r&&(c.fees.host=ae(r.fees.hostFeeNumerator,r.fees.hostFeeDenominator),c.fees.ownerTrade=ae(r.fees.ownerTradeFeeNumerator,r.fees.ownerTradeFeeDenominator),c.fees.ownerWithdraw=ae(r.fees.ownerWithdrawFeeNumerator,r.fees.ownerWithdrawFeeDenominator),c.fees.trade=ae(r.fees.tradeFeeNumerator,r.fees.tradeFeeDenominator))}),{state:c,tokenSwap:e.tokenSwap,swapState:e.state,minimumReceived:C,setMax:b,closeSlippage:A,openSlippage:k,changeDirection:m,swapSubmit:d}}const yt={class:"swap-form"},Tt={class:"swap-field"},At={class:"swap-field__info"},bt={class:"row items-end"},vt=w("div",{class:"col swap-field__label"}," FROM: ",-1),Bt={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Ct={key:0,class:"insufficient-error"},Ft={class:"swap-change"},Et=["innerHTML"],Mt={class:"swap-field"},_t={class:"swap-field__info"},Dt={class:"row"},It=w("div",{class:"col swap-field__label"}," TO: ",-1),Wt={class:"col swap-field__balance"},Nt={class:"swap-info"},xt=w("dt",null,"Minimum Received::",-1),Pt=w("dt",null,"Slippage Tolerance:",-1),Kt=w("dt",null,"Swap fee:",-1),Ot={class:"swap-submit"},Vt={class:"swap-rate q-mt-md"},zt={class:"swap-rate"},Rt=w("div",{class:"q-mt-lg"}," DEBUG: ",-1),Ut=to({__name:"SwapCard",setup(o){const{state:e,swapState:t,minimumReceived:a,changeDirection:n,openSlippage:u,closeSlippage:B,setMax:c,swapSubmit:p}=St(),{handleSearchToken:C,tokens:d}=Ko(),y=$e(),m=F(()=>y.state.poolBalance.TOKEN_A/ie),k=F(()=>y.state.poolBalance.TOKEN_B/ie),{connected:A}=qe(),b=F(()=>[...d.value].splice(-2));function M(N){return t.userBalance[N]/ie}const r=N=>Uo.format(N),T=Ye(0),D=F(()=>`transform: rotate(${T.value*180}deg)`),I=F(()=>e.from.name),Q=F(()=>e.to.name),z=F(()=>M(I.value)),ee=F(()=>M(Q.value)),oe=F(()=>e.fees.ownerTrade+e.fees.trade);function te(){n(),T.value++}function G(N,W){e[W?"to":"from"]=N}function ne(){c(z.value)}const U=F(()=>Number(e.from.amount)>z.value?"Insufficient funds":!1);return R(()=>e.from.amount,N=>{e.active=Number(N)>=1&&!U.value,console.log(y.state)}),(N,W)=>{const Qe=lo;return ce(),Ve(no,null,[f(Oe,{class:"swap-card swap-widget"},{default:_(()=>[f(Z,{class:"swap-card__header"},{default:_(()=>[q(" Swap ")]),_:1}),f(Z,{class:"swap-card__body"},{default:_(()=>[w("div",yt,[w("div",Tt,[w("div",At,[w("div",bt,[vt,w("div",Bt,[i(U)?(ce(),Ve("div",Ct,E(i(U)),1)):Vo("",!0),q(" Balance: "+E(i(Y)(i(z)))+" "+E(i(I)),1)])])]),f(O,{modelValue:i(e).from.amount,"onUpdate:modelValue":W[0]||(W[0]=K=>i(e).from.amount=K),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",disable:!i(A),onKeypress:i(co)},{append:_(()=>[f(X,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:ne},{default:_(()=>[q(" MAX ")]),_:1}),f(Qe,{options:i(b),disable:"",token:i(e).from,"swap-token":String(i(e).to.symbol),onHandleSearchToken:i(C),onSetToken:G},null,8,["options","token","swap-token","onHandleSearchToken"])]),_:1},8,["modelValue","disable","onKeypress"])]),w("div",Ft,[f(X,{ripple:!1,dense:"",unelevated:"",style:zo(i(D)),onClick:te},{default:_(()=>[w("i",{innerHTML:i(ht)},null,8,Et)]),_:1},8,["style"])]),w("div",Mt,[w("div",_t,[w("div",Dt,[It,w("div",Wt," Balance: "+E(i(Y)(i(ee)))+" "+E(i(Q)),1)])]),f(O,{modelValue:i(e).to.amount,"onUpdate:modelValue":W[1]||(W[1]=K=>i(e).to.amount=K),disable:!i(A),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},{append:_(()=>[f(Qe,{"swap-token":String(i(e).from.symbol),disable:"",options:i(b),direction:!0,token:i(e).to,onHandleSearchToken:i(C),onSetToken:G},null,8,["swap-token","options","token","onHandleSearchToken"])]),_:1},8,["modelValue","disable"])])]),w("div",Nt,[w("dl",null,[xt,w("dd",null,E(i(Y)(i(a)/i(ie)))+" "+E(i(I).toUpperCase()),1)]),w("dl",null,[Pt,w("dd",null,[w("a",{href:"#",onClick:W[2]||(W[2]=(...K)=>i(u)&&i(u)(...K))},E(r(i(e).slippage)),1)])]),w("dl",null,[Kt,w("dd",null,E(r(i(oe)))+" SOL",1)])]),w("div",Ot,[f(X,{loading:i(e).swapping,rounded:"",ripple:!1,onClick:i(p)},{default:_(()=>[q(" Swap "+E(i(e).from.name)+" / "+E(i(e).to.name),1)]),_:1},8,["loading","onClick"])]),w("div",Vt," 1 "+E(i(e).from.name)+" ≈ "+E(i(Y)(i(e).rate))+" "+E(i(e).to.name),1),w("div",zt," Price impact: "+E(r(i(e).impact)),1),Rt,w("div",null," Pool Token_A balance: "+E(i(Y)(i(m))),1),w("div",null," Pool Token_B balance: "+E(i(Y)(i(k))),1)]),_:1}),f(Ro,{showing:i(t)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1}),f(Oo,{modelValue:i(t).slippageDialog,"onUpdate:modelValue":W[4]||(W[4]=K=>i(t).slippageDialog=K),"transition-duration":"100","transition-show":"fade","transition-hide":"fade"},{default:_(()=>[f(Oe,null,{default:_(()=>[f(Z,null,{default:_(()=>[f(gt,{modelValue:i(e).slippage,"onUpdate:modelValue":[W[3]||(W[3]=K=>i(e).slippage=K),i(B)],spread:"","no-caps":"",unelevated:"",ripple:!1,"toggle-color":"secondary",color:"white","text-color":"dark",options:[{label:"0.1%",value:.001},{label:"0.5%",value:.005},{label:"1%",value:.01},{label:"5%",value:.05}]},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Yt={},qt={class:"main-block row justify-center"};function Lt(o,e){const t=uo,a=Ut,n=ft,u=po;return ce(),Ve(no,null,[f(t,{class:"q-mt-xl"}),w("div",qt,[f(a),f(n,{class:"q-mt-lg"})]),f(u,{class:"q-mt-lg"})],64)}const Gt=Yo(Yt,[["render",Lt]]);export{Gt as default};
