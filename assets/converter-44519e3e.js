var He=Object.defineProperty;var je=(i,e,t)=>e in i?He(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var A=(i,e,t)=>(je(i,typeof e!="symbol"?e+"":e,t),t);import{_ as qe,a as Oe,b as Ge}from"./AppDescriptionTop-8f9fdf69.js";import{_ as Re}from"./PolicyCard.vue_vue_type_script_setup_true_lang-a8a3092d.js";import{o as Ue,_ as Fe}from"./SelectToken.vue_vue_type_script_setup_true_lang-4b560017.js";import{k as a,bc as v,P as g,b6 as B,aQ as x,aR as ee,bi as Xe,K as _e,aY as I,ae as Je,bj as Ye,bk as et,bl as tt,bm as Pe,R as be,J as it,b3 as nt,b4 as st,b5 as rt,a as N,s as at,u as Se,x as Ke,w as Ce,B as ot,v as _,bn as Ee,C as $,bf as ct,a_ as ut,bo as lt,am as dt,z as Ve,U as Te,V as Ae,o as z,Y as te,Z as M,j as k,a1 as Le,a2 as u,a3 as o,i as U,a5 as S,a4 as H,a0 as F,a6 as ie,a7 as ne,a8 as se,bp as Qe,a9 as Ze,$ as we,y as Ne,G as mt,aF as ft,as as Be,aE as pt,aD as Ie,aH as yt,aG as Me,_ as gt,ad as ht}from"./index-3e319056.js";import{c as kt,A as bt}from"./setAuthority-d61ee5de.js";import{b as St,g as At,m as wt}from"./index-6f941dc9.js";import"./internal-446163cd.js";const vt="/assets/unrecognized-token-3289de57.svg";function xe(i,e){if(e)return e[i]?.symbol??""}function re(i){return i??vt}const _t=[244,158,220,65,8,73,4,65];class E{constructor(e,t){this.authority=e,this.isPlatformPaused=t}static fromArgs(e){return new E(e.authority,e.isPlatformPaused)}static fromAccountInfo(e,t=0){return E.deserialize(e.data,t)}static async fromAccountAddress(e,t,n){const s=await e.getAccountInfo(t,n);if(s==null)throw new Error(`Unable to find Admin account at ${t}`);return E.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return v.GpaBuilder.fromStruct(e,q)}static deserialize(e,t=0){return q.deserialize(e,t)}serialize(){return q.serialize({accountDiscriminator:_t,...this})}static get byteSize(){return q.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(E.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===E.byteSize}pretty(){return{authority:this.authority.toBase58(),isPlatformPaused:this.isPlatformPaused}}}const q=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",v.publicKey],["isPlatformPaused",a.bool]],E.fromArgs,"Admin"),Pt=[221,78,171,233,213,142,113,56];class V{constructor(e,t){this.authority=e,this.isAllPaused=t}static fromArgs(e){return new V(e.authority,e.isAllPaused)}static fromAccountInfo(e,t=0){return V.deserialize(e.data,t)}static async fromAccountAddress(e,t,n){const s=await e.getAccountInfo(t,n);if(s==null)throw new Error(`Unable to find Manager account at ${t}`);return V.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return v.GpaBuilder.fromStruct(e,O)}static deserialize(e,t=0){return O.deserialize(e,t)}serialize(){return O.serialize({accountDiscriminator:Pt,...this})}static get byteSize(){return O.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(V.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===V.byteSize}pretty(){return{authority:this.authority.toBase58(),isAllPaused:this.isAllPaused}}}const O=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",v.publicKey],["isAllPaused",a.bool]],V.fromArgs,"Manager"),ve=new a.BeetArgsStruct([["num",a.u64],["denom",a.u64]],"Ratio"),De=[85,72,49,176,182,228,141,82];class L{constructor(e,t,n,s,r,c,l,d,p,m){this.authority=e,this.tokenA=t,this.tokenB=n,this.lockedAmount=s,this.ratio=r,this.isPaused=c,this.lockFee=l,this.unlockFee=d,this.feeReceiver=p,this.policy=m}static fromArgs(e){return new L(e.authority,e.tokenA,e.tokenB,e.lockedAmount,e.ratio,e.isPaused,e.lockFee,e.unlockFee,e.feeReceiver,e.policy)}static fromAccountInfo(e,t=0){return L.deserialize(e.data,t)}static async fromAccountAddress(e,t,n){const s=await e.getAccountInfo(t,n);if(s==null)throw new Error(`Unable to find Pair account at ${t}`);return L.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return v.GpaBuilder.fromStruct(e,G)}static deserialize(e,t=0){return G.deserialize(e,t)}serialize(){return G.serialize({accountDiscriminator:De,...this})}static byteSize(e){const t=L.fromArgs(e);return G.toFixedFromValue({accountDiscriminator:De,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,n){return t.getMinimumBalanceForRentExemption(L.byteSize(e),n)}pretty(){return{authority:this.authority.toBase58(),tokenA:this.tokenA.toBase58(),tokenB:this.tokenB.toBase58(),lockedAmount:(()=>{const e=this.lockedAmount;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),ratio:this.ratio,isPaused:this.isPaused,lockFee:this.lockFee,unlockFee:this.unlockFee,feeReceiver:this.feeReceiver.toBase58(),policy:this.policy}}}const G=new a.FixableBeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",v.publicKey],["tokenA",v.publicKey],["tokenB",v.publicKey],["lockedAmount",a.u64],["ratio",ve],["isPaused",a.bool],["lockFee",a.u16],["unlockFee",a.u16],["feeReceiver",v.publicKey],["policy",a.coption(v.publicKey)]],L.fromArgs,"Pair"),Tt=[159,117,95,227,239,151,58,236];class Q{constructor(e,t){this.authority=e,this.isBlocked=t}static fromArgs(e){return new Q(e.authority,e.isBlocked)}static fromAccountInfo(e,t=0){return Q.deserialize(e.data,t)}static async fromAccountAddress(e,t,n){const s=await e.getAccountInfo(t,n);if(s==null)throw new Error(`Unable to find User account at ${t}`);return Q.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return v.GpaBuilder.fromStruct(e,X)}static deserialize(e,t=0){return X.deserialize(e,t)}serialize(){return X.serialize({accountDiscriminator:Tt,...this})}static get byteSize(){return X.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(Q.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===Q.byteSize}pretty(){return{authority:this.authority.toBase58(),isBlocked:this.isBlocked}}}const X=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["authority",v.publicKey],["isBlocked",a.bool]],Q.fromArgs,"User"),Bt=[17,50,115,0,10,220,15,157];class Z{constructor(e,t){this.user=e,this.pair=t}static fromArgs(e){return new Z(e.user,e.pair)}static fromAccountInfo(e,t=0){return Z.deserialize(e.data,t)}static async fromAccountAddress(e,t,n){const s=await e.getAccountInfo(t,n);if(s==null)throw new Error(`Unable to find WhitelistedUserInfo account at ${t}`);return Z.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){return v.GpaBuilder.fromStruct(e,Y)}static deserialize(e,t=0){return Y.deserialize(e,t)}serialize(){return Y.serialize({accountDiscriminator:Bt,...this})}static get byteSize(){return Y.byteSize}static async getMinimumBalanceForRentExemption(e,t){return e.getMinimumBalanceForRentExemption(Z.byteSize,t)}static hasCorrectByteSize(e,t=0){return e.byteLength-t===Z.byteSize}pretty(){return{user:this.user.toBase58(),pair:this.pair.toBase58()}}}const Y=new a.BeetStruct([["accountDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["user",v.publicKey],["pair",v.publicKey]],Z.fromArgs,"WhitelistedUserInfo"),J=new Map,K=new Map;class ce extends Error{constructor(){super("Unauthorized action");A(this,"code",6e3);A(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ce)}}J.set(6e3,()=>new ce);K.set("Unauthorized",()=>new ce);class ue extends Error{constructor(){super("Paused");A(this,"code",6001);A(this,"name","IsPaused");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ue)}}J.set(6001,()=>new ue);K.set("IsPaused",()=>new ue);class le extends Error{constructor(){super("Already resumed");A(this,"code",6002);A(this,"name","AlreadyResumed");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,le)}}J.set(6002,()=>new le);K.set("AlreadyResumed",()=>new le);class de extends Error{constructor(){super("Pair still have locked tokens");A(this,"code",6003);A(this,"name","StillRemainingLockedTokens");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,de)}}J.set(6003,()=>new de);K.set("StillRemainingLockedTokens",()=>new de);class me extends Error{constructor(){super("User is blocked");A(this,"code",6004);A(this,"name","IsBlocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,me)}}J.set(6004,()=>new me);K.set("IsBlocked",()=>new me);class fe extends Error{constructor(){super("User is already unblocked");A(this,"code",6005);A(this,"name","AlreadyUnblocked");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,fe)}}J.set(6005,()=>new fe);K.set("AlreadyUnblocked",()=>new fe);class pe extends Error{constructor(){super("Insufficient locked amount");A(this,"code",6006);A(this,"name","InsufficientLockedAmount");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,pe)}}J.set(6006,()=>new pe);K.set("InsufficientLockedAmount",()=>new pe);class ye extends Error{constructor(){super("Insufficient funds");A(this,"code",6007);A(this,"name","InsufficientFunds");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ye)}}J.set(6007,()=>new ye);K.set("InsufficientFunds",()=>new ye);const It=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["key",v.publicKey]],"AddManagerInstructionArgs"),Mt=[125,38,192,212,101,91,179,16];function xt(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=It.serialize({instructionDiscriminator:Mt,...e}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const Dt=new a.FixableBeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["policy",a.coption(v.publicKey)],["ratio",ve]],"AddPairInstructionArgs"),Wt=[209,230,17,236,218,162,86,118];function zt(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=Dt.serialize({instructionDiscriminator:Wt,...e}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const Rt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"AddUserToWhitelistInstructionArgs"),Ut=[244,177,124,12,22,50,139,152];function Ft(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Rt.serialize({instructionDiscriminator:Ut}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.userAuthority,isWritable:!1,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const Jt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"BlockUserInstructionArgs"),Kt=[10,164,178,6,231,175,185,191];function Ct(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Jt.serialize({instructionDiscriminator:Kt}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const Et=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"LockTokensInstructionArgs"),Vt=[136,11,32,232,161,117,54,211];function Lt(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=Et.serialize({instructionDiscriminator:Vt,...e}),s=[{pubkey:i.proofRequest??t,isWritable:!1,isSigner:!1},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!1,isSigner:!1},{pubkey:i.userAuthority,isWritable:!0,isSigner:!0},{pubkey:i.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.sourceA,isWritable:!0,isSigner:!1},{pubkey:i.destinationA,isWritable:!0,isSigner:!1},{pubkey:i.destinationB,isWritable:!0,isSigner:!1},{pubkey:i.feePayer,isWritable:!0,isSigner:!0},{pubkey:i.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:i.tokenProgram??ee,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const Qt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"PausePairsInstructionArgs"),Zt=[147,150,152,192,119,95,137,64];function Nt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Qt.serialize({instructionDiscriminator:Zt}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const $t=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"PausePlatformInstructionArgs"),Ht=[232,46,204,130,181,0,172,57];function jt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=$t.serialize({instructionDiscriminator:Ht}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const qt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemoveManagerInstructionArgs"),Ot=[150,55,157,77,128,148,7,15];function Gt(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=qt.serialize({instructionDiscriminator:Ot}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const Xt=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemovePairInstructionArgs"),Yt=[181,42,154,249,167,123,20,81];function ei(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=Xt.serialize({instructionDiscriminator:Yt}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const ti=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"RemoveUserFromWhitelistInstructionArgs"),ii=[198,73,139,218,243,209,180,182];function ni(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=ti.serialize({instructionDiscriminator:ii}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const si=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"ResumePairsInstructionArgs"),ri=[23,106,248,226,173,20,247,74];function ai(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=si.serialize({instructionDiscriminator:ri}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!0,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const oi=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"ResumePlatformInstructionArgs"),ci=[23,162,56,123,186,207,109,131];function ui(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=oi.serialize({instructionDiscriminator:ci}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const li=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["key",v.publicKey]],"SetAdminInstructionArgs"),di=[251,163,0,52,91,194,187,92];function mi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=li.serialize({instructionDiscriminator:di,...e}),s=[{pubkey:i.admin,isWritable:!0,isSigner:!1},{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const fi=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)]],"UnblockUserInstructionArgs"),pi=[216,208,128,98,74,210,18,114];function yi(i,e=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[t]=fi.serialize({instructionDiscriminator:pi}),n=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const r of i.anchorRemainingAccounts)n.push(r);return new x({programId:e,keys:n,data:t})}const gi=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"UnlockTokensInstructionArgs"),hi=[233,35,95,159,37,185,47,88];function ki(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=gi.serialize({instructionDiscriminator:hi,...e}),s=[{pubkey:i.proofRequest??t,isWritable:!1,isSigner:!1},{pubkey:i.user,isWritable:!1,isSigner:!1},{pubkey:i.userAuthority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!1,isSigner:!1},{pubkey:i.whitelistedUserInfo,isWritable:!1,isSigner:!1},{pubkey:i.manager,isWritable:!1,isSigner:!1},{pubkey:i.admin,isWritable:!1,isSigner:!1},{pubkey:i.tokenA,isWritable:!0,isSigner:!1},{pubkey:i.tokenB,isWritable:!0,isSigner:!1},{pubkey:i.sourceA,isWritable:!0,isSigner:!1},{pubkey:i.destinationA,isWritable:!0,isSigner:!1},{pubkey:i.sourceB,isWritable:!0,isSigner:!1},{pubkey:i.feePayer,isWritable:!0,isSigner:!0},{pubkey:i.feeReceiver,isWritable:!0,isSigner:!1},{pubkey:i.tokenProgram??ee,isWritable:!1,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const bi=new a.FixableBeetArgsStruct([["newAuthority",a.coption(v.publicKey)],["isPaused",a.coption(a.bool)],["ratio",a.coption(ve)],["lockFee",a.coption(a.u16)],["unlockFee",a.coption(a.u16)],["feeReceiver",a.coption(v.publicKey)]],"UpdatePairData"),Si=new a.FixableBeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["data",bi]],"UpdatePairInstructionArgs"),Ai=[176,62,36,215,255,206,35,12];function wi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=Si.serialize({instructionDiscriminator:Ai,...e}),s=[{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const vi=new a.BeetArgsStruct([["instructionDiscriminator",a.uniformFixedSizeArray(a.u8,8)],["amount",a.u64]],"WithdrawFeeInstructionArgs"),_i=[14,122,231,218,31,238,223,150];function Pi(i,e,t=new g("JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm")){const[n]=vi.serialize({instructionDiscriminator:_i,...e}),s=[{pubkey:i.pair,isWritable:!0,isSigner:!1},{pubkey:i.pairAuthority,isWritable:!0,isSigner:!1},{pubkey:i.destination,isWritable:!0,isSigner:!1},{pubkey:i.authority,isWritable:!0,isSigner:!0},{pubkey:i.systemProgram??B.programId,isWritable:!1,isSigner:!1}];if(i.anchorRemainingAccounts!=null)for(const c of i.anchorRemainingAccounts)s.push(c);return new x({programId:t,keys:s,data:n})}const Ti="JDe51ZjpQ3tZzL6QTVPHt5VT5NzaDuJnrTmJJUFrC3vm",We=new g(Ti),Bi={version:"0.0.6",name:"smart_converter",instructions:[{name:"setAdmin",accounts:[{name:"admin",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"key",type:"publicKey"}]},{name:"addPair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"policy",type:{option:"publicKey"}},{name:"ratio",type:{defined:"Ratio"}}]},{name:"addUserToWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"userAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"pair",isMut:!0,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removeUserFromWhitelist",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"whitelistedUserInfo",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePlatform",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"admin",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"lockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"user",isMut:!1,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"destinationB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"unlockTokens",accounts:[{name:"proofRequest",isMut:!1,isSigner:!1,isOptional:!0},{name:"user",isMut:!1,isSigner:!1},{name:"userAuthority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!1,isSigner:!1},{name:"whitelistedUserInfo",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"tokenA",isMut:!0,isSigner:!1},{name:"tokenB",isMut:!0,isSigner:!1},{name:"sourceA",isMut:!0,isSigner:!1},{name:"destinationA",isMut:!0,isSigner:!1},{name:"sourceB",isMut:!0,isSigner:!1},{name:"feePayer",isMut:!0,isSigner:!0},{name:"feeReceiver",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"removeManager",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"pausePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"resumePairs",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updatePair",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pair",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"UpdatePairData"}}]},{name:"blockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"unblockUser",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"manager",isMut:!1,isSigner:!1},{name:"user",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"withdrawFee",accounts:[{name:"pair",isMut:!0,isSigner:!1},{name:"pairAuthority",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]}],accounts:[{name:"pair",type:{kind:"struct",fields:[{name:"authority",docs:["Manager authority"],type:"publicKey"},{name:"tokenA",docs:["Security token mint address"],type:"publicKey"},{name:"tokenB",docs:["Utility token mint address"],type:"publicKey"},{name:"lockedAmount",docs:["Amount of security tokens currently locked"],type:"u64"},{name:"ratio",docs:["Ratio of token A to token B"],type:{defined:"Ratio"}},{name:"isPaused",docs:["Indicates if pair is paused or not"],type:"bool"},{name:"lockFee",docs:["Fee for locking token A"],type:"u16"},{name:"unlockFee",docs:["Fee for unlocking token A"],type:"u16"},{name:"feeReceiver",docs:["Wallet that will receive fee"],type:"publicKey"},{name:"policy",docs:["Albus policy"],type:{option:"publicKey"}}]}},{name:"admin",type:{kind:"struct",fields:[{name:"authority",docs:["Manager wallet address"],type:"publicKey"},{name:"isPlatformPaused",docs:["Indicates if platform is paused or not"],type:"bool"}]}},{name:"manager",type:{kind:"struct",fields:[{name:"authority",docs:["Manager address"],type:"publicKey"},{name:"isAllPaused",docs:["Indicates if manager's pairs are paused or not"],type:"bool"}]}},{name:"user",type:{kind:"struct",fields:[{name:"authority",docs:["User address"],type:"publicKey"},{name:"isBlocked",docs:["Indicates if user is blocked or not"],type:"bool"}]}},{name:"whitelistedUserInfo",type:{kind:"struct",fields:[{name:"user",docs:["User address"],type:"publicKey"},{name:"pair",docs:["Pair address"],type:"publicKey"}]}}],types:[{name:"UpdatePairData",type:{kind:"struct",fields:[{name:"newAuthority",type:{option:"publicKey"}},{name:"isPaused",type:{option:"bool"}},{name:"ratio",type:{option:{defined:"Ratio"}}},{name:"lockFee",type:{option:"u16"}},{name:"unlockFee",type:{option:"u16"}},{name:"feeReceiver",type:{option:"publicKey"}}]}},{name:"Ratio",type:{kind:"struct",fields:[{name:"num",type:"u64"},{name:"denom",type:"u64"}]}}],events:[{name:"LockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!1},{name:"userAuthority",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"UnlockTokensEvent",fields:[{name:"pair",type:"publicKey",index:!0},{name:"user",type:"publicKey",index:!1},{name:"userAuthority",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]}],errors:[{code:6e3,name:"Unauthorized",msg:"Unauthorized action"},{code:6001,name:"IsPaused",msg:"Paused"},{code:6002,name:"AlreadyResumed",msg:"Already resumed"},{code:6003,name:"StillRemainingLockedTokens",msg:"Pair still have locked tokens"},{code:6004,name:"IsBlocked",msg:"User is blocked"},{code:6005,name:"AlreadyUnblocked",msg:"User is already unblocked"},{code:6006,name:"InsufficientLockedAmount",msg:"Insufficient locked amount"},{code:6007,name:"InsufficientFunds",msg:"Insufficient funds"}]};function ze(i){return"version"in i}class Ii{constructor(e){this.payer=e}async signTransaction(e){return ze(e)?e.sign([this.payer]):e.partialSign(this.payer),e}async signAllTransactions(e){return e.map(t=>(ze(t)?t.sign([this.payer]):t.partialSign(this.payer),t))}get publicKey(){return this.payer.publicKey}}const Mi="user",xi="manager",Di="pair",Wi="admin",zi="whitelist",oe=class oe{constructor(e){A(this,"program");this.provider=e,this.program=new Xe(Bi,We,e)}static fromWallet(e,t,n){return new this(new _e(e,t??{publicKey:g.default},{..._e.defaultOptions(),...n}))}static fromKeypair(e,t,n){return oe.fromWallet(e,new Ii(t),n)}get idl(){return this.program.idl}get pda(){return new Ri}fetchManager(e){return this.program.account.manager.fetchNullable(e)}fetchAdmin(e){return this.program.account.admin.fetchNullable(e??this.pda.admin()[0])}fetchUser(e){return this.program.account.user.fetchNullable(e)}fetchPair(e){return this.program.account.pair.fetchNullable(e)}fetchWhitelistedUserInfo(e){return this.program.account.whitelistedUserInfo.fetchNullable(e)}fetchWhitelistedUserInfoByUserAndPair(e,t){const[n]=this.pda.whitelistedUserInfo(e,t);return this.fetchWhitelistedUserInfo(n)}findManagers(){return this.program.account.manager.all()}findPairs(){return this.program.account.pair.all()}async findManagerPairs(e){return(await this.program.account.pair.all()).filter(n=>n.account.authority.toBase58()===e.toBase58())}async findWhitelistedUsers(e){return(await this.program.account.whitelistedUserInfo.all()).filter(n=>n.account.pair.toBase58()===e.toBase58())}async findUserWhitelistInfos(e){return(await this.program.account.whitelistedUserInfo.all()).filter(n=>n.account.user.toBase58()===e.toBase58())}async addManager(e){const t=this.provider.publicKey,[n]=this.pda.manager(e.managerWallet),[s]=this.pda.admin(),r=xt({authority:t,admin:s,manager:n},{key:e.managerWallet}),c=new I().add(r);return{signature:await this.provider.sendAndConfirm(c),manager:n}}async addPair(e){const t=this.provider.publicKey,[n]=this.pda.manager(t),s=e.tokenA;let r=e.tokenB;const c=new I,l=[];let d,p;if(r)d=this.pda.pair(s,r)[0],p=this.pda.pairAuthority(d)[0],c.add(kt(r,this.provider.publicKey,bt.MintTokens,p));else{const y=e.tokenBKeypair??Je.generate();r=y.publicKey,l.push(y),d=this.pda.pair(s,r)[0],p=this.pda.pairAuthority(d)[0];const f=await Ye(this.provider.connection);c.add(B.createAccount({fromPubkey:t,newAccountPubkey:y.publicKey,space:et,lamports:f,programId:ee}),tt(y.publicKey,9,p,null,ee))}return await this.handleMissingTokenAccount(c,s,p),await this.handleMissingTokenAccount(c,r,p),c.add(zt({authority:t,manager:n,pair:d,pairAuthority:p,tokenA:s,tokenB:r},{ratio:e.ratio??{num:1,denom:1},policy:e.policy??null})),{signature:await this.provider.sendAndConfirm(c,l),pair:d}}async lockTokens(e){const t=this.provider.publicKey,n=e.tokenA,s=e.tokenB,[r]=this.pda.user(t),[c]=this.pda.pair(n,s),l=await this.fetchPair(c),[d]=this.pda.admin(),[p]=this.pda.manager(l.authority),[m]=this.pda.pairAuthority(c),[y]=this.pda.whitelistedUserInfo(t,c),f=new I,b=Pe(n,t),w=await this.handleMissingTokenAccount(f,n,m),P=await this.handleMissingTokenAccount(f,s,t);return f.add(Lt({proofRequest:e.proofRequest,user:r,userAuthority:t,pair:c,pairAuthority:m,admin:d,manager:p,whitelistedUserInfo:y,feePayer:e.feePayer??t,feeReceiver:l.feeReceiver,sourceA:b,destinationA:w,destinationB:P,tokenA:n,tokenB:s},{amount:new be(e.amount)})),{signature:await this.provider.sendAndConfirm(f),pair:c}}async unlockTokens(e){const t=this.provider.publicKey,n=e.tokenA,s=e.tokenB,[r]=this.pda.admin(),[c]=this.pda.user(t),[l]=this.pda.pair(n,s),[d]=this.pda.pairAuthority(l),[p]=this.pda.whitelistedUserInfo(t,l),m=await this.fetchPair(l),[y]=this.pda.manager(m.authority),f=new I,b=await this.handleMissingTokenAccount(f,s,t),w=await this.handleMissingTokenAccount(f,n,d),P=await this.handleMissingTokenAccount(f,n,t);return f.add(ki({proofRequest:e.proofRequest,user:c,userAuthority:t,pair:l,pairAuthority:d,feePayer:e.feePayer??t,feeReceiver:m.feeReceiver,whitelistedUserInfo:p,admin:r,destinationA:P,manager:y,sourceA:w,sourceB:b,tokenA:n,tokenB:s},{amount:new be(e.amount)})),{signature:await this.provider.sendAndConfirm(f),pair:l,user:c}}async addUserToWhitelist(e){const t=this.provider.publicKey,[n]=this.pda.manager(t),s=e.userWallet,[r]=this.pda.user(s),c=e.tokenA,l=e.tokenB,[d]=this.pda.pair(c,l),[p]=this.pda.whitelistedUserInfo(s,d),m=Ft({userAuthority:s,authority:t,manager:n,pair:d,tokenA:c,tokenB:l,user:r,whitelistedUserInfo:p}),y=new I().add(m);return{signature:await this.provider.sendAndConfirm(y),user:r,whitelistedUserInfo:p}}async removeUserFromWhitelist(e){const t=this.provider.publicKey,n=e.userWallet,[s]=this.pda.user(n),[r]=this.pda.pair(e.tokenA,e.tokenB),[c]=this.pda.whitelistedUserInfo(n,r),l=ni({authority:t,pair:r,whitelistedUserInfo:c}),d=new I().add(l);return{signature:await this.provider.sendAndConfirm(d),user:s,whitelistedUserInfo:c}}async blockUser(e){const t=this.provider.publicKey,[n]=this.pda.manager(t),s=e.userWallet,[r]=this.pda.user(s),c=Ct({authority:t,manager:n,user:r}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),user:r}}async unblockUser(e){const t=this.provider.publicKey,n=e.userWallet,[s]=this.pda.manager(t),[r]=this.pda.user(n),c=yi({authority:t,manager:s,user:r}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),user:r}}async pausePairs(e){const t=this.provider.publicKey,n=e.managerWallet,[s]=this.pda.manager(n),[r]=this.pda.admin(),c=Nt({admin:r,authority:t,manager:s}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:s}}async pausePlatform(){const e=this.provider.publicKey,[t]=this.pda.admin(),n=jt({admin:t,authority:e}),s=new I().add(n);return{signature:await this.provider.sendAndConfirm(s),admin:t}}async removeManager(e){const t=this.provider.publicKey,n=e.managerWallet,[s]=this.pda.manager(n),[r]=this.pda.admin(),c=Gt({admin:r,authority:t,manager:s}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:s}}async removePair(e){const t=this.provider.publicKey,n=e.tokenA,s=e.tokenB,[r]=this.pda.pair(n,s),c=ei({authority:t,pair:r}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),pair:r}}async resumePairs(e){const t=this.provider.publicKey,n=e.managerWallet,[s]=this.pda.manager(n),[r]=this.pda.admin(),c=ai({authority:t,admin:r,manager:s}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),manager:s}}async resumePlatform(){const e=this.provider.publicKey,[t]=this.pda.admin(),n=ui({authority:e,admin:t}),s=new I().add(n);return{signature:await this.provider.sendAndConfirm(s),admin:t}}async setAdmin(e){const t=this.provider.publicKey,[n]=this.pda.admin(),s=mi({authority:t,admin:n},{key:e.authority}),r=new I().add(s);return{signature:await this.provider.sendAndConfirm(r)}}async withdrawFee(e){const t=this.provider.publicKey,[n]=this.pda.pair(e.tokenA,e.tokenB),[s]=this.pda.pairAuthority(n),r=Pi({authority:t,pair:n,pairAuthority:s,destination:e.destination},{amount:new be(e.amount)}),c=new I().add(r);return{signature:await this.provider.sendAndConfirm(c)}}async updatePair(e){const t=this.provider.publicKey,n=e.tokenA,s=e.tokenB,[r]=this.pda.pair(n,s),c=wi({authority:t,pair:r},{data:{feeReceiver:e.feeReceiver??null,lockFee:e.lockFee??null,unlockFee:e.unlockFee??null,newAuthority:e.newAuthority??null,isPaused:e.isPaused??null,ratio:e.ratio??null}}),l=new I().add(c);return{signature:await this.provider.sendAndConfirm(l),pair:r}}async handleMissingTokenAccount(e,t,n){const s=n??this.provider.publicKey,r=Pe(t,s,!0);try{await it(this.provider.connection,r)}catch(c){(c instanceof nt||c instanceof st)&&e.add(rt(this.provider.publicKey,r,s,t))}return r}};A(oe,"programId",We);let ae=oe;class Ri{constructor(){A(this,"pairAuthority",e=>this.pda([new g(e).toBuffer()]));A(this,"admin",()=>this.pda([N.Buffer.from(Wi)]));A(this,"manager",e=>this.pda([N.Buffer.from(xi),new g(e).toBuffer()]));A(this,"user",e=>this.pda([N.Buffer.from(Mi),new g(e).toBuffer()]));A(this,"pair",(e,t)=>this.pda([N.Buffer.from(Di),new g(e).toBuffer(),new g(t).toBuffer()]));A(this,"whitelistedUserInfo",(e,t)=>this.pda([N.Buffer.from(zi),new g(e).toBuffer(),new g(t).toBuffer()]))}pda(e){return g.findProgramAddressSync(e,ae.programId)}}const ge=at("converter",()=>{const i=Se(),e=Ke(),{setContractPolicy:t}=Ce(),n=ot({from:{amount:void 0},to:{amount:void 0},token:void 0,allTokens:[],pairs:[],selectedPair:void 0,searchToken:"",converting:!1,loading:!1,isLock:!0}),s=_(()=>ae.fromWallet(i.connection,e.value));async function r(m,y,f){try{const b=await ut.Metadata.fromAccountAddress(m,lt(y)),w=b.data?.uri;if(w){const{data:P}=await dt.get(w);return{...P,image:re(P?.image)}}return b}catch{return{symbol:f,image:re()}}}const c=m=>n.allTokens.find(f=>f.mint.toBase58()===m)?.balance??0,l=async()=>{try{const m=e.value?.publicKey;if(!m)return;n.allTokens=await ct(i.connection,m)}catch(m){console.log(m)}},d=async()=>{try{n.loading=!0;const m=await s.value.findPairs();if(n.pairs.length!==0)return;const y=await Promise.all(m.map(async f=>{const b=f.account,w=b.tokenA.toBase58(),P=b.tokenB.toBase58(),h=await r(i.connection,w,"tokenA"),R=await r(i.connection,P,"tokenB"),T={[w]:h,[P]:R};return{...f,tokensMetadata:T}}));n.pairs=y}catch(m){console.log(m)}finally{n.loading=!1}},p=async m=>{try{n.loading=!0;const y=await s.value.fetchPair(m);if(y){const f=n.pairs.findIndex(b=>b.publicKey.toBase58()===m);if(f!==-1){const b=n.pairs[f];n.pairs[f]={...b,account:y},n.selectedPair=n.pairs[f]}}}catch(y){console.log(y),await d()}finally{n.loading=!1}};return Ee(s,async m=>{i.cluster==="devnet"&&await d()},{immediate:!0,debounce:500,maxWait:1e3}),$(()=>i.cluster,m=>{m!=="devnet"&&(n.pairs=[],n.selectedPair=void 0,n.token=void 0,n.from={amount:void 0},n.to={amount:void 0})}),$(()=>e.value?.publicKey,async m=>{if(!m){n.allTokens=[],n.from.balance=0,n.to.balance=0;return}await l()},{immediate:!0}),$([()=>n.token,()=>n.allTokens,()=>n.pairs],([m])=>{const y=n.selectedPair;if(!y)return;const f=y.account?.policy;f&&t(String(f));for(const b in y.tokensMetadata){const w=y.tokensMetadata[b],P=c(String(b));b===m?.mint?n.from={...w,balance:P,amount:void 0}:n.to={...w,balance:P,amount:void 0}}}),$(()=>n.isLock,()=>{n.token=void 0}),{state:n,getAllTokens:l,updatePairData:p,converterClient:s}});function $e(){const i=ge(),e=Ce(),t=Se(),{notify:n}=Ve();function s(h){console.log("set token ======== ",h),i.state.selectedPair=i.state.pairs.find(R=>R.publicKey.toBase58()===h?.publicKey?.toBase58()),i.state.token=h}function r(h){i.state.searchToken=h}const c=_(()=>i.state.pairs.map(T=>{const D=Object.entries(T.tokensMetadata)[i.state.isLock?0:1];return{...D[1],mint:D[0],publicKey:T.publicKey}}).flat().filter(T=>T.symbol.toLowerCase().includes(i.state.searchToken.toLowerCase()))),l=_(()=>i.state.selectedPair?.account),d=_(()=>l.value?.ratio?.num?.toNumber()??1),p=_(()=>l.value?.lockedAmount?l.value?.lockedAmount?.toNumber()/Te:0),m=_(()=>l.value?.lockFee),y=_(()=>{const h=l.value?.tokenA?.toString();return xe(h,i.state.selectedPair?.tokensMetadata)}),f=_(()=>{const h=l.value?.tokenB?.toString();return xe(h,i.state.selectedPair?.tokensMetadata)}),b=_(()=>i.state.pairs.length===0),w=_(()=>!!e.state.certificates?.find(h=>h.data?.policy.toBase58()===String(e.requiredPolicy)));async function P(h=!0){const R=e.state.certificates?.find(T=>T.data?.policy.toBase58()===String(e.requiredPolicy))?.pubkey;if(!(!l.value||!R))try{i.state.converting=!0;const T=l.value.tokenA,D=l.value.tokenB,j=Number(i.state.from.amount*Te)/(i.state.isLock?1:d.value);let W;h?W=await i.converterClient.lockTokens({tokenA:T,tokenB:D,amount:j,proofRequest:R}):W=await i.converterClient.unlockTokens({tokenA:T,tokenB:D,amount:j,proofRequest:R}),n({message:"Transaction confirmed",type:"positive",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${W.signature}?cluster=${t.cluster}`,onClick:()=>!1}]}),setTimeout(async()=>{Promise.all([await i.getAllTokens(),await i.updatePairData(i.state.selectedPair.publicKey.toBase58())])},1e3)}catch(T){console.error("lockedToken error: ",T),n({type:"negative",message:`${T}`})}finally{i.state.converting=!1}}return Ee(c,h=>{h.length!==0&&!i.state.token&&s(h[0])},{immediate:!0,debounce:100,maxWait:1e3}),$(()=>i.state.from.amount,h=>{if(!h){i.state.to.amount=void 0;return}i.state.to.amount=i.state.isLock?h*d.value:h/d.value}),{options:c,setToken:s,handleSearchToken:r,pairRatio:d,pairLockedAmount:p,pairLockFee:m,tokenASymbol:y,tokenBSymbol:f,isHaveCertificate:w,lockUnlockToken:P,isDisabledInputs:b}}const Ui={class:"swap-form"},Fi={class:"swap-field"},Ji={class:"swap-field__info"},Ki={class:"row items-end"},Ci=u("div",{class:"col swap-field__label"}," FROM: ",-1),Ei={class:"col-8 col-xs-10 row justify-end swap-field__balance"},Vi={key:0,class:"insufficient-error"},Li=u("div",{class:"swap-change"},null,-1),Qi={class:"swap-field"},Zi={class:"swap-field__info"},Ni={class:"row"},$i=u("div",{class:"col swap-field__label"}," TO: ",-1),Hi={class:"col swap-field__balance"},ji={class:"convert-to"},qi=["src"],Oi={class:"swap-info q-mt-md q-pt-xs"},Gi=u("dt",null,"Received",-1),Xi=u("dt",null,"Locked amount",-1),Yi=u("dt",null,"Ratio",-1),en={key:0},tn={key:1},nn=u("dt",null,"Lock fee",-1),sn={class:"swap-submit q-mt-md"},rn={class:"row q-mt-md text-center relative-position full-width"},an={class:"swap-rate q-mx-auto"},on=Ae({__name:"UnlockCard",setup(i){const{state:e}=ge(),{options:t,setToken:n,handleSearchToken:s,pairRatio:r,pairLockedAmount:c,pairLockFee:l,tokenASymbol:d,tokenBSymbol:p,isHaveCertificate:m,lockUnlockToken:y,isDisabledInputs:f}=$e();e.isLock=!1;const b=Ke(),w=_(()=>e.from.balance),P=_(()=>e.to.balance),h=_(()=>e.to.amount??0);function R(){e.from.amount=w.value}async function T(){await y(!1)}const D=_(()=>e.from.amount>w.value?"Insufficient funds":!1);return(j,W)=>{const he=Fe,ke=Re;return z(),te(we,{class:"swap-card swap-widget converting-card"},{default:M(()=>[k(Le,{class:"swap-card__body"},{default:M(()=>[u("div",Ui,[u("div",Fi,[u("div",Ji,[u("div",Ki,[Ci,u("div",Ei,[o(D)?(z(),U("div",Vi,S(o(D)),1)):H("",!0),F(" Balance: "+S(o(ie)(o(w))),1)])])]),k(ne,{modelValue:o(e).from.amount,"onUpdate:modelValue":W[0]||(W[0]=C=>o(e).from.amount=C),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",disable:o(f),onKeypress:o(Ue)},{append:M(()=>[k(se,{disable:o(f),dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:R},{default:M(()=>[F(" MAX ")]),_:1},8,["disable"]),o(e).token?(z(),te(he,{key:0,options:o(t),token:o(e).token,"swap-token":String(o(e).to.symbol),onHandleSearchToken:o(s),onSetToken:o(n)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):H("",!0)]),_:1},8,["modelValue","disable","onKeypress"])]),Li,u("div",Qi,[u("div",Zi,[u("div",Ni,[$i,u("div",Hi," Balance: "+S(o(ie)(o(P))),1)])]),k(ne,{modelValue:o(e).to.amount,"onUpdate:modelValue":W[1]||(W[1]=C=>o(e).to.amount=C),disable:o(f),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Qe({_:2},[o(e).to?.symbol?{name:"append",fn:M(()=>[u("div",ji,[u("img",{src:o(re)(o(e).to?.image)},null,8,qi),F(),u("span",null,S(o(e).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue","disable"])])]),u("div",Oi,[u("dl",null,[Gi,u("dd",null,S(o(h))+" "+S(o(p)),1)]),u("dl",null,[Xi,u("dd",null,S(o(c))+" "+S(o(d)),1)]),u("dl",null,[Yi,o(r)?(z(),U("dd",en,S(o(r))+":1 ",1)):(z(),U("dd",tn," - "))]),u("dl",null,[nn,u("dd",null,S(o(l))+" SOL",1)])]),k(ke,{class:"q-mt-md q-mx-auto"}),u("div",sn,[k(se,{loading:o(e).converting,rounded:"",ripple:!1,disable:!o(b)?.publicKey||!o(e).from.amount||o(e).from.amount<=0||!!o(D)||!o(m),onClick:T},{default:M(()=>[F(" Unlock token ")]),_:1},8,["loading","disable"])]),u("div",rn,[u("div",an," 1 "+S(o(p))+" = "+S(1/o(r))+" "+S(o(d)),1)])]),_:1}),k(Ze,{showing:o(e)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),cn={class:"swap-form"},un={class:"swap-field"},ln={class:"swap-field__info"},dn={class:"row items-end"},mn=u("div",{class:"col swap-field__label"}," FROM: ",-1),fn={class:"col-8 col-xs-10 row justify-end swap-field__balance"},pn={key:0,class:"insufficient-error"},yn=u("div",{class:"swap-change"},null,-1),gn={class:"swap-field"},hn={class:"swap-field__info"},kn={class:"row"},bn=u("div",{class:"col swap-field__label"}," TO: ",-1),Sn={class:"col swap-field__balance"},An={class:"convert-to"},wn=["src"],vn={class:"swap-info q-mt-md q-pt-xs"},_n=u("dt",null,"Received",-1),Pn=u("dt",null,"Locked amount",-1),Tn=u("dt",null,"Ratio",-1),Bn={key:0},In={key:1},Mn=u("dt",null,"Lock fee",-1),xn={class:"swap-submit q-mt-md"},Dn={class:"row q-mt-md text-center relative-position full-width"},Wn={class:"swap-rate q-mx-auto"},zn=Ae({__name:"LockCard",setup(i){const e=Ne(),{state:t}=ge(),{options:n,setToken:s,handleSearchToken:r,pairRatio:c,pairLockedAmount:l,pairLockFee:d,tokenASymbol:p,tokenBSymbol:m,isHaveCertificate:y,lockUnlockToken:f,isDisabledInputs:b}=$e();t.isLock=!0;const w=_(()=>t.from.balance),P=_(()=>t.to.balance),h=_(()=>t.to.amount??0);function R(){t.from.amount=w.value}async function T(){await f()}const D=_(()=>t.from.amount>w.value?"Insufficient funds":!1);return(j,W)=>{const he=Fe,ke=Re;return z(),te(we,{class:"swap-card swap-widget converting-card"},{default:M(()=>[k(Le,{class:"swap-card__body"},{default:M(()=>[u("div",cn,[u("div",un,[u("div",ln,[u("div",dn,[mn,u("div",fn,[o(D)?(z(),U("div",pn,S(o(D)),1)):H("",!0),F(" Balance: "+S(o(ie)(o(w))),1)])])]),k(ne,{modelValue:o(t).from.amount,"onUpdate:modelValue":W[0]||(W[0]=C=>o(t).from.amount=C),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",disable:o(b),onKeypress:o(Ue)},{append:M(()=>[k(se,{disable:o(b),dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:R},{default:M(()=>[F(" MAX ")]),_:1},8,["disable"]),o(t).token?(z(),te(he,{key:0,options:o(n),token:o(t).token,"swap-token":String(o(t).to.symbol),onHandleSearchToken:o(r),onSetToken:o(s)},null,8,["options","token","swap-token","onHandleSearchToken","onSetToken"])):H("",!0)]),_:1},8,["modelValue","disable","onKeypress"])]),yn,u("div",gn,[u("div",hn,[u("div",kn,[bn,u("div",Sn," Balance: "+S(o(ie)(o(P))),1)])]),k(ne,{modelValue:o(t).to.amount,"onUpdate:modelValue":W[1]||(W[1]=C=>o(t).to.amount=C),disable:o(b),readonly:"",maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input"},Qe({_:2},[o(t).to?.symbol?{name:"append",fn:M(()=>[u("div",An,[u("img",{src:o(re)(o(t).to?.image)},null,8,wn),F(),u("span",null,S(o(t).to?.symbol),1)])]),key:"0"}:void 0]),1032,["modelValue","disable"])])]),u("div",vn,[u("dl",null,[_n,u("dd",null,S(o(h))+" "+S(o(m)),1)]),u("dl",null,[Pn,u("dd",null,S(o(l))+" "+S(o(p)),1)]),u("dl",null,[Tn,o(c)?(z(),U("dd",Bn," 1:"+S(o(c)),1)):(z(),U("dd",In," - "))]),u("dl",null,[Mn,u("dd",null,S(o(d))+" SOL",1)])]),k(ke,{class:"q-mt-md q-mx-auto"}),u("div",xn,[k(se,{loading:o(t).converting,rounded:"",ripple:!1,disable:!o(e)?.publicKey||!o(t).from.amount||o(t).from.amount<=0||!!o(D)||!o(y),onClick:T},{default:M(()=>[F(" Lock token ")]),_:1},8,["loading","disable"])]),u("div",Dn,[u("div",Wn," 1 "+S(o(p))+" = "+S(o(c))+" "+S(o(m)),1)])]),_:1}),k(Ze,{showing:o(t)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),Rn="/assets/faucet-icon-9cedc046.svg",Un={class:"converter"},Fn={key:0,class:"converter-faucet"},Jn=u("div",{class:"converter-faucet__descr"}," To get the opTK token, click on faucet. ",-1),Kn=["src"],Cn=Ae({__name:"ConverterCard",setup(i){const e=Se(),{publicKey:t}=Ne(),n=ge(),{notify:s}=Ve(),r=mt("lock"),c=_(()=>e.cluster==="devnet");async function l(){if(t.value)try{n.state.loading=!0;const d=Je.fromSecretKey(St.decode("38f57pVjJEb9wGuzAmonU2k76ctmrDWBVyn9v5hMMURLVqYC5xWwd31UhHAWmNkTwvh1r8d1SgNoLKTiDUDnTo1u")),p=new g("CDcwg5UiZcXBtQ7eBRZpSr23vHntpGotmmgCSoxAjfrM"),m=await At(e.connection,d,p,t.value);await wt(e.connection,d,p,m.address,d,1e10),await n.getAllTokens(),n.state.from.amount=10,s({type:"positive",message:"You got 10 opTK"})}catch(d){console.log("failed mint e:",d)}finally{n.state.loading=!1}}return(d,p)=>{const m=zn,y=on;return z(),U("div",Un,[o(n).state.pairs.length!==0&&o(c)&&o(t)?(z(),U("div",Fn,[Jn,u("img",{src:o(Rn),alt:"faucet icon",onClick:l},null,8,Kn)])):H("",!0),k(we,{class:"liquidity-tabs swap-card swap-widget"},{default:M(()=>[k(ft,{modelValue:o(r),"onUpdate:modelValue":p[0]||(p[0]=f=>Be(r)?r.value=f:null),align:"justify","indicator-color":"transparent",class:pt(d.$q.dark.isActive?"bg-blue-grey-9":"bg-grey-3"),"active-color":"white","active-bg-color":"primary"},{default:M(()=>[k(Ie,{ripple:!1,label:"LOCK",name:"lock"}),k(Ie,{ripple:!1,label:"UNLOCK",name:"unlock"})]),_:1},8,["modelValue","class"]),k(yt,{modelValue:o(r),"onUpdate:modelValue":p[1]||(p[1]=f=>Be(r)?r.value=f:null),animated:"",class:"bg-transparent"},{default:M(()=>[k(Me,{name:"lock"},{default:M(()=>[k(m)]),_:1}),k(Me,{name:"unlock"},{default:M(()=>[k(y)]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});const En={},Vn={class:"main-block row justify-center"};function Ln(i,e){const t=qe,n=Cn,s=Oe,r=Ge;return z(),U(ht,null,[k(t,{class:"q-mt-lg"}),u("div",Vn,[k(n)]),k(s,{class:"q-mt-lg"}),k(r,{class:"q-mt-lg"})],64)}const Gn=gt(En,[["render",Ln]]);export{Gn as default};
