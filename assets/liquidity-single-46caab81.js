import{_ as W,a as R,b as G}from"./AppDescriptionTop-351f64b8.js";import{_ as O}from"./SelectPool.vue_vue_type_script_setup_true_lang-21200c76.js";import{_ as X}from"./SelectToken.vue_vue_type_script_setup_true_lang-1198b765.js";import{s as Y,u as Z,x as J,y as ee,z as oe,v as i,B as ne,I as D,aH as ae,V as te,W as se,H as le,w as ie,ax as I,G as ce,C as re,o as w,Y as de,Z as c,$ as ue,j as a,a0 as y,a1 as L,a2 as n,a3 as e,i as A,a5 as l,a4 as pe,a6 as T,a7 as P,a8 as b,az as me,aA as _e,aB as fe,a9 as ke,_ as we,ad as ve}from"./index-d0b1a4e3.js";import{o as ge}from"./common-21d1f462.js";import{s as he}from"./swap-circle-a93e350f.js";import{u as Q,S as Se}from"./swap-eeb618db.js";import"./PoolsListItem.vue_vue_type_script_setup_true_lang-c8b7cdbb.js";import"./associatedTokenAccount-f2987423.js";const ye=Y("liquidity-single",()=>{const B=Z(),p=J(),{publicKey:o}=ee(),{notify:f}=oe(),r=Q(),t=i(()=>r.tokenSwap),v=i(()=>r.state),m=i(()=>r.swapClient),d=ne({swapping:!1,active:!1,amountTokenA:0});function s(){r.loadPoolTokenAccounts(),d.amountTokenA=0}async function C(){if(!t.value||!o.value){console.log("TokenSwap is not initialized...");return}try{d.swapping=!0;const u=v.value.direction===Se.ASC?t.value.data.tokenAMint:t.value.data.tokenBMint,x=await D(u,p.value.publicKey),g=await D(t.value.data.poolMint,p.value.publicKey),h=Number(ae(d.amountTokenA??0,v.value.from.decimals)),q=await m.value.depositSingleTokenTypeExactAmountIn({tokenSwap:t.value?.pubkey,poolMint:t.value.data.poolMint,sourceTokenMint:u,source:x,destination:g,swapTokenA:t.value.data.tokenA,swapTokenB:t.value.data.tokenB,sourceTokenAmount:h,minimumPoolTokenAmount:0});s(),f({message:"Transaction confirmed",type:"positive",actions:[{label:"Explore",color:"white",target:"_blank",href:`https://explorer.solana.com/tx/${q}?cluster=${B.cluster}`,onClick:()=>!1}]})}catch(u){console.log(u)}finally{d.swapping=!1}}return{state:d,depositSingleToken:C}}),Te={class:"swap-form"},be={class:"swap-field"},Ae={class:"swap-field__info"},Be={class:"row items-end"},Ce=n("div",{class:"col swap-field__label"},null,-1),xe={class:"col-8 col-xs-10 row justify-end swap-field__balance"},qe={key:0,class:"insufficient-error"},Me={class:"swap-change"},Ve=["innerHTML"],$e={class:"swap-field"},He={class:"swap-field__info q-mt-sm"},Ne={class:"row"},De={class:"col swap-field__balance"},Ie={class:"swap-submit q-mt-lg"},Le={key:0,class:"text-weight-medium fs-13 text-center q-mt-md text-negative"},Pe={key:1,class:"row q-mt-md text-center relative-position full-width"},Qe={class:"absolute-right swap-rate__refresh"},Ke={class:"swap-info q-mt-lg"},ze=te({__name:"DepositSingleCard",setup(B){const p=Q(),{state:o,loadingPoolTokens:f,changeDirection:r,setMax:t,loadPoolTokenAccounts:v}=p,m=i(()=>p.tokenSwap),d=ye(),{state:s,depositSingleToken:C}=d,{handleSearchToken:u,handleFilterToken:x,tokens:g}=se();x(le);const h=ie(),q=i(()=>o.poolBalance[o.from.mint]?I(o.poolBalance[o.from.mint],o.from.decimals):0),K=i(()=>o.poolBalance[o.to.mint]?I(o.poolBalance[o.to.mint],o.to.decimals):0),$=ce(0),z=i(()=>`transform: rotate(${$.value*180}deg)`),S=i(()=>h.tokenBalance(o.from.mint)),E=i(()=>h.tokenBalance(o.to.mint));function j(){r(),$.value++}function H(k,_){o[_?"to":"from"]=k}function F(){t(S.value)}const M=i(()=>Number(s.amountTokenA)>S.value?"Insufficient funds":!1);return re([()=>s.amountTokenA,m,S],k=>{s.active=!M.value}),(k,_)=>{const N=X,U=O;return w(),de(ue,{class:"swap-card swap-widget"},{default:c(()=>[a(L,{class:"swap-card__header"},{default:c(()=>[y(" Deposit ")]),_:1}),a(L,{class:"swap-card__body"},{default:c(()=>[n("div",Te,[n("div",be,[n("div",Ae,[n("div",Be,[Ce,n("div",xe,[e(M)?(w(),A("div",qe,l(e(M)),1)):pe("",!0),y(" Balance: "+l(e(T)(e(S)))+" "+l(e(o).from.symbol),1)])])]),a(P,{modelValue:e(s).amountTokenA,"onUpdate:modelValue":_[0]||(_[0]=V=>e(s).amountTokenA=V),maxlength:14,outlined:"",placeholder:"0.0",class:"swap-input",onKeypress:e(ge)},{append:c(()=>[a(b,{dense:"",unelevated:"",ripple:!1,class:"swap-input__max",onClick:F},{default:c(()=>[y(" MAX ")]),_:1}),a(N,{options:e(g),token:e(o).from,"swap-token":String(e(o).to.symbol),onHandleSearchToken:e(u),onSetToken:H},null,8,["options","token","swap-token","onHandleSearchToken"])]),_:1},8,["modelValue","onKeypress"])]),n("div",Me,[a(b,{ripple:!1,dense:"",unelevated:"",style:me(e(z)),onClick:j},{default:c(()=>[n("i",{innerHTML:e(he)},null,8,Ve)]),_:1},8,["style"])]),n("div",$e,[n("div",He,[n("div",Ne,[n("div",De," Balance: "+l(e(T)(e(E)))+" "+l(e(o).to.symbol),1)])]),a(P,{modelValue:void 0,"onUpdate:modelValue":_[1]||(_[1]=V=>undefined=V),readonly:"",outlined:"",class:"swap-input"},{append:c(()=>[a(N,{"swap-token":String(e(o).from.symbol),options:e(g),direction:!0,token:e(o).to,"destination-unavailable":!e(m),onHandleSearchToken:e(u),onSetToken:H},null,8,["swap-token","options","token","destination-unavailable","onHandleSearchToken"])]),_:1})])]),a(U,{class:"q-mt-md"}),n("div",Ie,[a(b,{loading:e(s).swapping,disable:!e(s).active||!e(m)||!e(s).amountTokenA,rounded:"",ripple:!1,onClick:e(C)},{default:c(()=>[y(" Add Liquidity ("+l(e(o).from.symbol)+") ",1)]),_:1},8,["loading","disable","onClick"])]),e(m)?(w(),A("div",Pe,[n("div",Qe,[a(b,{loading:e(f),class:"swap-card__reload",unelevated:"",color:k.$q.dark.isActive?"white":"primary",round:"",onClick:e(v)},{default:c(()=>[a(_e,{name:e(fe),color:k.$q.dark.isActive?"primary":"white"},null,8,["name","color"])]),_:1},8,["loading","color","onClick"])])])):(w(),A("div",Le," Pool not found ")),n("div",Ke,[n("dl",null,[n("dt",null,"Pool "+l(e(o).from.symbol)+" balance",1),n("dd",null,l(e(T)(e(q))),1)]),n("dl",null,[n("dt",null,"Pool "+l(e(o).to.symbol)+" balance",1),n("dd",null,l(e(T)(e(K))),1)])])]),_:1}),a(ke,{showing:e(o)?.loading,class:"swap-loading",color:"grey"},null,8,["showing"])]),_:1})}}}),Ee={},je={class:"main-block row justify-center"};function Fe(B,p){const o=W,f=ze,r=R,t=G;return w(),A(ve,null,[a(o,{class:"q-mt-lg"}),n("div",je,[a(f)]),a(r,{class:"q-mt-lg"}),a(t,{class:"q-mt-lg"})],64)}const eo=we(Ee,[["render",Fe]]);export{eo as default};
